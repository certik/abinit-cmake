<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html
 lang="en"><head><title>ABINIT. Tutorial PAW2</title>
<meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8"><meta
 name="CREATED" content="20070813;16500000"><meta name="CHANGEDBY"
 content="Marc Torrent"><meta name="CHANGED" content="20070820;17391100"><style>
<!--
@page { size: 8.5in 11in; margin: 0.79in }
P { margin-bottom: 0.08in }
A:link { color: #0000ff }
--></style><meta
 http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8"><meta
 name="GENERATOR" content="OpenOffice.org 2.0 (Linux)"><meta
 name="AUTHOR" content="Marc Torrent"><meta name="CREATED"
 content="20070813;16500000"><meta name="CHANGEDBY"
 content="Marc Torrent"><meta name="CHANGED" content="20070814;13530000"><style>
<!--
@page { size: 8.5in 11in; margin: 0.79in }
P { margin-bottom: 0.08in }
--</style><meta
 name="GENERATOR" content="OpenOffice.org 2.0 (Linux)"><meta
 name="AUTHOR" content="Marc Torrent"><meta name="CREATED"
 content="20070813;16500000"><meta name="CHANGEDBY"
 content="Marc Torrent"><meta name="CHANGED" content="20070814;13530000"><style>
<!--
@page { size: 8.5in 11in; margin: 0.79in }
P { margin-bottom: 0.08in }
-->
</style><meta http-equiv="CONTENT-TYPE"
 content="text/html; charset=utf-8"><meta name="GENERATOR"
 content="OpenOffice.org 2.0 (Linux)"><meta name="AUTHOR"
 content="Marc Torrent"><meta name="CREATED" content="20070813;16500000"><meta
 name="CHANGEDBY" content="Marc Torrent"><meta name="CHANGED"
 content="20070814;13530000"><style>
<!--
@page { size: 8.5in 11in; margin: 0.79in }
P { margin-bottom: 0.08in }
-->
</style><meta http-equiv="CONTENT-TYPE"
 content="text/html; charset=utf-8"><meta name="GENERATOR"
 content="OpenOffice.org 2.0 (Linux)"><meta name="AUTHOR"
 content="Marc Torrent"><meta name="CREATED" content="20070813;16500000"><meta
 name="CHANGEDBY" content="Marc Torrent"><meta name="CHANGED"
 content="20070821;14505700"><style>
<!--
@page { size: 8.5in 11in; margin: 0.79in }
P { margin-bottom: 0.08in }
-->
</style><meta http-equiv="CONTENT-TYPE"
 content="text/html; charset=utf-8"><meta name="GENERATOR"
 content="OpenOffice.org 2.0 (Linux)"><meta name="AUTHOR"
 content="Marc Torrent"><meta name="CREATED" content="20070813;16500000"><meta
 name="CHANGEDBY" content="Marc Torrent"><meta name="CHANGED"
 content="20070821;15363000"><style>
<!--
@page { size: 8.5in 11in; margin: 0.79in }
P { margin-bottom: 0.08in }
-->
</style><meta http-equiv="CONTENT-TYPE"
 content="text/html; charset=utf-8"><meta name="GENERATOR"
 content="OpenOffice.org 2.0 (Linux)"><meta name="AUTHOR"
 content="Marc Torrent"><meta name="CREATED" content="20070813;16500000"><meta
 name="CHANGEDBY" content="Marc Torrent"><meta name="CHANGED"
 content="20070814;13530000"><style>
<!--
@page { size: 8.5in 11in; margin: 0.79in }
P { margin-bottom: 0.08in }
-->
</style></head><body style="background-color: rgb(255, 255, 255);"><hr><h1>ABINIT,
lesson PAW2:</h1>
<h2>Projector augmented-wave technique : the generation of atomic
data
files</h2>
<hr><p>This lesson aims at showing how to compute atomic
data files for the
projector-augmented-wave method.
</p><p>You will learn how to generate the atomic data and
what the main
variables are to govern their softness and transferability.
<br>It is supposed you already know how to use <span
 style="font-weight: bold; font-style: italic;">ABINIT</span>
in the
PAW case<br>
<br>This lesson should take about 1h30 to be done. </p>
<h5>Copyright (C) 2005-2008 ABINIT group (MT)
<br>This file is distributed under the terms of the GNU General
Public
License, see
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br>For the initials of contributors, see
~abinit/doc/developers/contributors.txt .
</h5>


<HR ALIGN=left>
Goto :
<A href="http://www.abinit.org"><B>ABINIT home Page</B></A>
<B> | </B>
<A href="../users/acknowledgments.html"><B>Suggested acknowledgments</B></A>
<B> | </B>
<A href="../input_variables/keyhr.html"><B>List of input variables</B></A>
<B> | </B>
<A href="welcome.html"><B>Tutorial home page</B></A>
<B> | </B>
<A href="../users/bibliography.html"><B>Bibliography</B></A>
<HR ALIGN=left>
Help files :
<A href="../users/new_user_guide.html"><B>New user's guide</B></A>
<B> | </B>
<A href="../users/abinis_help.html"><B>Abinis (main)</B></A>
<B> | </B>
<A href="../users/respfn_help.html"><B>Abinis (respfn)</B></A>
<B> | </B>
<A href="../users/mrgddb_help.html"><B>Mrgddb</B></A>
<B> | </B>
<A href="../users/anaddb_help.html"><B>Anaddb</B></A>
<B> | </B>
<A href="../users/aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="../users/cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="../users/optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="../users/mrgscr_help.html"><B>Mrgscr</B></A>
<HR ALIGN=left>


<h3><b>Contents of lesson
PAW2 :</b></h3>
<ul> <li><a href="#1">1.</a> The PAW
atomic dataset - introduction</li><li><a href="lesson_paw2.html#2">2.</a>
Installation and use of the generation code</li><li><a
 href="lesson_paw2.html#3">3.</a> First (and basic) PAW
dataset for Nickel</li><li><a href="lesson_paw2.html#4">4.</a>
Checking
the sensitivity of results to some parameters</li><li><a
 href="lesson_paw2.html#5">5.</a> Adjusting partial
waves and projectors</li><li><a href="lesson_paw2.html#6">6.</a>
Having a look at the logarithmic derivatives</li><li><a
 href="lesson_paw2.html#7">7.</a> Testing efficiency of
PAW dataset</li><li><a href="lesson_paw2.html#8">8.</a>
Having a look at physical quantities</li><li><a
 href="lesson_paw2.html#9">9.</a> The Real Space Optimization (RSO) -
experienced users</li></ul>
<hr><a name="1">&#160;</a>
<h3><b>1. The PAW atomic dataset - introduction
</b></h3>The PAW method is based on the definition of
atomic spheres of radius <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">PAW</sub> around the
atoms of the system in which a base of atomic partial waves &#966;<sub>i</sub>,
of
"pseudized" partial waves<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>&#966;<sub>i</sub>,
and of projectors<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>
(dual to<span style="position: relative; top: -5pt; left: 6pt;">~</span>&#966;<sub>i</sub>)
have to be
defined. This set of partial-waves and projectors functions plus some
additional atomic data are stored in a so-called <i>PAW dataset</i>.
A
PAW dataset has to be generated for each atomic species in order to
reproduce atomic behavior as accurate
as possible while requiring minimal CPU and memory resources in
executing ABINIT for the crystal simulations. These two
constraints are conflicting.<br>The PAW dataset generation is
the purpose of this tutorial.<br>It is done according
the following procedure (<span style="font-style: italic;">all
parameters that define a PAW dataset are in </span><span
 style="font-weight: bold; font-style: italic;">bold</span>):<br><ol><li><p>Choose
and <span style="font-weight: bold;">define the concerned
chemical
species</span> (name and atomic number).</p>
</li><li><p>Solve the
atomic all-electrons problem in a given atomic configuration. The
atomic problem is solved within the DFT formalism, using an <span
 style="font-weight: bold;">exchange-correlation
functional</span> and either a Schr&#246;dinger (default) or <span
 style="font-weight: bold;">scalar-relativistic
approximation</span>. It is a spherical problem and it is solved
on
a <span style="font-weight: bold;">radial grid</span>.&#160;The
atomic
problem is solved for a given <span style="font-weight: bold;">electronic
configuration</span> that can be an ionized/excited one.</p>
</li><li><p>Choose a set
of electrons that will be considered as frozen around the nucleus (<span
 style="font-weight: bold;">core
electrons</span>). The others electrons are valence ones and will
be
used in the PAW basis. The <span style="font-weight: bold;">core
density</span> is then
deduced from the core electrons wave functions. A <span
 style="font-weight: bold;">smooth core
density</span> equal to the core density outside a given <span
 style="font-style: italic; font-weight: bold;">r</span><sub
 style="font-style: italic; font-weight: bold;">core</sub>
<span style="font-weight: bold;">matching radius</span>
is computed.</p>
</li><li><p>Choose
the <span style="font-weight: bold;">size of the PAW basis</span>
(number of partial-waves and projectors). Then choose the partial-waves
included in the basis. The later can be <span
 style="font-weight: bold;">atomic eigen-functions</span>
related to valence electrons (bound states) and/or <span
 style="font-weight: bold;">additional
atomic functions</span>, solution of the wave equation for a
given l
quantum number at arbitrary <span style="font-weight: bold;">reference
energies</span> (unbound states).</p> </li><li><p>Generate
<span style="font-weight: bold;">pseudo partial-waves</span>
(smooth partial-waves build with a <span style="font-weight: bold;">pseudization
scheme</span>
and equal to partial-waves outside a given <span
 style="font-style: italic; font-weight: bold;">r</span><sub
 style="font-style: italic; font-weight: bold;">c</sub><span
 style="font-weight: bold;">
matching radius</span>) and associated <span style="font-weight: bold;">projector
functions</span>. Pseudo partial-waves are solutions of the PAW
Hamiltonian deduced from the atomic Hamiltonian by pseudizing the
effective potential (a local <span style="font-weight: bold;">pseudopotential
</span>is
built and equal to effective potential outside a <span
 style="font-style: italic; font-weight: bold;">r</span><sub
 style="font-style: italic; font-weight: bold;">vloc</sub><span
 style="font-weight: bold;">
matching radius</span>). Projectors and partial-waves are then
orthogonalized with a chosen <span style="font-weight: bold;">orthogonalization
scheme</span>.</p>
</li><li><p>Build a <span style="font-style: italic;">compensation
charge density</span> used later in order to retrieve the total
charge of the atom. This compensation charge density is located inside
the PAW spheres and based on an analytical <span
 style="font-weight: bold;">shape function</span>
(which analytic form and <span style="font-weight: bold;">localization
radius </span><span style="font-style: italic; font-weight: bold;">r</span><sub
 style="font-style: italic; font-weight: bold;">shape</sub>
can be chosen).</p> </li></ol>The user can choose
between two PAW
dataset generators to produce atomic files directly readable by ABINIT.<br>The
first one is the PAW generator <span
 style="font-weight: bold; font-style: italic;">ATOMPAW</span>
(originally by N. Holzwarth) and the second one is the
<span style="font-weight: bold; font-style: italic;">Ultra-Soft
(US)
generator</span> (originally written by
D. Vanderbilt).<br>You can find how to use
these two packages on the <a href="http://www.abinit.org/PAW/"
 target="_blank"><span style="font-weight: bold; font-style: italic;">ABINIT</span>
web site</a>.<br>
In this tutorial, we concentrate only on&#160;<span
 style="font-style: italic; font-weight: bold;">ATOMPAW</span>.<br>
<p>It is highly recommended to refer to the following papers to
well
understand the generation of PAW atomic datasets:</p><div
 style="margin-left: 40px;">[1] "Projector augmented-wave
method, P.E.
Blochl, Phys. Rev. B <span style="font-weight: bold;">50</span>,
17953
(1994)<br>[2]
<a target="_blank"
 href="http://www.wfu.edu/%7Enatalie/papers/pwpaw/atompaw.pdf">"A
projector Augmented Wave (PAW) code for electronic structure
calculations, Part I : <span style="font-style: italic;">atompaw</span>
for generating atom-centered functions", N. Holzwarth et al.,
Computer Physics Communications <span style="font-weight: bold;">135</span>,
329 (2001)</a><br>[3] "From ultrasoft pseudopotentials to
the projector augmented-wave method", G. Kresse, D. Joubert, Phys. Rev.
B<br>[4]
<a
 href="http://www.wfu.edu/%7Enatalie/papers/pwpaw/notes/atompaw/atompawEqns.pdf"
 target="_blank">"Notes for revised form of atompaw code", by
N.
Holzwarth</a></div><br>
<hr><a name="2">&#160;</a>
<h3><b>2. Installation and use of the generation code
</b></h3><p><i>Before continuing, you might
consider to work in a different
subdirectory as for the other lessons. Why not "Work_paw2" ?
</i></p><p class="MsoNormal" style="">You
will find the<span style="font-style: italic;"><span
 style="font-weight: bold;"> </span></span><span
 style="font-weight: bold; font-style: italic;">ATOMPAW</span>
+ <span style="font-weight: bold; font-style: italic;">ATOMPAW2ABINIT</span>
interface <a target="_self" href="lesson_paw2/AtompawAbinit.tar.gz">here</a>
(<span style="" lang="EN-GB">You also can retrieve
last versions of <a
 href="http://www.wfu.edu/%7Enatalie/papers/pwpaw/man.html">ATOMPAW</a>
and&#160;<a
 href="http://www.abinit.org/PAW/AtomPAW2Abinit-Manual-html/AtomPAW2Abinit.htm">Atompaw2Abinit</a>).</span>
You first have to unzip
and untar the file(s).<br><span style="" lang="EN-GB">Go
into </span><i><span style="color: navy;" lang="EN-GB">/ATOMPAW*</span></i><span
 style="" lang="EN-GB"> directory and edit&#160;</span><i><span
 style="color: navy;" lang="EN-GB">make.inc</span></i><span style=""
 lang="EN-GB">
file; modify it according to your machine specifications. Then type <span
 style="font-style: italic;">make</span><o:p></o:p><br>Go
into </span><i><span style="color: navy;" lang="EN-GB">/Atompaw2Abinit*</span></i><span
 style="" lang="EN-GB"> directory and edit&#160;</span><i><span
 style="color: navy;" lang="EN-GB">Makefile</span></i><span style=""
 lang="EN-GB">
file; modify it according to your machine specifications. Then type <span
 style="font-style: italic;">make</span><o:p></o:p></span><br>At
this
stage
you two executables&#160;<i><span style="color: navy;" lang="EN-GB">/ATOMPAW*/atompaw</span></i>
and&#160;<i><span style="color: navy;" lang="EN-GB">/Atompaw2Abinit*/atompaw2abinit</span></i>.</p><big><small><span
 style="text-decoration: underline;">How to use
Atompaw+Atompaw2Abinit ?</span></small></big><br><ul><li>Edit
an input file in a text editor (content of input explained <a
 href="lesson_paw2/atompawUG.pdf" target="_blank">here</a>)</li></ul><ul><li>Run:
<span style="font-weight: bold; font-style: italic;">ATOMPAW*/atompaw
&#60; inputfile</span></li></ul><div style="margin-left: 80px;">Partial
waves &#966;<sub>i</sub>, PS partial waves<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>&#966;<sub>i</sub>
and projectors<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>
are
given in <span style="color: rgb(51, 102, 255);">wfn.i</span>
files.<br>Logarithmic
derivatives from atomic Hamiltonian
and PAW Hamiltonian resolutions are given in <span
 style="color: rgb(51, 102, 255);">logderiv.l</span>
files.<br>A summary of the atomic all-electrons computation
and PAW dataset properties can be found in the <span
 style="color: rgb(51, 102, 255);">Atom_name</span>
file <small>(Atom_name is the first parameter of the input file)</small>.<br>Resulting
PAW dataset is contained in: <br><div style="margin-left: 40px;"><span
 style="color: rgb(51, 102, 255);">Atom_name.atomicdata file</span>
(specific format for PWPAW
code)</div><div style="margin-left: 40px;"><span
 style="color: rgb(51, 102, 255);">Atom_name.XCfunc.xml</span>
file
(normalized
XML
file according to specifications from
<a href="http://dcwww.camp.dtu.dk/campos/pawxml/pawxml.xhtml">http://dcwww.camp.dtu.dk/campos/pawxml.pawxml.xhtml</a>).</div></div><ul><li><span
 style="font-style: italic;">Run: </span><span
 style="font-style: italic;"></span><span
 style="font-weight: bold; font-style: italic;">Atompaw2Abinit*/atompaw2abinit</span><span
 style="font-weight: bold;"></span> and give the name
of one of the two
previous files.</li></ul>
<hr style="width: 100%; height: 2px;"><a name="3">&#160;</a>
<h3><b>3. First (and basic) PAW dataset for Nickel
</b></h3><p style="margin-bottom: 0in;" align="justify">Our test case
will be <span style="font-weight: bold;">NICKEL</span>
(<span style="font-style: italic;">1s</span><sup
 style="font-style: italic;">2</sup><span style="font-style: italic;">
2s</span><sup style="font-style: italic;">2</sup><span
 style="font-style: italic;"> </span><span style="font-style: italic;">2p</span><sup
 style="font-style: italic;">6</sup><span style="font-style: italic;">
</span><span style="font-style: italic;">3s</span><sup
 style="font-style: italic;">2</sup><span style="font-style: italic;"> </span><span
 style="font-style: italic;">3p</span><sup style="font-style: italic;">6</sup><span
 style="font-style: italic;"> 3d<sup>8</sup> 4s<sup>2</sup></span>
<span style="font-style: italic;">4p</span><sup
 style="font-style: italic;">0</sup>).</p><span
 style="color: rgb(153, 0, 0);">In
a first stage, copy a simple input file for ATOMPAW in your working
directory</span> (find it in <a href="lesson_paw2/Ni.atompaw.input1"><span
 style="font-style: italic;">~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input1</span></a>).
Edit this file.<br><p style="margin-top: 0.08in; margin-bottom: 0in;"
 align="justify" lang="en-US">This file has been built in the following
way:</p><p
 style="margin-top: 0.08in; margin-bottom: 0in; font-weight: bold; text-decoration: underline;"
 align="justify" lang="en-US">1-All-electrons
calculation:</p><ul><li>
First line: define the <span style="font-weight: bold;">material</span>
in the first line</li></ul><ul><li>Second line:
choose the <span style="font-weight: bold;">exchange-correlation
functional</span> (<span style="font-style: italic;">LDA-PW</span>
or <span style="font-style: italic;">GGA-PBE</span>)
and select a <span style="font-weight: bold;">scalar-relativistic
wave equation</span> (<span style="font-style: italic;">nonrelativistic</span>
or <span style="font-style: italic;">scalarrelativistic</span>)
and a (2000
points) <span style="font-weight: bold;">logarithmic grid</span>.&#160;</li></ul><ul><li>Next
lines: define&#160;the&#160;<span style="font-weight: bold;">electronic
configuration</span>:</li></ul><div style="margin-left: 40px;"><div
 style="margin-left: 40px;"><span style="font-style: italic;">How many
electronic states do we
need to include in the computation ?</span><span
 style="font-style: italic;"><br>Besides the fully and partially
occupied states, it is recommended to add all states that could be
reached by electrons in the solid. </span><span
 style="font-style: italic;">Here, for Nickel, the 4p state
is concerned. So we decide to add it in the computation.</span></div><p>-
A&#160;line
with the maximum <span style="font-style: italic;">n</span>
quantum
number for each electronic shell; here "4 4 3" means <span
 style="font-style: italic;">4s, 4p, 3d</span>.</p>-
Definition of occupation numbers:<br><div style="margin-left: 40px;">For
each
partially occupied shell enter the occupation number. An excited
configuration may be useful if the PAW dataset is intended for use in a
context where the material is charged (such as oxides). Although, in
our experience, the results are not highly dependent on the chosen
electronic configuration.<br>We choose here the <span
 style="font-style: italic;">3d<sup>8</sup> 4s<sup>2</sup></span>
<span style="font-style: italic;">4p</span><sup
 style="font-style: italic;">0</sup> configuration.
Only <span style="font-style: italic;">3d</span>
and <span style="font-style: italic;">4p</span>
shells are partially occupied ("3
2 8" " and "4 1 0" lines). A "0 0 0" ends the occupation chapter.</div>-
Selection
of <span style="font-weight: bold;">core and valence
electrons</span>
selection: in a first approach, select only electrons from outer
shells as valence. But, if particular thermo dynamical conditions are
to be
simulated, it is generally needed to include &#8220;semi-core
states&#8221; in the set of valence electrons. Semi-core states are
generally needed with transition metal and rare-earth materials. Note
that all wave functions designated as valence electrons will
be used in the partial-wave basis.<br>Core shells are designated
by a "<span style="font-style: italic;">c</span>"
and valence shells by a "<span style="font-style: italic;">v</span>".
All <span style="font-style: italic;">s states</span>
first, then <span style="font-style: italic;">p states</span>
and finally <span style="font-style: italic;">d states</span>.<br>Here:
</div><div style="margin-left: 80px;"><span style="font-style: italic;">c</span><span
 style="font-style: italic;"><br>c</span><span
 style="font-style: italic;"><br>c</span><span
 style="font-style: italic;"><br>v</span><span
 style="font-style: italic;"><br>c</span><span
 style="font-style: italic;"><br>c</span><span
 style="font-style: italic;"></span><span style="font-style: italic;"><br>v<br>v</span></div><div
 style="margin-left: 40px;">means:</div><div style="margin-left: 80px;"><span
 style="font-style: italic;">1s core</span><span
 style="font-style: italic;"><br>2s core</span><span
 style="font-style: italic;"><br>3s core</span><span
 style="font-style: italic;"><br>4s valence</span><span
 style="font-style: italic;"><br>2p core</span><span
 style="font-style: italic;"><br>3p core</span><span
 style="font-style: italic;"><br>4p valence</span><br><span
 style="font-style: italic;">3d
valence</span></div>
<p
 style="margin-bottom: 0in; font-weight: bold; text-decoration: underline;"
 align="justify" lang="en-US">Partial-waves basis
generation:</p><ul><li>A line with <span style="font-style: italic;">l</span><sub
 style="font-style: italic;">max</sub> the <span
 style="font-weight: bold;">maximum </span><span
 style="font-style: italic; font-weight: bold;">l</span><span
 style="font-weight: bold;"> for the partial waves basis</span>.
Here <span style="font-style: italic;">l</span><sub
 style="font-style: italic;">max</sub>=2.</li><li>A
line with the <span style="font-style: italic; font-weight: bold;">r</span><sub
 style="font-style: italic; font-weight: bold;">PAW</sub>
radius. Select it to
be slightly less than half the inter-atomic distance in the solid (as a
first choice). Here <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">PAW</sub>=2.3 a.u. If only
one radius is input, all others pseudization radii will be equal to <span
 style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>
(<span style="font-style: italic;">r</span><sub
 style="font-style: italic;">c</sub>, <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">core</sub>, <span
 style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
and <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">shape</sub>).</li><li>Next
lines:&#160;<span style="font-weight: bold;">add
additional partial-waves</span> &#966;<sub>i </sub>if
needed: choose to
have <span style="font-weight: bold;">2 partial-waves per
angular momentum</span> in the basis (this choice is
not necessarily optimal but this is the most common one; if <span
 style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>
is
small enough, 1 partial-wave per <span style="font-style: italic;">l</span>
may suffice). As a first guess, put
all reference energies for additional partial-waves to 0 Rydberg.</li></ul><div
 style="margin-left: 40px;">Note that for each angular
momentum, valence states already are included in the partial waves
basis. Here <span style="font-style: italic;">4s</span>,
<span style="font-style: italic;">4p</span>
and <span style="font-style: italic;">3d</span>
states already are in the basis<br>For each angular momentum,
first add "y" to add an additional partial wave. Then, next line, put
the value&#160;in Rydberg units. Repeat this for each new partial
wave and finally put "n"<br>In the present file,<br><div
 style="margin-left: 40px;"><span style="font-style: italic;">y</span><span
 style="font-style: italic;"> <br>0. </span><span
 style="font-style: italic;"><br>n</span></div>means
that an additional <span style="font-style: italic;">s</span>-
partial wave at <span style="font-style: italic;">E</span><sub
 style="font-style: italic;">ref</sub>=0.<span
 style="font-style: italic;"> Ry</span> as been added.<br><div
 style="margin-left: 40px;"><span style="font-style: italic;">y </span><span
 style="font-style: italic;"><br>0.</span><span
 style="font-style: italic;"><br>n</span></div>means
that an additional&#160;<span style="font-style: italic;">p</span>-
partial wave at <span style="font-style: italic;">E</span><sub
 style="font-style: italic;">ref</sub>=0.<span
 style="font-style: italic;"> Ry</span> has been added.<br><div
 style="margin-left: 40px;"><span style="font-style: italic;">y</span><span
 style="font-style: italic;"> <br>0.</span><span
 style="font-style: italic;"><br>n</span></div>means
that an additional <span style="font-style: italic;">d-</span>
partial wave at <span style="font-style: italic;">E</span><sub
 style="font-style: italic;">ref</sub>=0.<span
 style="font-style: italic;"> Ry</span> as been added.<br>Finally,
partial waves basis contains two <span style="font-style: italic;">s-</span>,
two <span style="font-style: italic;">p-</span>&#160;
and two <span style="font-style: italic;">d</span>-
partial waves.</div><ul><li>Next line: definition of
the generation <span style="font-weight: bold;">scheme
for pseudo partial waves</span><span
 style="position: relative; top: -5pt; left: 6pt; font-weight: bold;">~</span><span
 style="font-weight: bold;">&#966;</span><sub style="font-weight: bold;">i</sub><span
 style="font-weight: bold;">,
and of projectors</span><span
 style="position: relative; top: -5pt; left: 6pt; font-weight: bold;">~</span><span
 style="font-weight: bold;">p</span><sub style="font-weight: bold;">i</sub>.
We begin here with
a simple scheme (i.e. "Bloechl" scheme, proposed by P. Bl&#246;chl in
ref.
[1]). This will probably be changed later to make the PAW dataset more
efficient.</li><li>Next line: generation scheme for local <span
 style="font-weight: bold;">pseudopotential </span><span
 style="font-style: italic; font-weight: bold;">V</span><sub
 style="font-style: italic; font-weight: bold;">loc</sub>.
In order to get PS partial waves, the atomic potential has to be
"pseudized" using an arbitrary pseudization scheme. We choose here a
"Troullier-Martins" using a wave equation at <span
 style="font-style: italic;">l</span><sub style="font-style: italic;">loc</sub>=3
and <span style="font-style: italic;">E</span><sub
 style="font-style: italic;">loc</sub>=0. <span
 style="font-style: italic;">Ry</span>. As a first
draft, it is always recommended to put <span
 style="font-style: italic;">l<sub>loc</sub>=1+l</span><sub
 style="font-style: italic;">max</sub><span style="font-style: italic;">
(</span><span style="font-style: italic;">l</span><sub
 style="font-style: italic;">max</sub> defined above).</li><li>A
0 (zero) to end the file.</li></ul>
<br><big style="font-weight: bold; color: rgb(153, 0, 0);">At
this
stage,
run atompaw !</big><span style="color: rgb(153, 0, 0);"><br>For
this purpose, simply enter:
</span><span style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW*/atompaw
&#60;Ni.atompaw.input1</span><br>
Lot of files are produced. We will have a look at some of them.<br>A
summary of the PAW dataset generation process has been written in a
file
named&#160;<span style="color: rgb(51, 102, 255);">Ni</span>
(name
extracted from first line of input file). Open it. It should look like:<br>
<div style="margin-left: 80px; font-family: monospace;">Atom
= Ni Z = 28<br>Perdew
- Burke - Ernzerhof GGA
Log grid -- n,r0,rmax = 2000 2.2810899E-04 8.0000000E+01<br>Scalar
relativistic calculation -- point nucleus<br>all-electron results<br>&#160;core
states (zcore) = 18.0000000000000<br>&#160;&#160; 1
&#160;1 &#160;0
&#160;2.0000000E+00 -6.0358607E+02<br>&#160;&#160; 2
&#160;2
&#160;0&#160; 2.0000000E+00 -7.2163318E+01<br>&#160;&#160;
3&#160; 3
&#160;0&#160; 2.0000000E+00 -8.1627107E+00<br>&#160;&#160;
5 &#160;2
&#160;1&#160; 6.0000000E+00 -6.2083048E+01<br>&#160;&#160;
6&#160; 3
&#160;1&#160; 6.0000000E+00 -5.2469208E+00<br>valence
states (zvale) =
10.0000000000000<br>&#160; &#160;4 &#160;4
&#160;0&#160; 2.0000000E+00
-4.1475541E-01<br>&#160; &#160;7&#160; 4 &#160;1
&#160;0.0000000E+00
-9.0035738E-02<br>&#160; &#160;8 &#160;3 &#160;2
&#160;8.0000000E+00
-6.5223644E-01<br>evale = -185.182300204925<br>selfenergy
contribution
= 8.13253645212054<br>paw parameters:<br>&#160;
&#160; lmax = 2<br>&#160;
&#160; rc &#160; = 2.30969849741149<br>&#160;
&#160; irc &#160;= 1445<br>Vloc:
Norm-conserving Troullier-Martins form; l= 3;e= 0.0000E+00<br>Projector
method: Bloechl<br>Sinc^2 compensation charge shape zeroed at rc<br><br>Number
of basis functions 6<br>&#160;No.&#160; n &#160; l
&#160;Energy &#160;
&#160; &#160; &#160; &#160;Cp coeff &#160;
&#160; &#160;Occ<br>&#160;
1&#160; &#160;4 &#160; 0 &#160;-4.1475541E-01
-9.5091493E+00
2.0000000E+00<br>&#160; 2 999 &#160; 0 &#160;
0.0000000E+00&#160;
3.4829954E+00 0.0000000E+00<br>&#160; 3 &#160; 4
&#160; 1
&#160;-9.0035738E-02 -8.9594194E+00 0.0000000E+00<br>&#160;
4 999
&#160; 1 &#160; 0.0000000E+00 &#160;1.0836820E+01
0.0000000E+00<br>&#160;
5 &#160; 3 &#160; 2 &#160;-6.5223644E-01&#160;
9.1576176E+00
8.0000000E+00<br>&#160; 6 999 &#160; 2 &#160;
0.0000000E+00
&#160;1.3369075E+01 0.0000000E+00<br>&#160;evale from
matrix elements
-1.85182309373359118E+02
</div><p style="margin-left: -0.02in; margin-bottom: 0in;"
 align="justify" lang="en-US">The generated PAW
dataset (contained in&#160;<span style="color: rgb(51, 102, 255);">Ni.atomicdata</span>
or&#160;<span style="color: rgb(51, 102, 255);">Ni.GGA-PBE.xml</span>
file) is a
first draft.<br>Several parameters have
to be adjusted, in order to get accurate results and efficient DFT
calculations.</p><p style="margin-left: -0.02in; margin-bottom: 0in;"
 align="justify" lang="en-US">Note that&#160;<span
 style="color: rgb(51, 102, 255);">Ni.atomicdata</span>
or&#160;<span style="color: rgb(51, 102, 255);">Ni.GGA-PBE.xml</span>
files have to
be translated by <span style="font-weight: bold;">Atompaw2Abinit</span>
tool to be usuable by ABINIT.</p>
<br><hr style="width: 100%; height: 2px;"><a name="4">&#160;</a>
<br><h3>4. Checking the sensitivity of results to some
parameters</h3><ul><li><p
 style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"
 lang="en-US"> <span style="text-decoration: underline;">The
radial grid:</span></p>
</li></ul><p style="margin-left: 0.45in; margin-bottom: 0in;"
 align="justify" lang="en-US">Try to select 700 points in the
logarithmic
grid and check if any
noticeable difference in the results appears.<br><span
 style="color: rgb(153, 0, 0);">You just have to
replace 2000 by 700 in the second line</span> of&#160;<span
 style="color: rgb(51, 102, 255);">Ni.atompaw.input1</span>
file. <span style="color: rgb(153, 0, 0);">Then
run </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW*/atompaw
&#60;Ni.atompaw.input1</span><span style="color: rgb(153, 0, 0);"> again</span>
and look at&#160;<span style="color: rgb(51, 102, 255);">Ni</span>
file:</p><p style="margin-bottom: 0in; margin-left: 0.8634in;"
 align="justify" lang="en-US"><span style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;">evale = -185.182300<span
 style="color: rgb(51, 204, 0);">567435</span><span
 style="color: rgb(0, 153, 0);"></span></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"></span><span
 style="font-family: monospace;"><br>evale from matrix
elements
-1.8518230<span style="color: rgb(51, 204, 0);">1887091313</span>E+02</span></p><div
 style="margin-left: 40px;">As you see, results obtained with
this new
grid are very close to previous ones. We can keep the 700 points grid.</div><p
 style="margin-left: 40px; color: rgb(153, 0, 0);">You could
decrease
the size of
the grid; by
setting 400 points you should obtain:</p><div style="margin-left: 40px;"><div
 style="margin-left: 40px;"><span style="font-family: monospace;">
evale = -185.182<span style="color: rgb(51, 204, 0);">294626845</span><span
 style="color: rgb(0, 153, 0);"></span></span></div><span
 style="font-family: monospace;"></span></div><div
 style="margin-left: 80px;"><span style="font-family: monospace;">evale
from matrix elements -1.851823<span style="color: rgb(51, 204, 0);">37214119855</span>E+02</span></div><p
 style="margin-left: 0.45in; margin-bottom: 0in;" align="justify"
 lang="en-US">Small grids give PAW dataset with small size
(in kB) and
run faster in ABINIT, but accuracy can be affected.</p><p
 style="margin-bottom: 0in; margin-left: 0.8634in;" align="justify"
 lang="en-US">- Note that the final <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">PAW</sub> value ("rc =
..." in&#160;<span style="color: rgb(51, 102, 255);">Ni</span>
file) change with the
grid; just because <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">PAW</sub> is adjusted in
order to exactly
belong to the radial grid. By looking in ATOMPAW <a
 href="lesson_paw2/atompawUG.pdf" target="_blank">user's
guide</a>, you
can choose to keep it constant.</p><p
 style="margin-bottom: 0in; margin-left: 0.8634in;" align="justify"
 lang="en-US">- Also note that, if the
results are difficult to
get converged (some error produced by ATOMPAW), you should try a linear
grid&#8230;</p><br><ul style="text-decoration: underline;"><li><p
 style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"
 lang="en-US"> The relativistic approximation of the wave
equation:</p>
</li></ul><p style="margin-left: 0.44in; margin-bottom: 0in;"
 align="justify"><span style="font-style: italic;">Scalar-relativistic</span>
option should give better results than non-relativistic one, but it
sometimes produces difficulties for the convergence of the atomic
problem (either at the all-electrons resolution step or at the PAW
Hamiltonian solution step). If convergence cannot be reached, try a
<span style="font-style: italic;">non-relativistic</span>
calculation (not recommended for high Z materials)</p>
<p><big>For the following, note that you always should have
a look
at&#160;<span style="color: rgb(51, 102, 255);">Ni</span>
file, especially the values of valence energy ("evale"). You can
find the valence energy computed for the exact atomic problem and the
valence energy computed with the PAW parameters ("evale from matrix
elements"). Both have to be closed !</big></p><br><hr
 style="width: 100%; height: 2px;"><a name="5">&#160;</a>
<br><h3>5. Adjusting partial waves and projectors
</h3><p
 style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.103in;"
 align="justify"><span style="color: rgb(153, 0, 0);">Have a
look at the partial-waves, PS partial-waves and projectors.</span><br>Plot
the
<span style="color: rgb(51, 102, 255);">wfni</span>
(<span style="font-style: italic;">i</span>=1 to
6=number of partial waves) files in a graphical tool of your choice.
You should get 3
curves per
file: partial wave &#966;<sub>i</sub>, PS partial wave<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>&#966;<sub>i</sub>,
and projector<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>.</p><p
 style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.103in;"
 align="justify">Example here with the first <span
 style="font-style: italic;">s</span>- partial wave
/projector:</p><p
 style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.103in; text-align: center;"><img
 style="width: 434px; height: 446px;" alt="First s partial wave"
 src="lesson_paw2/wfn1a.jpg"> </p>
<ul><li><p style="margin-top: 0.08in; margin-bottom: 0in;"
 align="justify">The&#160;&#966;<sub>i</sub>
should meet the<span style="position: relative; top: -5pt; left: 6pt;">~</span>&#966;<sub>i
</sub>near or after the last maximum (or minimum). If not, it is
preferable to change the value of the matching (pseudization) radius.</p>
</li><li><p style="margin-top: 0.06in; margin-bottom: 0in;"
 align="justify">The
<span style="position: relative; top: -5pt; left: 6pt;">~</span>&#966;<sub>i
</sub>and <span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>
should have the same order of magnitude (some units). If not, you can
try to get this in three ways:</p><div style="margin-left: 40px;">-
Change the matching radius for this partial-wave; but this is not
always possible (spheres cannot have a large overlap in the solid)...<br>-
Change the pseudopotential scheme (see later).<br>- If there are
two
(or more) partial waves for the considered <span
 style="font-style: italic;">l</span> angular
momentum, decreasing
the magnitude of projector is possible by displacing the
references energies. Moving the energies away from each other
generally reduce the magnitude of projectors, but a too big
difference between energies can lead to wrong logarithmic derivatives
(see following chapter).</div></li></ul><p style="margin-left: 40px;">Example:
plot the <span style="color: rgb(51, 102, 255);">wfn6</span>
file, concerning the second <span style="font-style: italic;">d-</span>
partial wave:</p><div style="text-align: center;"><img
 style="width: 434px; height: 446px;" alt="2nd d partial wave"
 src="lesson_paw2/wfn6a.jpg"></div><p style="margin-left: 40px;">This
partial wave has been
generated at <span style="font-style: italic;">E</span><sub
 style="font-style: italic;">ref</sub>=0 Ry and
orthogonalized with the first <span style="font-style: italic;">d</span>-
partial wave which has an eigenenergy equal to -0.65Ry (see&#160;<span
 style="color: rgb(51, 102, 255);">Ni</span> file).
These two energies are too close and orthogonalization process produces
"high" partial waves.<br><span style="color: rgb(153, 0, 0);">Try
to
replace the reference energy for
the additional </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">d</span><span
 style="color: rgb(153, 0, 0);">-
partial wave. For example, put </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub
 style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span
 style="color: rgb(153, 0, 0);">=1. instead of </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub
 style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span
 style="color: rgb(153, 0, 0);">=0.</span>
(line 24 of <span style="color: rgb(51, 102, 255);">Ni.atompaw.input1</span>
file). Run ATOMPAW again and plot <span
 style="color: rgb(51, 102, 255);">wfn6</span> file:</p><p
 style="text-align: center;"><img style="width: 434px; height: 446px;"
 alt="2nd d partial wave" src="lesson_paw2/wfn6b.jpg"></p><p
 style="text-align: left; margin-left: 40px;"><big>Now
PS partial wave and projector&#160;have the same order of magnitude
!</big></p><p style="margin-top: 0.08in; margin-bottom: 0in;"
 align="justify"></p><p style="margin-top: 0.08in; margin-bottom: 0in;"
 align="justify"><big>Note
again that you always should have a look
at the <span style="font-style: italic;">evale</span>
values in&#160;<span style="color: rgb(51, 102, 255);">Ni</span>
file and keep them as
close at
possible.<br>If not, choices for projectors and/or partial waves
certainly are not judicious.</big></p><br><hr
 style="width: 100%; height: 2px;"><a name="6">&#160;</a>
<br><h3>6. Having a look at the logarithmic derivatives</h3><p
 style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"><span
 style="color: rgb(153, 0, 0);">Have
a
look at the </span><span
 style="font-style: italic; font-weight: bold; color: rgb(153, 0, 0);">logarithmic
derivatives</span>, i.e. derivatives of a <span
 style="font-style: italic;">l</span>-state <span
 style="font-weight: bold;">d(log(</span><span
 style="font-style: italic; font-weight: bold;">&#936;</span><sub
 style="font-style: italic; font-weight: bold;">l</sub><span
 style="font-weight: bold;">(</span><span
 style="font-style: italic; font-weight: bold;">E</span><span
 style="font-weight: bold;">))/dE</span> computed
for exact atomic problem and with th PAW dataset.<br>They are
printed
in the <span style="color: rgb(51, 102, 255);">logderiv.l</span>
files. Each <span style="color: rgb(51, 102, 255);">logderiv.l</span>
file
correspond to <span style="font-style: italic;">l</span>
quantum
number and contains the logarithmic
derivatives of the <span style="font-style: italic;">l</span>-state.
Here, <span style="font-style: italic;">l</span>=0,
1
or 2.</p><p style="margin-top: 0.08in; margin-bottom: 0in;"
 align="justify">They
should have the following properties:</p>
<ul><li><p style="margin-top: 0.08in; margin-bottom: 0in;"
 align="justify">The
2 curves should be superimposed as much as possible. By construction,
they are superimposed at the two energies corresponding to the two <span
 style="font-style: italic;">l</span>
partial-waves. If the superimposition is not good enough, the reference
energy for the second <span style="font-style: italic;">l</span>
partial-wave should be changed.</p> </li><li><p
 style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">Generally
a discontinuity in the logarithmic derivative curve appears at
0&#60;=<span style="font-style: italic;">E</span><sub
 style="font-style: italic;">0</sub>&#60;=4&#160;Rydberg.
A reasonable
choice is to
choose the 2 reference energies so that <span
 style="font-style: italic;">E</span><sub style="font-style: italic;">0</sub>
is in between.</p>
</li><li><p style="margin-top: 0.08in; margin-bottom: 0in;"
 align="justify" lang="en-US"> Too close reference energies produce
&#8220;hard&#8221; projector functions (as previously seen in
5.
chapter). But moving reference
energies away from each other can damage accuracy of logarithmic
derivatives</p></li></ul>Here the three logarithmic
derivatives curves
for the current dataset:<br><img src="lesson_paw2/log0a.jpg"
 alt="l=0 log derivatives" style="width: 434px; height: 446px;"><img
 src="lesson_paw2/log1a.jpg" alt="l=1 log derivatives"
 style="width: 434px; height: 446px;"><img src="lesson_paw2/log2a.jpg"
 alt="l=2 log derivatives" style="width: 434px; height: 446px;"><br><br>As
you can see, except for <span style="font-style: italic;">l</span>=2,
exact and PAW logarithmic derivatives do not match !<br>According
to
the previous remarks, try other values for the references energies of
the <span style="font-style: italic;">s</span>- and
<span style="font-style: italic;">p</span>-
additional partial waves.<br><span style="color: rgb(153, 0, 0);">First,
edit again the </span><span style="color: rgb(51, 102, 255);">NI.atompaw.input1</span><span
 style="color: rgb(153, 0, 0);">
file and put </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub
 style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span
 style="color: rgb(153, 0, 0);">=3Ry for the
additional </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">s</span><span
 style="color: rgb(153, 0, 0);">-
state</span> (line 18); <span style="color: rgb(153, 0, 0);">run
ATOMPAW
again</span>. <span style="color: rgb(153, 0, 0);">Plot the </span><span
 style="color: rgb(51, 102, 255);">logderiv.0</span>
<span style="color: rgb(153, 0, 0);">file</span>.
You should get:<br><div style="text-align: center;"><img
 src="lesson_paw2/log0b.jpg" alt="l=0 log derivatives"
 style="width: 434px; height: 446px;"></div><br><span
 style="color: rgb(153, 0, 0);">Then
put </span><span style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub
 style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span
 style="color: rgb(153, 0, 0);">=4Ry
for the second </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">p</span><span
 style="color: rgb(153, 0, 0);">-
state</span> (line
21); <span style="color: rgb(153, 0, 0);">run ATOMPAW again</span>. <span
 style="color: rgb(153, 0, 0);">Plot
again the </span><span style="color: rgb(51, 102, 255);">logderiv.1</span><span
 style="color: rgb(153, 0, 0);">
file</span>. You should
get:<br><div style="text-align: center;"><img
 src="lesson_paw2/log1b.jpg" alt="l=1 log derivatives"
 style="width: 434px; height: 446px;"></div><div
 style="text-align: center;"><div
 style="text-align: left; margin-left: 80px;"><big>Now,
all PAW logarithmic derivatives match with the exact ones in a
reasonnable interval.</big></div></div><br><big><span
 style="text-decoration: underline;">Additional information
concerning
logarithmic derivatives:</span></big><br>Another
possible problem could be the presence of a discontinuity in the PAW
logarithmic derivative curve at an energy where the exact logarithmic
derivative is continuous.<br>This generally shows the presence of
a
&#8220;<span style="font-weight: bold;">ghost state</span>&#8221;.<br><ul><li>First,
try to change to value of reference energies; this sometimes
can make the ghost state disappear.</li><li>If not, it can
be useful
to:</li></ul><div style="margin-left: 40px;">*
Change the
pseudopotential scheme. Norm-conserving pseudopotentials are
sometimes so deep (attractive near <span style="font-style: italic;">r</span>=0)
that they produce ghost states.<br><div style="margin-left: 40px;">A
first solution is to change the<span style="font-style: italic;"></span>
quantum number used to generate the
norm-conserving pseudopotential. But this is generally not sufficient.<br>A
second solution is to select an "ultrasoft" pseudopotential, freeing
the norm conservation constraint (simply replace "troulliermartins by
"ultrasoft" in input file)<br>A third solution is to select a
simple
&#8220;bessel&#8221;
pseudopotential (replace "troulliermartins by "bessel" in input file).
But, in that case, one has to
noticeably decrease the matching radius <span
 style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
if
one wants to keep reasonable physical results. Selecting a value of <span
 style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
between 0.6*<span style="font-style: italic;">r</span><sub
 style="font-style: italic;">PAW</sub> and 0.8*<span
 style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>
is
a good choice; but the best way to adjust <span
 style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
value is to have a look at the two values of <span
 style="font-style: italic;">evale</span> in&#160;<span
 style="color: rgb(51, 102, 255);">Ni</span> file which
are sensitive
to the choice of <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">Vloc</sub>. To change the
value of &#160;<span style="font-style: italic;">r</span><sub
 style="font-style: italic;">Vloc</sub>,
one has to detail the line containing all radii (<span
 style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub><span
 style="font-style: italic;"></span>, <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">shape</sub><span
 style="font-style: italic;"></span>,
<span style="font-style: italic;">r</span><sub
 style="font-style: italic;">Vloc</sub>
and <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">core</sub><span style="font-style: italic;"></span>);
see&#160;<a href="lesson_paw2/atompawUG.pdf" target="_blank">user's
guide</a>.</div></div><div style="margin-left: 40px;">* Change
the matching radius <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">c</sub> for one (or both) <span
 style="font-style: italic;">l</span> partial-wave(s).
In some
cases, changing <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">c</sub> can remove ghost
states. </div><ul><li>In
most cases (changing pseudopotential or
matching radius), one has to restart the procedure from step 5.</li></ul>To
see an example of ghost state, <span style="color: rgb(153, 0, 0);">use
the </span><a href="lesson_paw2/Ni.ghost.atompaw.input">~abinit/doc/tutorial/lesson_paw2/Ni.ghost.atompaw.input</a>
<span style="color: rgb(153, 0, 0);">file and run it with
ATOMPAW</span>.<br><span style="color: rgb(153, 0, 0);">Look
at the </span><span style="font-style: italic; color: rgb(153, 0, 0);">l</span><span
 style="color: rgb(153, 0, 0);">=1 logarithmic
derivatives (</span><span style="color: rgb(51, 102, 255);">logderiv.1</span><span
 style="color: rgb(153, 0, 0);">
file)</span>. They look
like:<br><div style="text-align: center;"><img
 src="lesson_paw2/log1c.jpg" alt="Ni l=1 log derivatives"
 style="width: 434px; height: 446px;"><br><div style="text-align: left;">Now,<span
 style="color: rgb(153, 0, 0);">
edit the </span><span style="color: rgb(51, 102, 255);">Ni.ghost.atompaw.input</span><span
 style="color: rgb(153, 0, 0);">
file and replace "troulliermartins" by "ultrasoft". Run ATOMPAW
again... and look at </span><span style="color: rgb(51, 102, 255);">logderiv.1</span><span
 style="color: rgb(153, 0, 0);">
file</span>. The ghost state has moved !<br><span
 style="color: rgb(153, 0, 0);">Edit again the file and
replace
'ultrasoft" by "bessel"; then change the 17th line ("2.0 2.0 2.0 2.0")
by "2.0 2.0 1.8 2.0"</span>. This has the effect of decreasing
the <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">Vloc</sub>
radius. <span style="color: rgb(153, 0, 0);">Run ATOMPAW</span>:
the
ghost state disappears !<br><span style="color: rgb(153, 0, 0);">Start
from
the original state of&#160;</span><span
 style="color: rgb(51, 102, 255);">Ni.ghost.atompaw.input</span><span
 style="color: rgb(153, 0, 0);">
file and put 1.8 for the matching radius of </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">p</span><span
 style="color: rgb(153, 0, 0);">- states (put 1.8
on lines 31 and 32). Run ATOMPAW</span>: the ghost state
disappears !<br><br><hr style="width: 100%; height: 2px;"><a name="7">&#160;</a>
<br><h3>7. Testing efficiency of PAW dataset</h3><span
 style="color: rgb(153, 0, 0);">
Let's use again our </span><span style="color: rgb(51, 102, 255);">Ni.atompaw.input1</span>
file for Nickel (with all our modifications).<br><span
 style="color: rgb(153, 0, 0);">Run ATOMPAW on it
and launch the AtomPAW2Abinit tool: </span><span
 style="font-weight: bold; font-style: italic; color: rgb(153, 0, 0);">Atompaw2Abinit*/atompaw2abinit</span><span
 style="font-weight: bold; color: rgb(153, 0, 0);"></span>.
Answer
"<span style="color: rgb(51, 102, 255);">Ni.atomicdata</span>"
to the
first question and press return for the others.<br>You
get a file <span style="color: rgb(51, 102, 255);">abinit.pawps</span>
containing the PAW dataset designated for ABINIT.<br><br>Now,
one has to test the efficiency of the generated PAW dataset. We finally
will use ABINIT !<br>You are about to run a DFT computation and
determine the size of
the plane wave basis needed to get a given accuracy. If the cut-off
energy defining the plane waves basis is too high (higher
than 20 Hartree, if <span style="font-style: italic;">r</span><sub
 style="font-style: italic;">PAW</sub> has a reasonable
value), some
changes have to be made in the input file.<br><br><span
 style="color: rgb(153, 0, 0);">Copy </span><span
 style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_x.files</span><span
 style="color: rgb(153, 0, 0);">
and </span><span style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_1.in</span><span
 style="color: rgb(153, 0, 0);">
in your working directory. Run ABINIT with them.</span><br>ABINIT
computes
the total energy of ferromagnetic FCC Nickel for several values of <span
 style="font-style: italic; font-weight: bold;">ecut</span>.<br>At
the end of output file, you get this:<br><span
 style="font-family: monospace;"><br>&#160;&#160;&#160;&#160;&#160;
ecut1&#160;&#160; 8.00000000E+00 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut2&#160;&#160; 1.00000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut3&#160;&#160; 1.20000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut4&#160;&#160; 1.40000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut5&#160;&#160; 1.60000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut6&#160;&#160; 1.80000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut7&#160;&#160; 2.00000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut8&#160;&#160; 2.20000000E+01 Hartree<br>&#160;&#160;&#160;
etotal1&#160; -3.9306364085E+01<br>&#160;&#160;&#160;
etotal2&#160;
-3.9506160887E+01<br>&#160;&#160;&#160;
etotal3&#160; -3.9583404506E+01<br>&#160;&#160;&#160;
etotal4&#160; -3.9612763655E+01<br>&#160;&#160;&#160;
etotal5&#160;
-3.9621840406E+01<br>&#160;&#160;&#160;
etotal6&#160; -3.9625006742E+01<br>&#160;&#160;&#160;
etotal7&#160; -3.9626177513E+01<br>&#160;&#160;&#160;
etotal8&#160;
-3.9626540287E+01</span><span
 style="font-weight: bold; font-style: italic;"><br><br>etotal</span>
convergence (at 1 mHartree) is achieve for 18&#60;=<span
 style="font-style: italic; font-weight: bold;">ecut</span>&#60;=20
Hartree<span style="font-weight: bold; font-style: italic;"><br>etotal</span>
convergence (at 0,1 mHartree) is achieve for&#160;<span
 style="font-style: italic; font-weight: bold;">ecut</span>&#62;22
Hartree<br><br><span style="font-weight: bold;">This
is not a good
result for a PAW dataset</span>;
let's try to optimize it.<br><ul><li><span
 style="text-decoration: underline;">First
possibility: use Vanderbilt projectors instead of Bloechl ones</span>.</li></ul><div
 style="margin-left: 40px;">Vanderbilt projectors generally
are more
localized in reciprocal space
than Bloechl ones (see ref. [4] for a detailled description of
Vanderbilt projectors).<br>Keyword "bloechl" has to be replaced
by
"vanderbilt" in the ATOMPAW input file&#160;and <span
 style="font-weight: bold; font-style: italic;">r</span><sub
 style="font-weight: bold; font-style: italic;">c</sub>
values have to be added at the end of the file (one for each PS partial
wave).<br>You can have a look at the ATOMPAW input file
:&#160; <a href="lesson_paw2/Ni.atompaw.input.vanderbilt">~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.vanderbilt</a><br><span
 style="font-style: italic;">But we will not test this case
here as it
produces particular results (see below).</span></div><ul><li><span
 style="text-decoration: underline;">2nd possibility: use
RRKJ
pseudization scheme for projectors</span>.</li></ul><div
 style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Use
this&#160;input file for ATOMPAW: </span><a
 href="lesson_paw2/Ni.atompaw.input2">~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input2</a><span
 style="color: rgb(51, 102, 255);"></span><br>As
you can see (by
editing the file)&#160;&#160;&#8220;bloechl&#8221;
has been changed by&#160;&#8221;custom rrkj&#8221; and 6 <span
 style="font-weight: bold; font-style: italic;">r</span><sub
 style="font-weight: bold; font-style: italic;">c</sub>
values have
been added at the end of the file; each one correspond to the <span
 style="font-weight: bold;">matching radius of one PS partial
wave</span>.<br><span style="color: rgb(153, 0, 0);">Repeat
the entire procedure (</span><span
 style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span
 style="color: rgb(153, 0, 0);">
+
</span><span style="font-weight: bold; color: rgb(153, 0, 0);">AtomPAW2Abinit</span><span
 style="color: rgb(153, 0, 0);">
+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span
 style="color: rgb(153, 0, 0);">)...</span>
and get a new ABINIT output file.<br><span style="font-style: italic;">Note:
you have to look again at log derivatives in order to verify that they
still are correct...</span><span style="font-family: monospace;"><span
 style="font-style: italic;"><br>&#160;</span>&#160;&#160;&#160;&#160;&#160;ecut1&#160;&#160;
8.00000000E+00 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut2&#160;&#160; 1.00000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut3&#160;&#160; 1.20000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut4&#160;&#160; 1.40000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut5&#160;&#160; 1.60000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut6&#160;&#160; 1.80000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut7&#160;&#160; 2.00000000E+01 Hartree<br>&#160;&#160;&#160;&#160;&#160;
ecut8&#160;&#160; 2.20000000E+01 Hartree<br>&#160;&#160;&#160;
etotal1&#160; -3.9599594752E+01<br>&#160;&#160;&#160;
etotal2&#160;
-3.9625280955E+01<br>&#160;&#160;&#160;
etotal3&#160; -3.9625589343E+01<br>&#160;&#160;&#160;
etotal4&#160; -3.9626233404E+01<br>&#160;&#160;&#160;
etotal5&#160;
-3.9626691021E+01<br>&#160;&#160;&#160;
etotal6&#160; -3.9626788832E+01<br>&#160;&#160;&#160;
etotal7&#160; -3.9626797319E+01<br>&#160;&#160;&#160;
etotal8&#160;
-3.9626840851E+01</span><span
 style="font-weight: bold; font-style: italic;"><br>etotal</span>
convergence (at 1 mHartree) is achieve for 12&#60;=<span
 style="font-style: italic; font-weight: bold;">ecut</span>&#60;=14
Hartree<span style="font-weight: bold; font-style: italic;"><br>etotal</span>
convergence (at 0,1 mHartree) is achieve for <span
 style="font-style: italic;">16&#60;=</span><span
 style="font-style: italic; font-weight: bold;">ecut</span>&#60;=18
Hartree<br><span style="font-weight: bold;">This is
a reasonnable
result for a PAW dataset</span> !<br><span
 style="font-family: monospace;"></span></div><span
 style="font-style: italic;"></span><ul><li><span
 style="text-decoration: underline;">3rd possibility: use
enhanced
polynomial pseudization scheme for projectors</span>.</li></ul><div
 style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Edit </span><a
 href="lesson_paw2/Ni.atompaw.input2">~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input2</a><span
 style="color: rgb(51, 102, 255);"></span><span
 style="color: rgb(153, 0, 0);"> and replace "custom rrkj" by
"custom
polynom2 7 10"</span></div><div style="margin-left: 40px;"><span
 style="color: rgb(153, 0, 0);">Repeat
the entire procedure (</span><span
 style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span
 style="color: rgb(153, 0, 0);">
+
</span><span style="font-weight: bold; color: rgb(153, 0, 0);">AtomPAW2Abinit</span><span
 style="color: rgb(153, 0, 0);">
+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span
 style="color: rgb(153, 0, 0);">)...</span> and look at
ecut
convergence...</div><span style="font-family: monospace;">&#160;
&#160;&#160; </span><span
 style="font-weight: bold; font-style: italic;"><br><br><br>Optional
exercice: let's go back to Vanderbilt projectors</span><br><div
 style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Repeat
the procedure (</span><span
 style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span
 style="color: rgb(153, 0, 0);">
+
</span><span style="font-weight: bold; color: rgb(153, 0, 0);">AtomPAW2Abinit</span><span
 style="color: rgb(153, 0, 0);">
+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span
 style="color: rgb(153, 0, 0);">) with </span><a
 href="lesson_paw2/Ni.atompaw.vanderbilt">~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.vanderbilt</a>
<span style="color: rgb(153, 0, 0);">file.</span><br>As
you can see
ABINIT convergence cannot be achieved !<br>You can try whatever
you
want with radii and/or references energies in the ATOMPAW input file:
ABINIT always diverges !<br>The solution here is to change the
pseudization scheme for the local pseudopotential.<br><span
 style="color: rgb(153, 0, 0);">Try to replace the
"troulliermartins"
keyword by "ultrasoft". Repeat
the procedure (</span><span
 style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span
 style="color: rgb(153, 0, 0);">
+
</span><span style="font-weight: bold; color: rgb(153, 0, 0);">AtomPAW2Abinit</span><span
 style="color: rgb(153, 0, 0);">
+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span
 style="color: rgb(153, 0, 0);">).</span><br><span
 style="color: rgb(153, 0, 0);"></span>ABINIT can now
reach&#160;
convergence !<br>Results are below:<br><span
 style="font-family: monospace;">&#160;
&#160;&#160;&#160;
ecut1&#160;&#160; 8.00000000E+00 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut2&#160;&#160; 1.00000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut3&#160;&#160; 1.20000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut4&#160;&#160; 1.40000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut5&#160;&#160; 1.60000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut6&#160;&#160; 1.80000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut7&#160;&#160; 2.00000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;&#160;&#160;
ecut8&#160;&#160; 2.20000000E+01 Hartree</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;
etotal1&#160;
-3.9609190887E+01</span><br><span style="font-family: monospace;">&#160;&#160;&#160;
etotal2&#160; -3.9614728542E+01</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;
etotal3&#160;
-3.9617516439E+01</span><br><span style="font-family: monospace;">&#160;&#160;&#160;
etotal4&#160; -3.9621098644E+01</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;
etotal5&#160;
-3.9622953669E+01</span><br><span style="font-family: monospace;">&#160;&#160;&#160;
etotal6&#160; -3.9623344242E+01</span><br><span
 style="font-family: monospace;">&#160;&#160;&#160;
etotal7&#160;
-3.9623387255E+01</span><br><span style="font-family: monospace;">&#160;&#160;&#160;
etotal8&#160; -3.9623465707E+01</span><br><span
 style="font-family: monospace;"></span><span
 style="font-weight: bold; font-style: italic;"></span><span
 style="font-weight: bold; font-style: italic;">etotal</span>
convergence (at 1 mHartree) is achieve for 14&#60;=<span
 style="font-style: italic; font-weight: bold;">ecut</span>&#60;=16
Hartree<span style="font-weight: bold; font-style: italic;"></span><br><span
 style="font-weight: bold; font-style: italic;">etotal</span>
convergence (at 0,1 mHartree) is achieve for <span
 style="font-style: italic;">20&#60;=</span><span
 style="font-style: italic; font-weight: bold;">ecut</span>&#60;=22
Hartree<br><span style="font-style: italic;">Note:
You could have tried the "bessel" keyword instead of "ultrasoft"...</span></div><div
 style="text-align: left;"></div><span
 style="text-decoration: underline; font-style: italic;">Summary
of convergency results:<br><img alt="ecut convergence"
 src="lesson_paw2/ecut.jpg"></span><br><br><span
 style="text-decoration: underline; font-style: italic;">Final
remarks:</span><ul><ul><li style="font-style: italic;"><p
 style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">The
localization of projectors in reciprocal space can (generally) be
predicted by a look at <span style="color: rgb(51, 102, 255);">tprod.i</span>
files. Such a file contains the curve of
as a function of q (reciprocal space variable). q is given in Bohr<sup>-1</sup>
units; it can be connected to&#160;ABINIT plane waves cut-off energy
(in
Hartree units) by: ecut=q<sub>cut</sub><sup>2</sup>/4. These quantities
are only calculated for the bound
states, since the Fourier transform of an extended function is not
well-defined.</p> </li><li style="font-style: italic;"><p
 style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">
Generating projectors with Bl&#246;chl&#8217;s scheme often
gives the guaranty to have stable calculations. atompaw ends without
any convergence problem and DFT calculations run without any divergence
(but they need high plane wave cut-off). Vanderbilt projectors (and
even more &#8220;custom&#8221; projectors) sometimes produce
instabilities during the PAW dataset generation process and/or the DFT
calculations&#8230;</p></li><li><p
 style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.0366in; font-style: italic;"
 align="justify">In most cases, after having changed the
projector generation scheme, one has to restart the procedure from
step 5.</p></li></ul></ul><br><hr style="width: 100%; height: 2px;"><a
 name="8">&#160;</a>
<br><h3>8. Having a look at physical quantities</h3> <p
 style="margin-bottom: 0in;" align="justify" lang="en-US">Finally,
the last step is to have a careful
look at physical quantities obtained with the PAW
dataset.<br><span style="color: rgb(153, 0, 0);"></span></p><p
 style="margin-bottom: 0in;" align="justify" lang="en-US"><span
 style="color: rgb(153, 0, 0);">Copy&#160;</span><span
 style="color: rgb(51, 102, 255);"></span><span
 style="color: rgb(153, 0, 0);"></span><span
 style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_2.in</span><span
 style="color: rgb(153, 0, 0);">
in your working directory.<br>Use the&#160; </span><a
 href="lesson_paw2/abinit.pawps.rrkj">~abinit/doc/tutorial/lesson_paw2/abinit.pawps.rrkj</a>
<span style="color: rgb(153, 0, 0);">psp file&#160;</span>(it
has been obtained from <span style="color: rgb(51, 102, 255);">Ni.atompaw.input2</span>
file).<br><span style="color: rgb(153, 0, 0);">Modify
<span style="color: rgb(51, 102, 255);">tpaw2_x.files</span>
file according to these new files.<br>Run ABINIT.</span></p><p
 style="margin-bottom: 0in;" align="justify" lang="en-US">ABINIT
computes
the converged ground state of ferromagnetic FCC Nickel for several
volumes around equilibrium.</p><span style="color: rgb(153, 0, 0);">Plot
the <span style="font-style: italic;">etotal vs acell</span>
curve</span>:<br><img style="width: 434px; height: 446px;"
 alt="etotal vs acell" src="lesson_paw2/acell-etotal.jpg"><br>From this
graph and output file,
you can extract some physical quantities:<br><div
 style="margin-left: 40px;">Equilibrium cell
parameter:&#160;<span
 style="font-style: italic; font-weight: bold; color: rgb(0, 102, 0);">a</span><sub
 style="font-style: italic; font-weight: bold; color: rgb(0, 102, 0);">0</sub><span
 style="font-weight: bold; color: rgb(0, 102, 0);"> = 3.524 angstrom</span><br>Bulk
modulus: <span
 style="font-style: italic; color: rgb(0, 102, 0); font-weight: bold;">B</span><span
 style="color: rgb(0, 102, 0); font-weight: bold;"> = 190 GPa</span><br>Magnetic
moment
at equilibrium: <span style="font-weight: bold; color: rgb(0, 102, 0);">&#956;
= 0.60</span> </div><br>Compare these results with published results:<br><ul><li>GGA-FLAPW
(<span style="font-style: italic;">all-electrons</span> - ref [3]):</li></ul><div
 style="margin-left: 40px;"><div style="margin-left: 40px;"><span
 style="font-style: italic;">a</span><sub style="font-style: italic;">0</sub>
= 3.52 angstrom<br><span style="font-style: italic;">B</span> = 200 GPa<br>&#956;
= 0.60</div></div><ul><li>GGA-PAW (VASP - ref [3]):</li></ul><div
 style="margin-left: 40px;"><div style="margin-left: 40px;"><span
 style="font-style: italic;">a</span><sub style="font-style: italic;">0</sub>&#160;=
3.52 angstrom<br><span style="font-style: italic;">B</span> = 194 GPa<br>&#956;
= 0.61</div></div><ul><li>Experimental results (A. Dewaele, private
communication):</li></ul><div style="margin-left: 40px;"><div
 style="margin-left: 40px;"><span style="font-style: italic;">a</span><sub
 style="font-style: italic;">0</sub> = 3.52 angstrom<br><span
 style="font-style: italic;">B</span> = 180 GPa</div>
</div><p
 style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;"
 align="justify" lang="en-US"><big><span style="font-style: italic;">You
should always compare&#160;results with all-eletrons ones (or other PAW
computations), not with experimental ones...</span></big><span
 style="text-decoration: underline;"></span></p><p
 style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;"
 align="justify" lang="en-US"><span style="text-decoration: underline;"></span></p><span
 style="text-decoration: underline;"><br>Additional
remark</span>:&#160;<p
 style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;"
 align="justify" lang="en-US">It can be useful to test
the sensitivity of results to some ATOMPAW input
parameters (see <a href="lesson_paw2/atompawUG.pdf" target="_blank">user's
guide</a> for details on keywords):</p>
<ul><li>The
analytical form and the cut-off radius <span
 style="font-style: italic; font-weight: bold;">r</span><sub
 style="font-style: italic; font-weight: bold;">shape</sub> of the <span
 style="font-weight: bold;">shape function</span>
used in compensation charge density definition. By default a
&#8220;sinc&#8221;
function is used but &#8220;gaussian&#8221; shapes can have an
influence on results. &#8220;Bessel&#8221; shapes are efficient
and generally need a smaller cut-off radius (<span
 style="font-style: italic;">r</span><sub style="font-style: italic;">shape</sub>=~0.8*<span
 style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>).</li><li>The
matching radius <span style="font-style: italic; font-weight: bold;">r</span><sub
 style="font-style: italic; font-weight: bold;">core</sub> used to get
pseudo core density from atomic core
density.</li><li><span style="color: rgb(51, 102, 102);"> The
integration of additional
(&#8220;semi-core&#8221;) states in the set of valence
electrons</span>.</li><li>The
pseudization scheme used to get pseudopotential <span
 style="font-style: italic;">V</span><sub style="font-style: italic;">loc</sub><span
 style="font-style: italic;">(r)</span>.</li></ul> <p
 style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;"
 align="justify" lang="en-US">
All these parameters have to be meticulously checked, especially
if the PAW dataset is used for non-standard solid structures or
thermo dynamical domains.</p>
<p style="margin-bottom: 0in;" align="justify" lang="en-US"><span
 style="font-weight: bold; font-style: italic;">Optional
exercice: let's add 3s and 3p semi-core states in PAW dataset !</span></p><div
 style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Repeat
the procedure (</span><span
 style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span
 style="color: rgb(153, 0, 0);">
+
</span><span style="font-weight: bold; color: rgb(153, 0, 0);">AtomPAW2Abinit</span><span
 style="color: rgb(153, 0, 0);">
+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span
 style="color: rgb(153, 0, 0);">) with </span><a
 href="lesson_paw2/Ni.atompaw.input.semicore">~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.semicore</a>
<span style="color: rgb(153, 0, 0);">file...<br><span
 style="color: rgb(0, 0, 0);">The run is a bit longer as more electrons
have to be treated by ABINIT.</span></span><span
 style="color: rgb(153, 0, 0);"><br>Look at </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">a</span><sub
 style="font-style: italic; color: rgb(153, 0, 0);">0</sub><span
 style="color: rgb(153, 0, 0);">, </span><span
 style="font-style: italic; color: rgb(153, 0, 0);">B</span><span
 style="color: rgb(153, 0, 0);"> or&#160;&#956; variation.</span></div>
<div style="margin-left: 40px;">Note: this new PAW dataset has a
smaller
<span style="font-style: italic;">r</span><sub
 style="font-style: italic;">PAW</sub> radius (because semi-core states
are localized).</div><div style="margin-left: 80px;"><span
 style="color: rgb(153, 0, 0);"></span><span style="font-style: italic;">a</span><sub
 style="font-style: italic;">0</sub> = 3.518 angstrom<br><span
 style="font-style: italic;">B</span> = 195 GPa<br>&#956; = 0.60</div><br><hr
 style="width: 100%; height: 2px;"><a name="9">&#160;</a>
<br><h3>8. The Real Space Optimization (RSO) - experienced users</h3>In
this chapter, an additional optimization of the atomic data
is proposed which can contribute, in some cases, to an acceleration of
the convergence on&#160;<span style="font-style: italic;">ecut</span>.
This
optimization is not essential to produce efficient PAW&#160;datasets
but
it can be useful. We advise experienced users to try it.<p> The idea is
quite simple: when expressing the different atomic radial functions
(&#966;<sub>i</sub>,<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>&#966;<sub>i</sub>,&#160;<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>)
on the plane
waves basis, the number of plane waves depends on the
"locallity" of these radial functions in reciprocal space.<br>In the
following reference (we suggest to read it): <span
 style="color: rgb(51, 51, 255);">&#160;R.D. King-Smith,
M.C. Payne, J.S. Lin, Phys. Rev. B </span><span
 style="font-weight: bold; color: rgb(51, 51, 255);">44</span><span
 style="color: rgb(51, 51, 255);">,
13063 (1991)</span></p>a method to enforce the
locallity (in reciprocal space) of <span style="font-weight: bold;">projectors</span><span
 style="position: relative; top: -5pt; left: 6pt;">~</span><span
 style="font-weight: bold;">p</span><sub><span
 style="font-weight: bold;">i</span> </sub><span
 style="position: relative; top: -5pt; left: 6pt;"></span><span
 style="font-weight: bold;"></span>is presented:<br><div
 style="margin-left: 40px;">Projectors<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
expressed in reciprocal space are
modified according to the following scheme:
</div><div style="margin-left: 40px;">The&#160;reciprocal space is
divided in 3 regions:
</div><div style="margin-left: 80px;">- If &#160;<span
 style="font-weight: bold; font-style: italic;">g &#60; g<sub>max</sub></span>,<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is unchanged
<br>- If &#160;<span style="font-weight: bold; font-style: italic;">g
&#62;</span> &#947;<span style="font-weight: bold; font-style: italic;"></span>,<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is set to zero
<br>- If <span style="font-style: italic; font-weight: bold;">g<sub>max</sub>&#60;
g &#60; </span>&#947;<span
 style="font-weight: bold; font-style: italic;"></span>,<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is modified so that&#160;the contribution of<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(r)
is
conserved&#160;with an error <span
 style="font-weight: bold; font-style: italic;">W</span> (as small as
possible).
</div><div style="margin-left: 80px;"><img
 style="width: 394px; height: 409px;" alt="RSO"
 src="lesson_paw2/RSO.png"></div><div style="margin-left: 40px;">The
above transformation of<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is only possible if<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(r)
is defined outside the augmentation sphere up to a radius <span
 style="font-weight: bold; font-style: italic;">R</span><sub
 style="font-weight: bold; font-style: italic;">0</sub> (with <span
 style="font-weight: bold; font-style: italic;">R</span><sub
 style="font-weight: bold; font-style: italic;">0</sub><span
 style="font-weight: bold; font-style: italic;">&#62;r</span><sub
 style="font-weight: bold; font-style: italic;">c</sub>).
</div><div style="margin-left: 320px;"></div>In practice we have to:
<br><div style="margin-left: 40px;">- Impose an error <span
 style="font-style: italic; font-weight: bold;">W</span> (<span
 style="font-weight: bold; font-style: italic;">W</span> is the maximum
error admitted on total energy)
<br>- Adjust <span style="font-weight: bold; font-style: italic;">g</span><sub
 style="font-weight: bold; font-style: italic;">max</sub> according to <span
 style="font-weight: bold; font-style: italic;">Ecut </span><span
 style="font-style: italic;"></span>(<span
 style="font-weight: bold; font-style: italic;">g<sub>max</sub>&#60;=
Ecut</span><span style="font-weight: bold;"></span>)
<br>- Choose <span style="font-weight: bold;">&#947;</span> so that <span
 style="font-weight: bold;">2*g</span><sub style="font-weight: bold;">max</sub><span
 style="font-weight: bold;"> &#60; &#947; &#60; 3*g</span><sub
 style="font-weight: bold;">max</sub>
</div>and the <span style="font-weight: bold;">AtomPAW2ABINIT</span>
code
apply the transformation to<span
 style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>
and deduce <span style="font-weight: bold; font-style: italic;">R</span><sub
 style="font-weight: bold; font-style: italic;">0</sub> radius.
<br><br>You can test it now.
<br>In your working directory, <span style="color: rgb(153, 0, 0);">re-use
the dataset with Bloechl projectors <span style="color: rgb(0, 0, 0);">(</span></span><a
 href="lesson_paw2/Ni.atompaw.input3">~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input3</a><span
 style="color: rgb(0, 0, 0);">).</span><br><span
 style="color: rgb(153, 0, 0);">Run ATOMPAW</span>.<br>Then&#160;<span
 style="color: rgb(153, 0, 0);">launch AtomPAW2Abinit, answering "y" to
the question "</span><span
 style="font-style: italic; color: rgb(153, 0, 0);">Do you want to
improve non-local projector by using RSO ?</span><span
 style="color: rgb(153, 0, 0);">"</span>.<br><span
 style="color: rgb(153, 0, 0);">Then type "8, 2, 0.0001" to the last
question</span>
(asking for&#160;<small><span
 style="font-weight: bold; font-style: italic;">g</span><sub
 style="font-weight: bold; font-style: italic;">max</sub></small><span
 style="font-weight: bold; font-style: italic;"></span><span
 style="font-weight: bold; font-style: italic;">,&#160;</span><span
 style="font-weight: bold;">&#947;/</span><span
 style="font-weight: bold; font-style: italic;"></span><span
 style="font-style: italic;"></span><span
 style="font-weight: bold; font-style: italic;">g<sub>max</sub></span>and
<span style="font-style: italic; font-weight: bold;">W</span>).<br>You
get a new psp file for ABINIT.<br><span style="color: rgb(153, 0, 0);">Run
ABINIT with it using the </span><span style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_1.in</span><span
 style="color: rgb(153, 0, 0);"> file</span>.<br>Compare the results
with those obtained in chapter 7.<br><p>You
can try several values for&#160;<small><span
 style="font-weight: bold; font-style: italic;">g</span><sub
 style="font-weight: bold; font-style: italic;">max</sub></small><span
 style="font-weight: bold; font-style: italic;"></span>
(keeping <span style="font-weight: bold;">&#947;/</span><span
 style="font-weight: bold; font-style: italic;"></span><span
 style="font-style: italic;"></span><span
 style="font-weight: bold; font-style: italic;">g<sub>max</sub></span>and
<span style="font-style: italic; font-weight: bold;">W</span><span
 style="font-style: italic;"> constant)</span> and compare the
efficiency of the atomic data; do not forget to test
physical properties again.</p><p style="margin-left: 80px;"><img
 style="height: 446px; width: 434px;" alt="RSO comparison"
 src="lesson_paw2/RSOcompa.jpg"></p><p style="font-style: italic;">How
to choose the RSO parameters ?</p><div style="margin-left: 80px;"><small><span
 style="font-weight: bold; font-style: italic;">&#947;/</span></small><small><span
 style="font-weight: bold; font-style: italic;">g</span><sub
 style="font-weight: bold; font-style: italic;">max</sub></small><span
 style="font-weight: bold; font-style: italic;">=2</span> and <span
 style="font-style: italic; font-weight: bold;">0.0001 &#60; W &#60;
0.001</span> is a good choice.
<br><small><span style="font-weight: bold; font-style: italic;"></span></small><small><span
 style="font-weight: bold; font-style: italic;">g</span><sub
 style="font-weight: bold; font-style: italic;">max</sub></small><span
 style="font-weight: bold; font-style: italic;"></span>&#160;has to be
adjusted. The lower&#160;<small><span
 style="font-weight: bold; font-style: italic;">g</span><sub
 style="font-weight: bold; font-style: italic;">max</sub></small>&#160;the
faster the convergence is ; but too low&#160;<small><span
 style="font-weight: bold; font-style: italic;"></span></small><small><span
 style="font-weight: bold; font-style: italic;">g</span><sub
 style="font-weight: bold; font-style: italic;">max</sub></small><span
 style="font-weight: bold; font-style: italic;"></span> can produce
unphysical results.</div><p
 style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"></p></div></div><hr
 style="width: 100%; height: 2px;">

Goto :
<A href="http://www.abinit.org"><B>ABINIT home Page</B></A>
<B> | </B>
<A href="../users/acknowledgments.html"><B>Suggested acknowledgments</B></A>
<B> | </B>
<A href="../input_variables/keyhr.html"><B>List of input variables</B></A>
<B> | </B>
<A href="welcome.html"><B>Tutorial home page</B></A>
<B> | </B>
<A href="../users/bibliography.html"><B>Bibliography</B></A>
<HR ALIGN=left>
Help files :
<A href="../users/new_user_guide.html"><B>New user's guide</B></A>
<B> | </B>
<A href="../users/abinis_help.html"><B>Abinis (main)</B></A>
<B> | </B>
<A href="../users/respfn_help.html"><B>Abinis (respfn)</B></A>
<B> | </B>
<A href="../users/mrgddb_help.html"><B>Mrgddb</B></A>
<B> | </B>
<A href="../users/anaddb_help.html"><B>Anaddb</B></A>
<B> | </B>
<A href="../users/aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="../users/cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="../users/optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="../users/mrgscr_help.html"><B>Mrgscr</B></A>
<HR ALIGN=left>

</body>
</html>


