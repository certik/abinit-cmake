<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>ABINIT. Tutorial spin</title>
</head>
<body style="background-color: rgb(255, 255, 255);">
<hr>
<h1>ABINIT, spin lesson of the tutorial: </h1>
<h2>Properties related to spin: spin polarized calculations and
spin-orbit coupling. </h2>
<hr>
<p>This lesson aims at showing how to get the following physical
properties:
</p>
<ul>
  <li>the total magnetisation of a ferromagnetic material<br>
  </li>
  <li>the magnetisation of an antiferromagnetic material<br>
  </li>
  <li>analyse the total density of states per spin direction&nbsp; <br>
  </li>
  <li>analyse the density of states per atom and per spin direction<br>
  </li>
  <li>look at the effect of spin-orbit coupling for a non magnetic
system<br>
  </li>
  <li>non-collinear magnetism (not yet) </li>
  <li>&nbsp;spin-orbit coupling and magnetocristalline anisotropy (not
yet) </li>
</ul>
You will learn to use of&nbsp; features of ABINIT which deal with spin.<br>
<p>This lesson should take about (to be provided) hours to be done.
</p>
<h5>Copyright (C) 2005-2008 ABINIT group (GZ)
<br>
This file is distributed under the terms of the GNU General Public
License, see
~abinit/COPYING or <a
 href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br>
For the initials of contributors, see ~abinit/doc/developers/contributors.txt .
</h5>
<hr align="left">
Goto :
<a href="http://www.abinit.org"><b>ABINIT home Page</b></a>
<b> | </b>
<a href="../users/acknowledgments.html"><b>Suggested acknowledgments</b></a>
<b> | </b>
<a href="../input_variables/keyhr.html"><b>List of input variables</b></a>
<b> | </b>
<a href="welcome.html"><b>Tutorial home page</b></a>
<b> | </b>
<a href="../users/bibliography.html"><b>Bibliography</b></a>
<hr align="left">Help files :
<a href="../users/new_user_guide.html"><b>New user's guide</b></a>
<b> | </b>
<a href="../users/abinis_help.html"><b>Abinis (main)</b></a>
<b> | </b>
<a href="../users/respfn_help.html"><b>Abinis (respfn)</b></a>
<b> | </b>
<a href="../users/mrgddb_help.html"><b>Mrgddb</b></a>
<b> | </b>
<a href="../users/anaddb_help.html"><b>Anaddb</b></a>
<B> | </B>
<A href="../users/aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="../users/cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="../users/optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="../users/mrgscr_help.html"><B>Mrgscr</B></A>
<hr align="left"><br>
&nbsp;
<h3><b>Content of spin lesson</b></h3>
<ul>
  <li><a href="lesson_spin.html#gz1">1</a> <b>A ferromagnetic
material: the&nbsp; bcc Fe</b></li>
  <li><a href="lesson_spin.html#gz2">2</a> <b>An antiferomagnetic
example: fcc Fe</b></li>
  <li><a href="lesson_spin.html#gz3">3</a> <b>Another look at fcc Fe</b>
  </li>
  <li><a href="lesson_spin.html#gz4">4</a> <b>A ferrimagnetic example
(</b>Mn<sub>4</sub>N<b>)(Not yet)</b> </li>
  <li><a href="lesson_spin.html#gz5">5</a> <b>The spin-orbit coupling</b>
  </li>
  <li><a href="lesson_spin.html#gz6">6</a> <b>Rotation of the
magnetization and Spin-orbit (not yet)</b></li>
</ul>
<hr>
<p><a name="gz1"></a><br>
</p>
<h3><b>1. A ferromagnetic material: the&nbsp; bcc Fe</b> </h3>
<h3>&nbsp;</h3>
<p>
<i>Before beginning, you might consider to work in a different
subdirectory as
for the other lessons. Why not "Work_spin" ? </i> <br>
</p>
<p>The file ~abinit/tests/tutorial/Input/tspin_x.files lists the file names and root
names. You can copy it in the Work_spin directory (and change it, when
needed, as
usual). <br>
You can also copy the file ~abinit/tests/tutorial/Input/tspin_1.in in Work_spin. This
is your input file. You can run the calculation, then you should edit 
the input file, and read it carefully. 
<br>Because
we are going to perform magnetic calculations, there a two new types of
variables:<br>
</p>
<ul>
  <li><a href="../input_variables/varbas.html#nsppol" target="kwimg"><span
 style="text-decoration: underline;">nsppol</span></a><br>
  </li>
  <li><a href="../input_variables/vargs.html#spinat" target="kwimg"><span
 style="text-decoration: underline;">spinat</span></a><br>
  </li>
</ul>
Please, read their description in the help file. 
<br>
You will work at fixed <a href="../input_variables/varbas.html#ecut" target="kwimg">ecut</a>
(=18Ha) and k-point grid, defined by <a
 href="../input_variables/vargs.html#kptrlatt" target="kwimg">kptrlatt</a>
(the 4x4x4 Monkhorst-Pack grid). It is implicit that in "real life",
you should do a convergence test with
respect to both convergence parameters. <br>
This takes about 30 seconds on a 2.8 Ghz PC, but one needs a sufficiently large cut-off
to exhibit magnetic effects.<br>
We will compare the output with and without
magnetisation. (Hence, there are two datasets in the run)<br>
We now look at the output file.<br>
In the magnetic case, the electronic density is split in two parts, the
"Spin-up" and the "Spin-down" parts to which correspond different
Kohn-Sham potentials and different sets of eigenvalues whose occupation 
are given by the Fermi-Dirac function (without the ubiquitous factor 2)<br>
<br>
For the first k-point, we get for instance:<br>
(no magnetization)<br>
&nbsp;&nbsp;<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;
occ&nbsp;&nbsp; &nbsp; 2.00000&nbsp;&nbsp; 1.99989&nbsp;&nbsp;
1.99989&nbsp;&nbsp; 1.22915&nbsp;&nbsp; 1.22915&nbsp;&nbsp;
0.28676&nbsp;&nbsp; 0.00000&nbsp;&nbsp; 0.00000</span><br>
(magnetic case)<br>
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
occ&nbsp;&nbsp; 1.00000&nbsp;&nbsp; 0.99999&nbsp;&nbsp;
0.99999&nbsp;&nbsp; 0.98396&nbsp;&nbsp; 0.98396&nbsp;&nbsp;
0.69467&nbsp;&nbsp; 0.00000&nbsp;&nbsp; 0.00000 (spin-up)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1.00000&nbsp;&nbsp; 0.99730&nbsp;&nbsp; 0.99730&nbsp;&nbsp;
0.00898&nbsp;&nbsp; 0.00898&nbsp;&nbsp; 0.00224&nbsp;&nbsp;
0.00000&nbsp;&nbsp; 0.00000 (spin-down)<br>
<br>
</span>We note that the occupation are very different for up and down
spins, which means that the eigenvalues are shifted which is in turn
due to
a shift of the exchange-correlation potential, and therefore of the
effective potential. You can indeed have a look at the output file to
compare spin-up and down&nbsp; eigenvalues:<br>
&nbsp; <span style="font-family: monospace;">-0.48411&nbsp;
-0.38615&nbsp; -0.38615&nbsp; -0.30587&nbsp; -0.30587&nbsp;
-0.27293&nbsp;&nbsp; 0.33747&nbsp;&nbsp; 0.33747 (up, kpt#1)<br>
&nbsp;-0.46638&nbsp; -0.32383&nbsp; -0.32383&nbsp; -0.21767&nbsp;
-0.21767&nbsp; -0.20371&nbsp;&nbsp; 0.36261&nbsp;&nbsp; 0.36261 (dn,
kpt#1)</span><br>
<br>
The magnetization density (in unit of mu_B - Bohr's magneton) is the difference between
the up and down densities. The magnetization density, divided by the total 
density is noted "zeta". This quantity "zeta" can vary between -1 and 1. It is
everywhere zero in the non-magnetic case. In the magnetic case, we can
read for instance its minimal and maximal values in the output file:<br>
<br>
<span style="font-family: monospace;">Min spin pol zeta= -4.8326E-02 at
reduced coord.&nbsp; 0.7222&nbsp; 0.5000&nbsp; 0.2222<br>
&nbsp;&nbsp;&nbsp; &nbsp;next min= -4.8326E-02 at reduced coord.&nbsp;
0.5000&nbsp; 0.7222&nbsp; 0.2222<br>
Max spin pol zeta=&nbsp; 5.7306E-01 at reduced coord.&nbsp;
0.0000&nbsp; 0.8889&nbsp; 0.8889<br>
&nbsp;&nbsp;&nbsp; &nbsp;next max=&nbsp; 5.7306E-01 at reduced
coord.&nbsp; 0.8889&nbsp; 0.0000&nbsp; 0.8889</span><br>
The total magnetization, its integral on the unit cell, is
now in the magnetic case:<br>
<br>
&nbsp;
<span style="font-family: monospace;">Magnetisation (Bohr
magneton)=&nbsp; 1.96743487E+00<br>
&nbsp;Total spin up =&nbsp; 4.98371743E+00&nbsp;&nbsp; Total spin down
=&nbsp; 3.01628257E+00<br>
<br>
</span>We observe that the total density (up+down) yields 8.000 as
expected.<br>
<br>
The magnetization density is not the only changed quantity. The
energy is changed too, and we get:<br>
&nbsp;<br>
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; etotal1&nbsp;
-2.4661707269E+01</span><span style="font-family: monospace;">&nbsp;
(no magnetisation)</span><br>
<span style="font-family: monospace;">&nbsp;&nbsp;&nbsp; etotal2&nbsp;
-2.4670792869E+01&nbsp; </span><span style="font-family: monospace;">(with
magnetisation)</span><br>
<br>
The energy of the magnetized system is the lowest and therefore
energetically favoured, as expected since bcc iron is a ferromagnet.<br>
Finally, one notes also that the stress tensor is affected by the
magnetization. This would also be true for&nbsp; the forces for a less symmetric material.<br>
<br>
It is interesting to consider in more details the distribution of
eigenvalues for each direction of magnetization, which is best done by
looking&nbsp; at the respective densities of state.<br>
To this end we have set 
<a href="../input_variables/varfil.html#prtdos" target="kwimg">prtdos</a>= 1 
in the input file, in order to obtain the density
of states corresponding to spin-up and spin-down electrons (as soon as
<a href="../input_variables/varbas.html#nsppol" target="kwimg">nsppol</a>=2). <br>
The values of the DOS are in the files tspin_1o_DS1_DOS and
tspin_1o_DS2_DOS for the magnetic and non magnetic case respectively. We
can extract the values for use in a plotting software.<br>
Traditionally, in order to enhance visibility, one affects&nbsp; with a
negative sign the DOS of&nbsp; minority&nbsp; electrons. If we compare
the <a href="lesson_spin/bccfe_mag_dos2.jpg" target="img">DOS of
the magnetized</a> system and the <a
 href="lesson_spin/bccfe_nonmag_dos2.jpg" target="img">non
magnetized</a> system, we observe that the up and down DOS have
been&nbsp;
"shifted" with respect each other.<br>
The integrated density of states yields the number
of electrons for each spin direction and
we see the magnetization
which arises from the fact that there are more up than down electrons
at the Fermi level.<br>
<br>
That the magnetization points upwards is fortuitous,
and we can get it pointing downwards by changing the sign of the&nbsp;
initial <a href="../input_variables/vargs.html#spinat" target="kwimg">spinat</a>.
<br>
Indeed, in the absence of spin-orbit coupling, there is no relation
between the direction of magnetization and the cristal axes.<br>
If we start with a <a href="../input_variables/vargs.html#spinat" target="kwimg">spinat</a>
of 0, the magnetisation
remains 0. <a href="../input_variables/vargs.html#spinat" target="kwimg">spinat</a> gives 
indeed a way to initially break the spin symmetry.<br>
<br>
<hr>
<p><a name="gz2"></a><br>
</p>
<h3><b>2. An antiferromagnetic example: fcc Fe</b> </h3>
<h3>&nbsp;</h3>
Well sort of.... <br>
Actually, Fcc Fe, displays many complicated structures, in particular
spin spirals. A spiral is characterized by a direction along an axis,
an angle of the magnetization with respect to this axis and a step
after which a rotation is complete.<br>
A very simple particular case is when the angle is 90&deg;, the axis is
&lt;100&gt; and the step is the
unit cell side, spin directions are alternating in every two planes
perpendicular to the &lt;100&gt; axis ("spiral stairway")<br>
For instance, if the atom at [x,y,0] possesses
an
"up" magnetization, the atom at [x,y,1/2] would possess a down
magnetization etc...<br>
To describe such a structure, we merely need two atoms, [0,0,0] and
[1/2,0,1/2] and a unit cell comprising those two atoms.<br>
Also, each atom will be given opposite magnetization with the help of
the variable <a href="../input_variables/vargs.html#spinat" target="kwimg">spinat</a>.<br>
<br>
You can copy the file ~abinit/tests/tutorial/Input/tspin_2.in in Work_spin.
This is your input file. Modify accordingly the tspin_x.files file.
You can run the calculation, then you should edit the tspin_2.in file,
and briefly
look at the two changes with respect to the file
tspin_1.in : the change of unit cell basis vectors <a
 href="../input_variables/varbas.html#rprim" target="kwimg">rprim</a>,
the new <a href="../input_variables/vargs.html#spinat" target="kwimg">spinat</a>.
<br> Note also we use now <a
 href="../input_variables/varbas.html#nsppol" target="kwimg">nsppol</a>=1 and <a
 href="../input_variables/vargs.html#nspden" target="kwimg">nspden</a>=2 : this combination
of values is only valid when performing an antiferromagnetic
calculation. It uses the so-called Shubnikov symmetries, to perform calculations twice faster
than with <a
 href="../input_variables/varbas.html#nsppol" target="kwimg">nsppol</a>=2 and <a
 href="../input_variables/vargs.html#nspden" target="kwimg">nspden</a>=2<br>.
The symmetry of the
crystal is not the full fcc symmetry anymore since the symmetry must
now preserve the magnetization of each atom.&nbsp; Abinit is
nevertheless able to detect such symmetry belonging to the
Shubnikov groups and correctly detects that the cell is
primitive,
which would not be the case if we had the same value of 
<a href="../input_variables/vargs.html#spinat" target="kwimg">spinat</a> on each
atom.<br>
If we now run again the calculation, this calculation will take
approximately 2 minutes on a 2.8 Ghz cpu.<br>
If we look at the eigenvalues and occupations, they are again affected
by a factor 2, which results from the
symmetry considerations alluded to above, and not from the "usual"
spin degeneracy : the potential for spin-up is equal to the potential
for spin-down, shifted by the antiferromagnetic translation vector. Eigenergies
are identical for spin-up and spin-down, but wavefunctions are shifted
one with respect to the other.<br>
<br>
&nbsp;
<span style="font-family: monospace;">kpt#&nbsp;&nbsp; 1, nband= 16,
wtk=&nbsp; 0.05556, kpt=&nbsp; 0.0833&nbsp; 0.0833&nbsp; 0.1250
(reduced coord)<br>
&nbsp; -0.60539&nbsp; -0.47491&nbsp; -0.42613&nbsp; -0.39022&nbsp;
-0.35973&nbsp; -0.34377&nbsp; -0.28893&nbsp; -0.28827<br>
&nbsp; -0.25318&nbsp; -0.24042&nbsp; -0.22944&nbsp;
-0.14218&nbsp;&nbsp; 0.20264&nbsp;&nbsp; 0.26203&nbsp;&nbsp;
0.26641&nbsp;&nbsp; 0.62158<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; occupation numbers for kpt#&nbsp;&nbsp; 1<br>
&nbsp;&nbsp; 2.00000&nbsp;&nbsp; 2.00000&nbsp;&nbsp;
2.00000&nbsp;&nbsp; 1.99997&nbsp;&nbsp; 1.99945&nbsp;&nbsp;
1.99728&nbsp;&nbsp; 1.50517&nbsp;&nbsp; 1.48016<br>
&nbsp;&nbsp; 0.15706&nbsp;&nbsp; 0.04649&nbsp;&nbsp;
0.01576&nbsp;&nbsp; 0.00000&nbsp;&nbsp; 0.00000&nbsp;&nbsp;
0.00000&nbsp;&nbsp; 0.00000&nbsp;&nbsp; 0.00000<br>
<br>
</span><span style="font-family: monospace;"><br>
<br>
</span>How do we know we have a magnetic order?<br>
The&nbsp; density of state used for bcc Fe&nbsp; will not be useful
since the net
magnetization is
zero and we have as many up and down electrons.<br>
Though, the magnetization is reflected in the existence of an up
and down electronic density whose sum is the total density and whose
difference yields the net magnetization density at each
point in real space.<br>
In particular, the integral of the magnetization around each atom will give an
indication of the magnetic moment carried by this particular atom.<br>
To perform this integration, we will use the utility cut3d which yields
an interpolation of the magnetization at any point in space. Reminder: you should
build cut3d by issuing in ~abinit : make cut3d<br>
As of now cut3d is interactive, we will use it through a very
primitive script (written in Python) to perform a rough estimate of the
magnetization on each atom.<br>
You can have a look at the ~abinit/doc/tutorial/lesson_spin/gz2.py
program, and note (or believe) that
it does
perform an
integration of magnetization on a&nbsp; cube of side acell/2 around each atom.<br>
Copy it in your Work_spin directory.
If you run the program, by typing "python gz2.py" , you will see the
result:<br>
magnetization of atom 1=&nbsp; 0.38211<br>
magnetization of atom 2=-0.38202<br>
which shows that the magnetization of each atom are actually opposite.
<br>
In a next version of the tutorial, we might use the cut3d library.<br>
With the next input file tspin_3.in, we will consider this same problem, but in a
different way, and note, for future record that the total energy is:
Etotal=-4.92489586027187E+01<br>
<br>
<br>
<br>
<hr>
<p><a name="gz3"></a><br>
</p>
<h3><b>3. Another look at fcc Fe</b> </h3>
Instead of treating fcc Fe directly as an antiferromagnetic material,
we will not make any hypotheses<br>
on its magnetic structure, and run the calculation like the one for fcc
Fe, anticipating only that the two<br>
spin directions are going to be different. We will not even assume
that the initial spins are of the same magnitude.<br>
You can copy the file ~abinit/tests/tutorial/Input/tspin_3.in in Work_spin.
This is your input file. You can modify the file tspin_x.files, and
immediately start running the calculation. Then, you should edit it.
Note the values of 
<a href="../input_variables/vargs.html#spinat" target="kwimg">spinat</a>. In this job,
we wish again to characterize the magnetic structure.<br>
We are not going to use zeta as in the preceding calculation, but we
will here use another feature of abinit: atom and angular
momentum
projected densities of state.<br>
These are densities of state&nbsp; weighted by the projection of the
wave functions on angular momentum channels (that is spherical
harmonics) centered on each atom of the system. <br>
Note that theses DOS are computed with the thetrahedron method,
which is rather time consuming and<br>
produces less smooth DOS than the smearing method. The time is
strongly dependent on the number of kpoints and we use here only a
reduced set.<br>
(This will take about 4 minutes on a 2.8 Ghz computer)<br>
To specify this calculation we need new variables, in addition to
<a href="../input_variables/varfil.html#prtdos" target="kwimg">prtdos</a> set now to 3 :<br>
<ul>
  <li><a href="../input_variables/vargs.html#natsph" target="kwimg">natsph</a></li>
  <li><a href="../input_variables/vargs.html#iatsph" target="kwimg">iatsph</a></li>
  <li><a href="../input_variables/vargs.html#ratsph" target="kwimg">ratsph<br>
    </a></li>
</ul>
<br>
This will specify the atoms around which the calculation will be
performed, and the radius of the sphere. <br>
We specifically select a new dataset for each atom, a non
self-consistent calculation being run to generate<br>
the projected density of states.<br>
First, we note that the value of the energy is:<br>
Etotal=-4.92489557316370E+01 which shows that we have attained
presumably the same state as above.<br>
<br>
The density of states will be in the files tspin_3o_DS2_DOS_AT0001 for
the first atom, and tspin_3o_DS3_DOS_AT0002 for the second atom.<br>
We can extract the density of d states, which carries most of the
magnetic
moment and whose integral up to the Fermi level will yield an
estimate of the magnetization on each atom.<br>
We note the Fermi level (recalled in the file tspin_3o_DS1_DOS) <br>
&nbsp;<span style="font-family: monospace;">Fermi energy
:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; -0.27799778</span><br>
If we have a look at the
integrated site projected density of states,
we can compute the total moment on each atom. To this end, one can edit
the file tspin_3o_DS3_DOS_AT0002, which contains information pertaining to
atom 2. This file is self documented, and describes on each line, for
spin up and spin down:<br>
<br>
<span style="font-family: monospace;">&nbsp;index&nbsp;
energy(Ha)&nbsp; l=0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
l=1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l=2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
l=3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; l=4&nbsp;&nbsp; (integral=&gt;)
l=0&nbsp;&nbsp;&nbsp; l=1&nbsp;&nbsp;&nbsp; l=2&nbsp;&nbsp;&nbsp;
l=3&nbsp;&nbsp;&nbsp; l=4</span><br>
<br>
If we look for the lines containing&nbsp; an energy of
"-0.27800",&nbsp; we find <br>
<span style="font-family: monospace;">6440&nbsp;&nbsp;
-0.27800&nbsp;&nbsp; 0.2070&nbsp;&nbsp; 1.3021&nbsp;
47.5017&nbsp;&nbsp; 0.3928&nbsp;&nbsp; 0.1723&nbsp;&nbsp;
0.30&nbsp;&nbsp;&nbsp; 0.34&nbsp;&nbsp;&nbsp; 3.22&nbsp;&nbsp;&nbsp;
0.04&nbsp;&nbsp;&nbsp; 0.01 (up)</span><br
 style="font-family: monospace;">
<span style="font-family: monospace;">6440&nbsp;&nbsp;
-0.27800&nbsp;&nbsp; 0.4656&nbsp;&nbsp; 1.8227&nbsp;
26.0414&nbsp;&nbsp; 0.5495&nbsp;&nbsp; 0.1748&nbsp;&nbsp;
0.30&nbsp;&nbsp;&nbsp; 0.35&nbsp;&nbsp;&nbsp; 3.54&nbsp;&nbsp;&nbsp;
0.04&nbsp;&nbsp;&nbsp; 0.01 (dn)<br>
<br>
</span><br>
There are apparently changes in the densities of states for all the
channels, but besides the d-channels, these are indeed fluctuations.
This is confirmed by looking at the integrated density of states which
is different only for the d-channel. The difference between up and down
is .32, in good agreement (regarding our very rough methods of
integration) with the preceeding calculation. Using a calculation with
the same number of k points for the projected DOS, we can <a
href="lesson_spin/energy_diff_fccfe.jpg" target="img">plot</a> the
up-down integrated dos difference for the d-channel. Note that there is some scatter
in this graph, due to the finite number of digits (2 decimal places) of the
integrated dos given in the file tspin_3o_DS3_DOS_AT0002.<br>
<br>
If we now look at the up and down DOS for each atom, we can see that
the corner atom and the face atom possess opposite magnetizations,
which exactly cancel each other. The density of states computed with
the tetrahedron method is not as smooth as by the smearing
method, and a running average allows for a better view.<br>
<br>
<br>
<br>
<br>
<br>
<br>
<hr>
<p><a name="gz4"></a><br>
</p>
<h3><b>4. A ferrimagnetic example </b><b>(Not yet)</b>
</h3>
Some materials can display a particular form of ferromagnetism, which
also can be viewed as non
compensated antiferromagnetism, called ferrimagnetism.<br>
Some atoms possess up spin and other possess down spin, but the
total spin magnetization is non zero.<br>
This happens generally for system with different type of atoms, and
sometimes in
rather complicated structures. <br>
Here, we will perform&nbsp; a calculation on a "simple"
structure .<br>
<br>
<br>
<hr>
<p><a name="gz5"></a><br>
</p>
<h3><b>5. The spin-orbit coupling</b> </h3>
<h3>&nbsp;<small><span style="font-weight: normal;">For heavy atoms a
relativistic description of the electronic structure becomes necessary,
and this can be accomplished through the relativistic LDA
approximation. For atoms, the Dirac equation is solved and the 2(2l+1)
l-channel degeneracy is lifted according to the eigenvalues of the <span
 style="font-weight: bold;">L+S </span>operator (l+1/2 and l-1/2 of
degeneracy 2l+2 and 2l). After pseudization, the&nbsp; associated wave
functions can be recovered by adding to usual pseudo-potential
projectors a spin-orbit term of the generic form
v(r)|l,s&gt;L.S&lt;l,s| . Not all potentials include this additional
term, but it turns out that it is the case for all the HGH type
pseudopotentials. In a plane wave calculation, the wavefunctions will be
two components spinors, that is will have a spin-up and a spin-down
component but these components will be coupled. This mean the size of
the Hamiltonian matrix is quadrupled. We will consider here a heavier
atom than Iron: Tantalum. You will have to change the "files" file
accordingly, as we here have used the potential: 73ta.hghsc . 
It is a HGH pseudopotential, with semicore states.
Replace the last line of the tspin_x.files by
<pre>
../../Psps_for_tests/73ta.hghsc
</pre>
You can copy the file ~abinit/tests/tutorial/Input/tspin_5.in in Work_spin.
Change accordingly the file names in tspin_x.files, then run the
calculation. It takes about 90 secs on a 2.8 GHz PC machine.
</span></small></h3>
The input file contains new variables:<br>
<ul>
  <li><a href="../input_variables/vargs.html#so_psp" target="kwimg">so_psp</a></li>
  <li><a href="../input_variables/vargs.html#nspinor" target="kwimg">nspinor</a></li>
</ul>
Have a look at these.
In this run, we check that we recover the splitting of the atomic
level by performing a calculation in a big box.
Two calculations are launched with and without spin-orbit. <br>
We can easily follow the symmetry of the different levels of the non
spin orbit calculation:<br>
&nbsp;
<span style="font-family: monospace;">kpt#&nbsp;&nbsp; 1, nband= 26,
wtk=&nbsp; 1.00000, kpt=&nbsp; 0.0000&nbsp; 0.0000&nbsp; 0.0000
(reduced coord)<br>
-2.44772&nbsp; <br>
-1.46448&nbsp; -1.46448&nbsp; -1.46448&nbsp; <br>
-0.17051&nbsp; <br>
-0.10859&nbsp; -0.10859&nbsp; -0.10859&nbsp; -0.10746&nbsp; -0.10746<br>
<br>
</span>That is, the symmetry: s,p,s,d<br>
After application of the spin-orbit coupling, we now have to consider
twice as many levels:<br>
&nbsp;<span style="font-family: monospace;">kpt#&nbsp;&nbsp; 1, nband=
26, wtk=&nbsp; 1.00000, kpt=&nbsp; 0.0000&nbsp; 0.0000&nbsp; 0.0000
(reduced coord)<br>
-2.43309&nbsp; -2.43309&nbsp; <br>
-1.67343&nbsp; -1.67343&nbsp; -1.35515&nbsp; -1.35515&nbsp;
-1.35515&nbsp; -1.35515</span><span style="font-family: monospace;"> <br>
-0.16816&nbsp; -0.16816&nbsp; <br>
-0.11662&nbsp; -0.11662&nbsp; -0.11662&nbsp; -0.11662&nbsp;
-0.09254&nbsp; -0.09254</span><span style="font-family: monospace;">
-0.09152&nbsp; -0.09152&nbsp; -0.09152&nbsp; -0.09152 <br>
<br>
</span>The levels are not
perfectly degenerate, due to the finite size of the simulation box. We
can nevetheless compute the splitting of the levels, and we obtain, for
e.g. the p-channel: <span style="font-family: monospace;">1.67343-1.35515=0.31828
Ha<br>
</span>If we now consider the <a
 href="http://physics.nist.gov/PhysRefData/DFTdata/Tables/73Ta.html" target="img">NIST
table</a> of atomic data, we obtain :<br>
<br>
<span style="font-family: monospace;">5p splitting, table:
1.681344-1.359740=0.321604 Ha</span><span
 style="font-family: monospace;"><br>
5d splitting, table:&nbsp;&nbsp; .153395-.131684=0.021711 Ha<br>
<br>
</span>We obtain a reasonable agreement. <br>
A more converged (and more expensive calculation) would yield:<br>
<br>
<span style="font-family: monospace;">5p splitting, abinit: </span><span
 style="font-family: monospace;">1.64582-1.32141=0.32441 Ha<br>
</span><span style="font-family: monospace;">5d splitting,
abinit:&nbsp;&nbsp; </span><span style="font-family: monospace;">.09084-.11180=0.02096
Ha<br>
<br>
<br style="font-family: monospace;">
</span><span style="font-family: sans-serif;"><br>
<br>
<br>
<br>
</span>
<hr>
<p><a name="gz6"></a><br>
</p>
<h3><b>6. Rotation of the magnetization and Spin-orbit (not yet)</b>
</h3>
The most spectacular manifestation of the spin-orbit coupling is the
energy associated with a rotation of the magntisation with respect with
the cristal axis. It is at the origin of the magneto cristalline
anisotropy of paramount technological importance.<br>
<hr>
<br>
<p>This ABINIT tutorial is now finished...
<br>
GZ would like to thank B. Siberchicot for useful comments.<br>
</p>
<hr align="left">Goto :
<a href="http://www.abinit.org"><b>ABINIT home Page</b></a>
<b> | </b>
<a href="../users/acknowledgments.html"><b>Suggested acknowledgments</b></a>
<b> | </b>
<a href="../input_variables/keyhr.html"><b>List of input variables</b></a>
<b> | </b>
<a href="welcome.html"><b>Tutorial home page</b></a>
<b> | </b>
<a href="../users/bibliography.html"><b>Bibliography</b></a>
<hr align="left">Help files :
<a href="../users/new_user_guide.html"><b>New user's guide</b></a>
<b> | </b>
<a href="../users/abinis_help.html"><b>Abinis (main)</b></a>
<b> | </b>
<a href="../users/respfn_help.html"><b>Abinis (respfn)</b></a>
<b> | </b>
<a href="../users/mrgddb_help.html"><b>Mrgddb</b></a>
<b> | </b>
<a href="../users/anaddb_help.html"><b>Anaddb</b></a>
<B> | </B>
<A href="../users/aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="../users/cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="../users/optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="../users/mrgscr_help.html"><B>Mrgscr</B></A>
<hr align="left">
</body>
</html>
