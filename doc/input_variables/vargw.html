<html>
<head><title>ABINIT : GW input variables.</title>
<link rel=stylesheet type="text/css" href="formabinit.css">
</head>
<body bgcolor="#ffffff">

<hr>
<a name="top"></a>

<h1>ABINIT, GW input variables:</h1>
<h2>List and description.</h2>

<hr>

<br>This document lists and provides the description
of the name (keywords) of the GW input
variables to be used in the main input file of the abinis code.

<br>The new user is advised to read first the
  <a href="../users/new_user_guide.html">new user's guide</a>,
  then the <a href="../users/abinis_help.html">abinis help file</a>, 
  before reading the present file. It will be easier to discover the
  present file with the help of the two lessons 
  <a href="../tutorial/lesson_gw1.html">lesson_gw1</a> and 
  <a href="../tutorial/lesson_gw2.html">lesson_gw2</a> of the tutorial.
  Other input variables directly related to the GW computation are :
  <a href="varfil.html#getkss">getkss</a>&nbsp;&nbsp;
  <a href="varfil.html#getscr">getscr</a>&nbsp;&nbsp;
  <a href="vargs.html#optdriver">optdriver</a>.
  In case of parallel execution, the input variable 
  <a href="varpar.html#gwpara">gwpara</a>
  is used to choose between the different parallelization levels presently implemented
  (k-points or bands).
<br>
  Note also the <A href="../users/mrgscr_help.html"><B>Mrgscr</B></A> utility
  which allows to merge dielectric matrices calculated at different q-points 
  into a unique screening file that can be used for subsequent GW calculations. 
  <B> FIXME: broken link, file is missing!</B>

<h5>Copyright (C) 2002-2008 ABINIT group (XG)
<br> This file is distributed under the terms of the GNU General Public License, see
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br> For the initials of contributors, see ~abinit/doc/developers/contributors.txt .
</h5>


<HR ALIGN=left>
Goto :
<A href="http://www.abinit.org"><B>ABINIT home Page</B></A>
<B> | </B>
<A href="../users/acknowledgments.html"><B>Suggested acknowledgments</B></A>
<B> | </B>
<A href="keyhr.html"><B>List of input variables</B></A>
<B> | </B>
<A href="../tutorial/welcome.html"><B>Tutorial home page</B></A>
<B> | </B>
<A href="../users/bibliography.html"><B>Bibliography</B></A>
<HR ALIGN=left>
Help files :
<A href="../users/new_user_guide.html"><B>New user's guide</B></A>
<B> | </B>
<A href="../users/abinis_help.html"><B>Abinis (main)</B></A>
<B> | </B>
<A href="../users/respfn_help.html"><B>Abinis (respfn)</B></A>
<B> | </B>
<A href="../users/mrgddb_help.html"><B>Mrgddb</B></A>
<B> | </B>
<A href="../users/anaddb_help.html"><B>Anaddb</B></A>
<B> | </B>
<A href="../users/aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="../users/cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="../users/optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="../users/mrgscr_help.html"><B>Mrgscr</B></A>
<HR ALIGN=left>

Files that describe other input variables:<br>
<ul>
<li> Basic variables, <A href="varbas.html">VARBAS</a></li>
<li> Developper variables, <A href="vardev.html">VARDEV</a></li>
<li> File handling variables, <A href="varfil.html">VARFIL</a></li>
<li> Geometry builder + symmetry related variables, <A href="vargeo.html">VARGEO</a></li>
<li> Ground-state calculation variables, <A href="vargs.html">VARGS</a></li>
<li> Internal variables, <A href="varint.html">VARINT</a></li>
<li> Parallelisation variables, <A href="varpar.html">VARPAR</a></li>
<li> Projector-Augmented Wave variables, <A href="varpaw.html">VARPAW</a></li>
<li> Response Function variables, <A href="varrf.html">VARRF</a></li>
<li> Structural optimization variables, <A href="varrlx.html">VARRLX</a></li>
<li> Wannier90 interface variables, <A href="varw90.html">VARW90</a></li>
</ul>
<hr>

<h3><b> Content of the file : alphabetical list of variables.</b></h3>
 <br>A.
 <a href="vargw.html#awtr">awtr</a>&nbsp;&nbsp;
 <br>B.
 <a href="vargw.html#bdgw">bdgw</a>&nbsp;&nbsp;
 <br>C.
 <br>D.
 <br>E.
 <a href="vargw.html#ecuteps">ecuteps</a>&nbsp;&nbsp;
 <a href="vargw.html#ecutsigx">ecutsigx</a>&nbsp;&nbsp;
 <a href="vargw.html#ecutwfn">ecutwfn</a>&nbsp;&nbsp;
 <br>F.
 <a href="vargw.html#fftgw">fftgw</a>&nbsp;&nbsp;
 <a href="vargw.html#freqremax">freqremax</a>&nbsp;&nbsp;
 <a href="vargw.html#freqspmax">freqspmax</a>&nbsp;&nbsp;
 <br>G.
 <a href="vargw.html#gwcalctyp">gwcalctyp</a>&nbsp;&nbsp;
 <a href="vargw.html#gwcomp">gwcomp</a>&nbsp;&nbsp;
 <a href="vargw.html#gwgamma">gwgamma</a>&nbsp;&nbsp;
 <a href="vargw.html#gwmem">gwmem</a>&nbsp;&nbsp;
 <br>H.
 <br>I.
 <a href="vargw.html#inclvkb">inclvkb</a>&nbsp;&nbsp;
 <a href="vargw.html#icutcoul">icutcoul</a>&nbsp;&nbsp;
 <br>J.
 <br>K.
 <a href="vargw.html#kptgw">kptgw</a>&nbsp;&nbsp;
 <br>M.
 <br>N.
 <a href="vargw.html#nbandkss">nbandkss</a>&nbsp;&nbsp;
 <a href="vargw.html#nfreqim">nfreqim</a>&nbsp;&nbsp;
 <a href="vargw.html#nfreqmidm">nfreqmidm</a>&nbsp;&nbsp;
 <a href="vargw.html#nfreqre">nfreqre</a>&nbsp;&nbsp;
 <a href="vargw.html#nfreqsp">nfreqsp</a>&nbsp;&nbsp;
 <a href="vargw.html#npwkss">npwkss</a>&nbsp;&nbsp;
 <a href="vargw.html#nkptgw">nkptgw</a>&nbsp;&nbsp;
 <a href="vargw.html#nomegasrd">nomegasrd</a>&nbsp;&nbsp;
 <a href="vargw.html#nomegasf">nomegasf</a>&nbsp;&nbsp;
 <a href="vargw.html#npweps">npweps</a>&nbsp;&nbsp;
 <a href="vargw.html#npwsigx">npwsigx</a>&nbsp;&nbsp;
 <a href="vargw.html#npwwfn">npwwfn</a>&nbsp;&nbsp;
 <a href="vargw.html#nsheps">nsheps</a>&nbsp;&nbsp;
 <a href="vargw.html#nshsigx">nshsigx</a>&nbsp;&nbsp;
 <a href="vargw.html#nshwfn">nshwfn</a>&nbsp;&nbsp;
 <br>O.
 <a href="vargw.html#omegasrdmax">omegasrdmax</a>&nbsp;&nbsp;
 <br>P.
 <a href="vargw.html#ppmfrq">ppmfrq</a>&nbsp;&nbsp;
 <a href="vargw.html#ppmodel">ppmodel</a>&nbsp;&nbsp;
 <br>Q.
 <a href="vargw.html#qptdm">qptdm</a>&nbsp;&nbsp;
 <br>R.
 <a href="vargw.html#rhoqpmix">rhoqpmix</a>&nbsp;&nbsp;
 <br>S.
 <a href="vargw.html#soenergy">soenergy</a>&nbsp;&nbsp;
 <a href="vargw.html#spbroad">spbroad</a>&nbsp;&nbsp;
 <a href="vargw.html#splitsigc">splitsigc</a>&nbsp;&nbsp;
 <a href="vargw.html#spmeth">spmeth</a>&nbsp;&nbsp;
 <a href="vargw.html#symchi">symchi</a>&nbsp;&nbsp;
 <a href="vargw.html#symmorphi">symmorphi</a>&nbsp;&nbsp;
 <a href="vargw.html#symsigma">symsigma</a>&nbsp;&nbsp;
 <br>T.
 <br>U.
 <br>V.
 <br>W.
 <br>X.
 <br>Y.
 <br>Z.
 <a href="vargw.html#zcut">zcut</a>&nbsp;&nbsp;

<br><br><br><br><hr>

<font id="title"><a name="awtr">awtr</a></font>
<br><font id="definition">Mnemonics: evaluate the Adler-Wiser expression of $\chi^{(0)}_{KS}$ assuming Time-Reversal </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default 0 <b>(TODO: TO BE CHANGED TO 1)</b> </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations.
<p> 
This input variable defines whether the irreducible polarizability $\chi^{(0)}_{KS}$ has to be evaluated 
taking advantage of time-reversal symmetry or not. 

<ul> 
<li>  0 =&gt; Use "standard" Adler-Wiser expression without using time-reversal. 
In this case the irreducible polarizability is calculated summing over all the possible electronic
(both resonant and antiresonant).
<li>  1 =&gt; Take advantage of time-reversal symmetry to halve the number of transitions to be
explicitly considered. This method leads to a decrease in the CPU time by a factor two with respect
to the <b>awtr</b>=0 case.
</ul>

</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<font id="title"><a name="bdgw">bdgw</a></font>
<br><font id="definition">Mnemonics: BanDs for GW calculation </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer array bdgw(2,<a href="vargw.html#nkptgw">nkptgw</a>) </font>
<br><font id="default">Default is all 0's </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p>
For each k-point with number ikptgw in the range (1:<a href="vargw.html#nkptgw">nkptgw</a>), 
<b>bdgw(1,ikptgw)</b> is the number of the lowest band for which the GW computation must be done,
and <b>bdgw(2,ikptgw)</b> is the number of the highest band for which the GW computation must be done.
<p>
When <a href="vargw.html#gwcalctyp">gwcalctyp</a> &#62&#61 20,
the quasiparticle wavefunctions are computed and represented as linear combination of some Kohn-Sham wavefunctions.
In this case <b>bdgw</b> designates the KS wavefunctions used as basis set.
For each k-point, indeed, the quasiparticle wavefunctions are expanded considering only the KS states between 
<b>bdgw(1,ikptgw)</b> and <b>bdgw(2,ikptgw)</b>.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="ecuteps">ecuteps</a></font>
<br><font id="definition">Mnemonics: Energy CUT-off for EPSilon (the dielectric matrix) </font>
<br><font id="category">Characteristic: GW, ENERGY </font>
<br><font id="vartype">Variable type: real parameter</font>
<br><font id="default">Default is 0.0 </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations.
<p>
<b>ecuteps</b> determines the cut-off energy of the planewave set used to represent the 
independent-particle susceptibility $\chi^{(0)}_{KS}$, the dielectric matrix $\epsilon$, and its inverse.
<br>
It is not worth to take <b>ecuteps</b> bigger than four times <a href="vargw.html#ecutwfn">ecutwfn</a>,
this latter limit corresponding to the highest Fourier components of a wavefunction convoluted with itself.
Usually, even twice the value of <a href="vargw.html#ecutwfn">ecutwfn</a> might overkill. 
In any case, a convergence study is worth.
<p> 
This set of planewaves can also be determined by the other input variables
<a href="vargw.html#npweps">npweps</a> and <a href="vargw.html#nsheps">nsheps</a>,
but these are much less convenient to use for general systems, than the selection 
criterion based on a cut-off energy.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="ecutsigx">ecutsigx</a></font>
<br><font id="definition">Mnemonics: Energy CUT-off for SIGma eXchange </font>
<br><font id="category">Characteristic: GW, ENERGY</font>
<br><font id="vartype">Variable type: real parameter</font>
<br><font id="default">Default is 0.0 </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations. 
This input variable was named "ecutmat" prior to v4.3 .
<p>
<b>ecutsigx</b> determines the cut-off energy of the planewave set used to generate the
exchange part of the self-energy operator.
<p> 
This set of planewaves can also be determined by the other input variables
<a href="vargw.html#npwsigx">npwsigx</a> and <a href="vargw.html#nshsigx">nshsigx</a>,
but these are much less convenient to use for general systems, than the
selection criterion based on the cut-off energy.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="ecutwfn">ecutwfn</a></font>
<br><font id="definition">Mnemonics: Energy CUT-off for WaveFunctions</font>
<br><font id="category">Characteristic: GW, ENERGY</font>
<br><font id="vartype">Variable type: real parameter</font>
<br><font id="default">Default is 0.0 </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening and sigma calculations.
<p>
<b>ecutwfn</b> determines the cut-off energy of the planewave set used to represent the wavefunctions
in the formula that generates the independent-particle susceptibility $\chi^{(0)}_{KS}$
(for <a href="vargs.html#optdriver">optdriver</a>=3), or the
self-energy (for <a href="vargs.html#optdriver">optdriver</a>=4).
<br>
Usually, <b>ecutwfn</b> is smaller than <a href="varbas.html#ecut">ecut</a>,
so that the wavefunctions are filtered, and some components are ignored.
As a side effect, the wavefunctions are no more normalized, and also, no more orthogonal.
Also, the set of plane waves can be much smaller for <a href="vargs.html#optdriver">optdriver</a>=3,
than for <a href="vargs.html#optdriver">optdriver</a>=4, although a convergence
study is needed to choose correctly both values.
<p> 
This set of planewaves can also be determined by the other input variables
<a href="vargw.html#npwwfn">npwwfn</a> and <a href="vargw.html#nshwfn">nshwfn</a>,
but these are much less convenient to use for general systems, than the
selection criterion based on the cut-off energy.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="fftgw">fftgw</a></font>
<br><font id="definition">Mnemonics: FFT for GW calculation</font>
<br><font id="category">Characteristic: GW </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 21.</font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations.
<p> 
The basic ingredients needed to perform both a screening and a sigma calculation are the so-called 
oscillator matrix elements defined as 

<br><br> $<
<B>k-q</B>, b1 | e^{-i (<B>q+G</B>).<B>r</B>} | <B>k</B> b2 >$ &nbsp;&nbsp;&nbsp;1)
<br><br>

In reciprocal space, Eq.1 is expressed by a convolution in which the number of reciprocal 
lattice vectors employed to describe the wavefunctions is given
by <a href="vargw.html#ecutwfn">ecutwfn</a> (<a href="vargw.html#npwwfn">npwwfn</a>
or <a href="vargw.html#nshwfn">nshwfn</a>). The number of <B>G</B> vectors in Eq.1 is defined
through  <a href="vargw.html#ecuteps">ecuteps</a> (<a href="vargw.html#npweps">npweps</a> or <a href="vargw.html#nsheps">nsheps</a>)
in case of screening calculations or 
<a href="vargw.html#ecutsigx">ecutsigx</a> (<a href="vargw.html#npwsigx">npwsigx</a> or <a
href="vargw.html#nshsigx">nshsigx</a>) in case of sigma calculations.
To improve the efficiency of the code, however, the oscillator matrix elements are evaluated 
in real space through FFT techniques, and the <b>fftgw</b> input variable is used to choose the FFT
mesh to be used during the calculation.
<p>
<b>fftgw</b> is the concatenation of two digits, labelled (A) and (B) whose value is internally used 
to define the value of  <a href="vargs.html#ngfft">ngfft</a>(1:3) (see the setmesh.F90 routine).
<p>
The first digit (A) defines the augmentation of the FFT grid. Possible values are 1, 2 and 3.

<ul>
<li> 0 =&gt; Use the FFT grid specified by the user through <a href="vargs.html#ngfft">ngfft</a>(1:3) </li>
<li> 1 =&gt; Use a coarse FFT grid which encloses a sphere in reciprocal space whose radius depends 
     on the largest value between 
     <a href="vargw.html#ecutwfn">ecutwfn</a> and <a href="vargw.html#ecuteps">ecuteps</a> </li>
<li> 2 =&gt;  Use a slightly augmented FFT which is sufficient for the correct treatment of the 
     convolution
<li> 3 =&gt; Doubled FFT grid (same mesh as that used for GS calculations).</li> 
</ul>

<p>
The second digit (B) can be chosen between 0 and 1. It defines whether a FFT grid compatible with all 
the symmetries of the space group must be enforced or not:

<ul>
<li> 0 =&gt; Use the smallest FFT mesh which is compatible with the FFT library (faster, save memory
but is less accurate)</li>
<li> 1 =&gt; Enforce a FFT grid which is compatible with all the symmetry operations of the space
group. This method leads to an increase both of CPU time and memory, but the matrix elements
are more accurate since the symmetry properties of the system are preserved.</li>
</ul>

The behaviour of ABINIT before v5.5 corresponds to the default value 11.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="freqremax">freqremax</a></font>
<br><font id="definition">Mnemonics:
FREQuencies along the Real axis MAXimum</font>
<br><font id="category">Characteristic: GW, ENERGY</font>
<br><font id="vartype">Variable type: real parameter  </font>
<br><font id="default">Default is 0.0</font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations.
<p> 
<b>freqremax</b> is used only for numerical integration of the GW self-energy
(<a href="vargw.html#gwcalctyp">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).
<br>
<b>freqremax</b> sets the maximum real frequency used to calculate the dielectric matrix in order 
to perform the numerical integration of the GW self-energy.
<b>freqremax</b> and <a href="vargw.html#nfreqre">nfreqre</a> define the spacing of the frequency 
mesh along the real axis.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="freqspmax">freqspmax</a></font>
<br><font id="definition">Mnemonics:
FREQuencies for the SPectral function MAXimum</font>
<br><font id="category">Characteristic: GW, ENERGY</font>
<br><font id="vartype">Variable type: real parameter  </font>
<br><font id="default">Default is 0.0</font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p>
<b>freqspmax</b> sets the maximum real frequency used to calculate the spectral function 
from the GW Green's function. <b>freqspmax</b> and <a href="vargw.html#nfreqsp">nfreqsp</a> 
define the spacing of the frequency mesh along the real axis.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="gwcalctyp">gwcalctyp</a></font> 
<br><font id="definition">Mnemonics: GW CALCulation TYPe</font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations.
<p>
<b>gwcalctyp</b> governs the choice between the different capabilities of the GW code.

<ul> 
<li>  0 &#60&#61 <b>gwcalctyp</b> &#60&#61  9 : standard "1 shot" quasiparticle method
<li> 10 &#60&#61 <b>gwcalctyp</b> &#60&#61 19 : self-consistent quasiparticle method on energies only
<li> 20 &#60&#61 <b>gwcalctyp</b> &#60&#61 29 : self-consistent quasiparticle method on energies and wavefunctions
</ul>

<p>
<ul>
<li> <b>gwcalctyp</b> &#61 0, 10, or 20 : standard Plasmon-Pole model GW calculation
<li> <b>gwcalctyp</b> &#61 2, 12, or 22 : GW calculation using numerical integration 
 (contour deformation method, see e.g. S. Lebegue <i> et al.</i> PRB <b>67</b>, 155208 (2003).)
<li> <b>gwcalctyp</b> &#61 5, 15, or 25 : Hartree-Fock calculation
<li> <b>gwcalctyp</b> &#61 6, 16, or 26 : Screened Exchange calculation
<li> <b>gwcalctyp</b> &#61 7, 17, or 27 : COHSEX calculation
<li> <b>gwcalctyp</b> &#61 8, 18, or 28 : model GW calculation
 following S. Faleev <i>et al.</i> PRL <b>93</b>, 126406 (2004) using a Plasmon-Pole model
<li> <b>gwcalctyp</b> &#61 9, 19, or 29 : model GW calculation
 following S. Faleev <i>et al.</i> PRL <b>93</b>, 126406 (2004) using numerical integration
(contour deformation method)
</ul>
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<font id="title"><a name="gwcomp">gwcomp</a></font>
<br><font id="definition">Mnemonics: GW COMPletness </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer </font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">

<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations.
<p>
<b>gwcomp</b> governs the use of an extrapolar approximation. If <b>gwcomp</b>==1, one improves the completeness
in a truncated sum over states. In practice, this permits one to reduce quite much the number of 
bands required in the calculation of the screening or of the self-energy.
The energy parameter 
needed in the extrapolar approximation is set by <a href="vargw.html#gwencomp">gwencomp</a>. 
See F. Bruneval, X. Gonze, Phys. Rev. B 78, 085125 (2008) for a description of the methodology.
<p>
Note that <b>gwcomp</b>==1 is not allowed with PAW calculations.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<font id="title"><a name="gwencomp">gwencomp</a></font>
<br><font id="definition">Mnemonics: GW Energy for COMPletness </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: energy </font>
<br><font id="default">Default is 2. </font>
<br><br><font id="text">

<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations,
when <a href="vargw.html#gwcomp">gwcomp</a> is equal to 1.
<p>
<b>gwencomp</b> sets the energy parameter used in the extrapolar approximation used to improve
completeness and make the convergence against the number of bands much faster.
<p>
See F. Bruneval, X. Gonze, Phys. Rev. B 78, 085125 (2008) for a description of the methodology.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<font id="title"><a name="gwgamma">gwgamma</a></font>
<br><font id="definition">Mnemonics: GW Gamma </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer </font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">

<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p>
in case <b>gwgamma</b> is 1, the vertex correction
will be included leading to what is known as "GWGamma" approximation.
see R. Del Sole, L. Reining, and R. W. Godby,
Phys. Rev. B  49, 8024 (1994).
<p>
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="gwmem">gwmem</a></font>
<br><font id="definition">Mnemonics: GW MEMory </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer </font>
<br><font id="default">Default is 11 </font>
<br><br><font id="text">

<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p>
<b>gwmem</b> governs the memory strategy during a screening and/or a sigma run.
<ul>
<li> <b>gwmem</b> = 1x , the screening matrix are read for all q-vectors and stored in the memory.
<li> <b>gwmem</b> = 0x , the screening matrix are read just a q-vector after another.
<br>
<li> <b>gwmem</b> = x1 , the real-space wavefunctions are stored in the memory.
<li> <b>gwmem</b> = x0 , the real-space wavefunctions are not stored, but rather recalculated on-fly each abinit needs them using FFTs.
</ul>
The default is <b>gwmem</b> = 11, which is the fastest, but also the most memory consuming.
When experiencing memory shortage, one should try <b>gwmem</b> = 0.
The first digit is only meaningful when performing a sigma calculation.
<p>
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="inclvkb">inclvkb</a></font>
<br><font id="definition">Mnemonics: INCLude VKB </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter </font>
<br><font id="default">Default is 1 <b>TODO: should be changed to 0 or 2</b></font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, a screening calculations.
<p>
Possible values of <b>inclvkb</b> are 0,1,2. 
If <b>inclvkb</b> is 1 or 2, the commutator of the non-local part of the Hamiltonian
with the position operator is correctly included in the q =&gt; 0 contribution. This is
unfortunately time-consuming. In case <b>inclvkb</b> is 0, this contribution is incorrectly
omitted, but the computation is much faster.
<p>
The importance of this contribution depends on the number of k points. Turning off
<b>inclvkb</b> should be made by experienced users only.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="kptgw">kptgw</a></font>
<br><font id="definition">Mnemonics: K-PoinTs for GW calculations </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: real array kptgw(3,<a href="vargw.html#nkptgw">nkptgw</a>)</font>
<br><font id="default">Default is all 0.0's </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p>
For each k-point with number igwpt in the range (1:<a href="vargw.html#nkptgw">nkptgw</a>),
<b>kptgw(1,igwpt)</b> is the reduced coordinate of the k-point where GW corrections are required.
while <a href=vargw.html#bdgw">bdgw</a>(1:2,igwpt) specifies the range of bands to be considered.
<p>
At present, not all k-points are possible. Only those corresponding to the k-point
grid defined with the same repetition parameters (<a href="varbas.html#kptrlatt" target="kwimg">kptrlatt</a>,
or <a href="varbas.html#ngkpt" target="kwimg">ngkpt</a>) than the GS one, but WITHOUT any shift, are allowed.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nbandkss">nbandkss</a></font>
<br><font id="definition">Mnemonics:
Number of BaNDs in the KSS file </font>
<br><font id="category">Characteristic:  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0</font>
<br><br><font id="text">
<p>
This input variable (also called "nbndsto" prior to v4.3) is used for the preparation of a GW calculation :
it is used in a GS run (where <a href="vargs.html#optdriver">optdriver</a>=0) to generate a _KSS file. 
In this run, <b>nbandkss</b> should be non-zero.
The generated _KSS file can be subsequently used to calculate the irreducible polarizabilty 
$\chi^{(0)}_{KS}$ using <a href="vargs.html#optdriver">optdriver</a>=3
or to calculate GW corrections setting <a href="vargs.html#optdriver">optdriver</a>=4.
<p>

<ul>
 <li>If <b>nbandkss</b>=0, no _KSS file is created</li>
 <li>If <b>nbandkss</b>=-1, all the available eigenstates (energies and eigenfunctions) are stored in the 
  abo_KSS file at the end of the ground state calculation. The number of states is forced to be
  the same for all k-points : it will be the minimum of the number of plane waves over all k-points.</li>
 <li>If <b>nbandkss</b> is greater than 0, abinit stores (about) <b>nbandkss</b> eigenstates in the abo_KSS file. 
  This number of states is forced to be the same for all k-points.</li>
</ul>

<p>
See <a href="vargw.html#npwkss">npwkss</a> for the selection of the number of the planewave components of 
the eigenstates to be stored. 
<br> 
The input variable <a href="vardev.html#accesswff">accesswff</a> can be used
to read and write KSS files according to different fileformat 
(presently only <a href="vardev.html#accesswff">accesswff</a>=0 and 3 are available in the GW part). 
<br> 
The precision of the KSS file can be tuned through the input variable <a href="varfil.html#kssform">kssform</a>.
<br>
For more details about the format of the abo_KSS file, see the routine outkss.F90.
<p>
Very important : for the time being, <a href="vardev.html#istwfk">istwfk</a> must be 1 for all the k-points 
in order to generate a _KSS file.
<!-- When <b>nbandkss</b> is non-zero, <a href="vargw.html#symmorphi">symmorphi</a> must be set to 0,
in case there are non-symmorphic operations. -->
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nfreqim">nfreqim</a></font>
<br><font id="definition">Mnemonics:
Number of FREQuencies along the IMaginary axis </font>
<br><font id="category">Characteristic:  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0</font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations. 
<p>
<b>nfreqim</b> is used only for numerical integration of the GW self-energy
(<a href="vargw.html#gwcalctyp">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).
<br>
<b>nfreqim</b> sets the number of pure imaginary frequencies used to calculate
the dielectric matrix in order to perform the numerical integration of the GW self-energy.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nfreqmidm">nfreqmidm</a></font>
<br><font id="definition">Mnemonics:
    Nth FREQuencey moment of the IMaginary part of DM </font>
<br><font id="category">Characteristic:  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default"> No default </font>
<br><br><font id="text">
at the moment only relevant if <a href="vargs.html#optdriver">optdriver</a>=4,
that is, a screening calculation.
<p>
depending on the value of <b>>nfreqmidm</b> will calculate the frequency moment of the Dielectric matrix or its inverse,

if <b>>nfreqmidm</b> positive : calculate (nth=nfreqmidm) frequency moment of the Dielectric matrix
if <b>>nfreqmidm</b> negative : calculate (nth=nfreqmidm) frequency moment of the inverse Dielectric matrix
if <b>>nfreqmidm</b> = 0 : calculate first frequency moment of the full polarizability

see M. Taut, J. Phys. C: Solid State Phys. 18 (1985) 2677-2690. 

</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nfreqre">nfreqre</a></font>
<br><font id="definition">Mnemonics:
Number of FREQuencies along the Real axis </font>
<br><font id="category">Characteristic:  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0</font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations.
<p>
<b>nfreqre</b> is used only for numerical integration of the GW self-energy
(<a href="vargw.html#gwcalctyp">gwcalctyp</a>= 2, 12, 22, 9, 19, 29).
<br>
<b>nfreqre</b> sets the number of real frequencies used to calculate
the dielectric matrix in order to perform the numerical integration of the GW self-energy.
<p>
It can be used also in case of GW calculations with plasmon-pole models, 
<i>i.e</i> <a href="vargw.html#gwcalctyp">gwcalctyp</a>&lt;10,
to reduce the number of frequencies used to evaluate the dielectric matrix from the (default) two to 
one frequency (omega=0) by setting <b>nfreqre</b>=1. 
This might be a good idea in case one is planning to use ppmodel&gt;1. 
This will force the calculation of the screening on a single frequency (omega=0) and hence 
reduce memory and disk space requirement. 
The only draw back is that the user will not be able to perform self energy calculation using 
<a href="vargw.html#ppmodel">ppmodel</a>=1, 
since in the last case the dielectric matrix calculated on two frequencies is required. 
If the user is not sure which ppmodel to use, then s/he is not advised  
to use this input variable. 
Using the default values, one must be able to get a screening file that can be used with any ppmodel.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nfreqsp">nfreqsp</a></font>
<br><font id="definition">Mnemonics:
Number of FREQuencies for the SPectral function </font>
<br><font id="category">Characteristic:  </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0</font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p> 
<b>nfreqsp</b> defines the number of real frequencies used to calculate the spectral function 
of the GW Green's function.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="npwkss">npwkss</a></font>
<br><font id="definition">Mnemonics:
Number of PlaneWaves in the KSS file </font>
<br><font id="category">Characteristic: </font>
<br><font id="vartype">Variable type: integer parameter  </font>
<br><font id="default">Default is 0</font>
<br><br><font id="text">

<p>
This input variable (was called "ncomsto" prior to v4.3) is used for the preparation of a GW calculation:
the GS run (where <a href="vargs.html#optdriver">optdriver</a>=1 and <b>nbandkss</b>/=0) should be followed 
with a run where <a href="vargs.html#optdriver">optdriver</a>=3.
Also, if <a href="vargw.html#nbandkss">nbandkss</a>=0, no use of <b>npwkss</b>.
<p>
<b>npwkss</b> defines the number of planewave components of the Kohn-Sham states
to build the Hamiltonian, in the routine outkss.F90, and so, the size of the matrix, the size of eigenvectors,
and the number of available states, to be stored in the abo_KSS file.
If it is set to 0, then, the planewave basis set defined by the usual Ground State input variable 
<a href="varbas.html#ecut">ecut</a> is used to generate the superset of all planewaves used for all k-points. 
Note that this (large) planewave basis is the same for all k-points. 
<p>
Very important : for the time being, <a href="vardev.html#istwfk">istwfk</a> must be 1 for all the k-points.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nkptgw">nkptgw</a></font>
<br><font id="definition">Mnemonics: Number of K-Points for GW corrections </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations. 
This input variable was called "ngwpt" in versions before v4.3.
<p>
<b>nkptgw</b> gives the number of k-points for which the GW calculation must be done.
It is used to dimension <a href="vargw.html#kptgw">kptgw</a>
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<font id="title"><a name="nomegasf">nomegasf</a></font>
<br><font id="definition">Mnemonics: Number of OMEGA to evaluate the Spectral Function </font>
<br><font id="category">Characteristic: GW, ENERGY  </font>
<br><font id="vartype">Variable type: integer parameter </font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 and 
<a href="vargw.html#spmeth">spmeth</a>/=0, that is, screening calculations
based on the spectral reprentation. 
<p>
<b>nomegasf</b> defines the number of real frequencies used to describe the spectral function 
<i>i.e</i> the imaginary part of the irreducible polarizability $\chi^{(0)}_{KS}$. 
The frequency mesh will cover the interval between 0 and the maximum (positive) transition 
energy between occupied and empty states. 
The delta function entering the expression defining the spectral function is approximated using two 
different methods according to the value of the <a href="vargw.html#spmeth">spmeth</a> input variable.
<p> It is important to notice that an accurate description of the imaginary part of $\chi^{(0)}_{KS}$ 
requires an extremely dense frequency mesh. It should be kept in mind, however, that the memory required 
grows fast with the value of <b>nomegasf</b>.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nomegasrd">nomegasrd</a></font>
<br><font id="definition">Mnemonics: Number of OMEGA to evaluate the Sigma Real axis Derivative </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter </font>
<br><font id="default">Default is 9 </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations. 
<p>
The number of real frequencies around the KS energy where the self-energy Sigma is evaluated. 
From these values, the derivative of Sigma at the KS energy is numerically estimated through linear interpolation.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="npweps">npweps</a></font>
<br><font id="definition">Mnemonics: Number of PlaneWaves for EPSilon (the dielectric matrix) </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations.
<p>
<b>npweps</b> determines the size of the planewave set used to represent the independent-particle 
susceptibility $\chi^{(0)}_{KS}$, the dielectric matrix $\epsilon$ and its inverse.
<br>See <a href="vargw.html#ecuteps">ecuteps</a> (preferred over <b>npweps</b>) for more information.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="npwsigx">npwsigx</a></font>
<br><font id="definition">Mnemonics: Number of PlaneWaves for SIGma eXchange </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations. 
This input variable was previously called "npwmat".
<p>
<b>npwsigx</b> determines the cut-off energy of the planewave set used to generate the
exchange part of the self-energy operator.
<br>See <a href="vargw.html#ecutsigx">ecutsigx</a> (preferred over <b>npwsigx</b>) for more information.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="npwwfn">npwwfn</a></font>
<br><font id="definition">Mnemonics: Number of PlaneWaves for WaveFunctioNs </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screeening or sigma calculations.
<p>
<b>npwwfn</b> determines the size of the planewave set used to represent the wavefunctions
in the formula that generates the independent-particle susceptibility $\chi^{(0)}_{KS}$.
<br>
See <a href="vargw.html#ecutwfn">ecutwfn</a> (preferred over <b>nshwfn</b>) for more information.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nqptdm">nqptdm</a></font>
<br><font id="definition">Mnemonics: Number of Q-PoinTs for the Dielectric Matrix</font>
<br><font id="category">Characteristic:  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0</font>
<br><br><font id="text">

<p>
Used only in the screening part of ABINIT, that is for <a href="vargs.html#optdriver">optdriver</a>=3.
<p>
If <b>nqptdm</b> is equal to 0, the set of q-points for computing the dielectric matrix is
determined automatically considering all the possible differences between the k-points contained
in the _KSS file. When <b>nqptdm</b> is non-zero, the list of q points is read from <a href="vargw.html#qptdm">qptdm</a>.
This allows to split the big calculation of all the dielectric matrices into smaller
calculations that can be performed independently. The _SCR files generated in different runs
can be merged thanks to the <A href="../users/mrgscr_help.html"><B>Mrgscr</B></a> utility.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nsheps">nsheps</a></font>
<br><font id="definition">Mnemonics: Number of SHells for EPSilon (the dielectric matrix) </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations.
<p>
<b>nsheps</b> determines the size of the planewave set used to represent the independent-particle 
susceptibility $\chi^{(0)}_{KS}$, the dielectric matrix $\epsilon$ and its inverse.
<br>
See <a href="vargw.html#ecuteps">ecuteps</a> (preferred over <b>nsheps</b>) for more information.
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nshsigx">nshsigx</a></font>
<br><font id="definition">Mnemonics: Number of SHells for SIGma eXchange </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations. 
This input variable was named "nshma" prior to v4.3 .
<p>
<b>nshsigx</b> determines the cut-off energy of the planewave set used to generate the
exchange part of the self-energy operator.
<br>
See <a href="vargw.html#ecutsigx">ecutsigx</a> (preferred over <b>nshsigx</b>) for more information.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="nshwfn">nshwfn</a></font>
<br><font id="definition">Mnemonics: Number of SHells for WaveFunctioNs </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations.
<p>
<b>nshwfn</b> determines the number of shells of the planewave set used to represent the wavefunctions
in the formula that generates the independent-particle susceptibility $\chi^{(0)}_{KS}$.
<br>
See <a href="vargw.html#ecutwfn">ecutwfn</a> (preferred over <b>nshwfn</b>) for more information.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="omegasrdmax">omegasrdmax</a></font>
<br><font id="definition">Mnemonics: OMEGA to evaluate the Sigma Real axis Derivative : MAXimal value </font>
<br><font id="category">Characteristic: GW  ENERGY</font>
<br><font id="vartype">Variable type: real </font> 
<br><font id="default">Default is 1.0 eV </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p>
The maximum distance from the KS energy where to evaluate Sigma. Sigma is evaluated at 
[KS_energy - maxomegasrd, KS_energy + maxomegasrd] sampled <a href="vargw.html#nomegasrd">nomegasrd</a> times.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="ppmfrq">ppmfrq</a></font>
<br><font id="definition">Mnemonics: Plasmon Pole Model FReQuency </font>
<font id="title"><a name="plasfrq">plasfrq (old name)</a></font>
<br><font id="category">Characteristic: GW, ENERGY </font>
<br><font id="vartype">Variable type: real parameter</font>
<br><font id="default">Default is 0.0 Ha </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations.
Only effective if GW corrections are evaluated using the plasmon-pole model of Godby-Needs 
(<i>i.e</i> <a href="vargw.html#ppmodel">ppmodel</a>=1)
<p>
In the present status of the GW code, the convolution in frequency space 
defining the self-energy operator can be evaluated using two different approaches: 
numerical integration and plasmon-pole models. 
<br>
Methods based on the numerical integration (contour deformation, analytic continuation) require 
the knowledge of the screened interaction for several frequencies. These approaches give
the most accurate results but at the price of an increase in the CPU time required.
<br> 
Alternately it is possible to approximate the dynamical behaviour of the screened interaction 
through simple analytical expressions, the so-called plasmon-pole models.
In the plasmon-pole model proposes by Godby-Needs (<a href="vargw.html#ppmodel">ppmodel</a>=1), 
the screening must be available at zero frequency, as well as at another frequency, imaginary,
of the order of the plasmon frequency (the peak in the EELS spectrum). 
This information is used to derive the behaviour of the dielectric matrix 
for all the frequencies (complex).
<b>ppmfrq</b> defines the imaginary frequency where the dielectric matrix is evaluated, 
in addition to the zero frequency. If the plasmon-pole approximation is good, then, the
choice of <b>ppmfrq</b> should have no influence on the final result. 
One should check whether this is the case. In general, the plasmon frequencies of bulk solids 
are on the order of 0.5 Hartree.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="ppmodel">ppmodel</a></font>
<br><font id="definition">Mnemonics: Plasmon Pole MODEL </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer parameter </font>
<br><font id="default">Default is 1 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening calculations and self-energy calculations.

<ul>
<li> <b>ppmodel</b>=1 : PP model of Godby and Needs, 
                        See <B> FIXME>REFERENCE MISSING!</B></li>
<li> <b>ppmodel</b>=2 : PP model of Hybertsen and Louie, 
                        See Phys Rev B 34, 5390 (1986) </li>
<li> <b>ppmodel</b>=3 : PP model of  W. von der Linden
                        and P. Horsh see Phys Rev B 37, 8351 (1988) </li>
<li> <b>ppmodel</b>=4 : PP model of Farid and Engel.
                        See Phys Rev B47,15931 (1993)
<li> <b>ppmodel</b>=0 : no PP model, numerical integration 
                       (contour deformation method, see e.g. S. Lebegue  et al. PRB  67, 155208 (2003).)  </li>
</ul>

Please note the difference between <b>ppmodel</b> 1 and <b>ppmodel</b> 2,3,4. 
In the first case (<b>ppmodel</b>=1), the plasmon-pole parameters are determined in order to reproduce 
the behaviour of the dielectric matrix at two calculated frequencies: the static limit (omega=0)
and the imaginary frequency defined by <a href="vargw.html#ppmfrq">ppmfrq</a>. 
In the last three cases, instead, the plasmon-pole parameters are found 
by using the dielectric matrix calculated only at omega=0 and enforcing the so-called f-sum rule.
See also <a href="vargw.html#nfreqre">nfreqre</a>. 
<p>
Please note also that in the case of <b>ppmodel</b> 4, the plasmon energies are not simple mathematical parameters, 
but rather have a physical meaning (at least the lowest ones). 
Thus the calculated plasmon band structure (plasmon energy vs q vector) is reported in the output file for the 
lowest 10 bands.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="qptdm">qptdm</a></font>
<br><font id="definition">Mnemonics: Q-PoinTs for the Dielectric Matrix</font>
<br><font id="category">Characteristic: GW </font>
<br><font id="vartype">Variable type: real array qptdm(3,<a href="vargw.html#nqptdm">nqptdm</a>)  </font>
<br><font id="default">Default is 0. 0. 0. (for just one q-point)</font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations,
and only if <a href="vargw.html#nqptdm">nqptdm</a>/=0.
<p>
<b>qptdm</b> contains the set of q-points used in the screening part of ABINIT,
instead of the automatic generation of the q points when <a href="vargw.html#nqptdm">nqptdm</a>=0. 
These q points are given in terms of reciprocal space primitive translations (NOT in cartesian coordinates!). 
For further explanation, see the input variable <a href="vargw.html#nqptdm">nqptdm</a>.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="rhoqpmix">rhoqpmix</a></font>
<br><font id="definition">Mnemonics:
RHO QuasiParticle MIXing</font>
<br><font id="category">Characteristic: GW </font>
<br><font id="vartype">Variable type: real parameter  </font>
<br><font id="default">Default is 1.0</font>
<br><br><font id="text">

<p>
For self-consistent GW runs, <b>rhoqpmix</b> sets the mixing coefficient between the new and the previous
electronic densities.
This mixing damps the spurious oscillations in the Hartree potential when achieving self-consistency.
<b>rhoqpmix</b> is meaningful only when doing self-consistency on the wavefunctions with
<a href="vargw.html#gwcalctyp">gwcalctyp</a> &#62&#61 20.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="soenergy">soenergy</a></font>
<br><font id="definition">Mnemonics: Scissor Operator ENERGY </font>
<br><font id="category">Characteristic: GW, ENERGY </font>
<br><font id="vartype">Variable type: real </font>
<br><font id="default">Default is 0.0 </font>
<br><br><font id="text">
<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations.
<p>
The Scissor operator energy to be added to unoccupied levels for the screening calculation. 
In some cases, it mimics a second iteration self-consistent GW calculation.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>

<font id="title"><a name="spbroad">spbroad</a></font>
<br><font id="definition">Mnemonics: SPectral BROADening </font>
<br><font id="category">Characteristic: GW, ENERGY </font>
<br><font id="vartype">Variable type: real parameter </font>
<br><font id="default">Default is 0.0 </font>
<br><br><font id="text">

TO BE DESCRIBED
</font>

<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="splitsigc">splitsigc</a></font>
<br><font id="definition">Mnemonics: SPLIT SIGma Correlation </font>
<br><font id="category">Characteristic: GW, DEVELOP </font>
<br><font id="vartype">Variable type: integer </font>
<br><font id="default">Default is 0 </font>
<br><br><font id="text">

<p>
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, GW calculations of self-energy
<p>
Govern the splitting of the correlation part of the self-energy in various contributions. 
So far, the results only appear in the log file.
<br>
<b>splitsigc</b> is intended as a succession of bits that govern the decomposition (or not) as a function of 
different criteria.

<ul>
<li> The first bit governs the decomposition in terms of
     Coulomb Hole (COH) and Screened Exchange (SEX) contributions </li>
<li> The second bit governs the decomposition in terms of Coulomb and Kinetic contributions </li>
</ul>
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>
<font id="title"><a name="spmeth">spmeth</a></font>
<br><font id="definition">Mnemonics: SPectral METHod </font>
<br><font id="category">Characteristic: GW  </font>
<br><font id="vartype">Variable type: integer </font>
<br><font id="default">Default is 0  </b></font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=4, that is, sigma calculations.
<p>
The <b>spmeth</b> input variable defines the method used to calculate the irreducible 
polarizability $\chi^{(0)}_{KS}$.
<p>
By default $\chi^{(0)}_{KS}$ is calculated employing the Adler-Wiser expression (<b>spmeth</b>=0) 
with a CPU effort that scales linearly with the number of frequencies.
This approach is convenient when few frequencies are required, and is usually 
used in conjunction with plasmon-pole models in which only one or two frequencies are calculated, 
according to the value of <a href=vargw.html#ppmodel">ppmodel</a>.
<br>
Unfortunately a calculation based on the Adler-Wiser expression might be quite CPU demanding 
if the matrix elements of the self-energy operator are evaluated by performing numerically 
the convolution defining the sigma operator
The integrand function, indeed, has poles above and below the real axis, and
the screened interaction has to be evaluated on a dense frequency mesh in order to obtain accurate
results.
<p>
In the spectral method (<b>spmeth</b>=1 or 2) the irreducible polarizability is expressed as 
the Hilbert transform of the imaginary part.
The advantage in using this approach consists in the fact that, once the spectral function is known, 
the irreducible polarizability for an arbitrary frequency can be easily obtained through inexpensive 
integrations. On the other hand an accurate evaluation of the imaginary part requires a dense 
frequency mesh due to the presence of delta functions. 
Two different approaches can be used to approximate these delta functions thus allowing the use 
of affordable frequency grid.
<p>
Summarizing:

<ul>
 <li> 0 =&gt; use Adler-Wiser expression to calculate $\chi^{(0)}_{KS}$  </li>
 <li> 1 =&gt; use the spectral method approximating the delta function with a triangular approximant 
       as proposed in <B>REF TO BE ADDED</B> </li>
 <li> 2 =&gt; use spectral method but approximating the delta function with a Taylor expansion of the exponential  
              as proposed in <B>REF TO BE ADDED</B> </li>
</ul>
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="symchi">symchi</a></font>
<br><font id="definition">Mnemonics: SYMmetryze \chi_o </font>
<br><font id="category">Characteristic: GW, DEVELOP </font>
<br><font id="vartype">Variable type: integer </font>
<br><font id="default">Default is 0 <b>FIXME TO BE CHANGED and moved to VARDEV </b></font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3, that is, screening calculations.
<p> 
The evaluation of the irreducible polarizability for a given q-point requires an
integration over the Brillouin zone (BZ) which is approximated by a discrete sum over k-points. 
In principle the integrand function should be evaluated for each k-point in the BZ, however it is possible 
to reduce the number of points to be explicitly considered by taking advantage of symmetry properties.
The development input variable <b>symchi</b> is used to choose between these two equivalent methods:

<ul>
<li> 0=&gt; the summation over k-points is performed considering ALL the points in the BZ (useful for testing and debugging). 
<li> 1=&gt; the summation is restricted to the k-points belonging to the irreducible wedge 
defined by the little group associated to the external vector q. 
</ul>

<!--
<p> 
Additional note: 
<br> 
The little group is a sub-group of the point group of the system under study. 
As a consequence the reduction of k-points in the sum that can be achieved depends on the external 
q-point considered. In case od q=\Gamma, for example, the redution is maximum since the little group 
coincides with the point group itself. For non hygh symmetry q-points the symmetrization might be not 
so efficient. Note that in the present state of the code umklapp processes are not included in the definition 
of tcomparing in the Adler-Wiser expression for \chi_o(q) he little group
-->
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="symmorphi">symmorphi</a></font>
<br><font id="definition">Mnemonics: SYMMORPHIc symmetry operations </font>
<br><font id="category">Characteristic: GW, DEVELOP </font>
<br><font id="vartype">Variable type: integer parameter</font>
<br><font id="default">Default is 1 
</font>
<br><br><font id="text">

<B>TODO: TO BE MOVED TO VARDEV</B>
With <b>symmorphi</b>=1, symmetry operations with a non-symmorphic vector are allowed.
With <b>symmorphi</b>=0, they are not allowed. 
In the latter case, if the symmetry operations are specified in the input file, the code
will stop and print an error message if a non-symmorphic vector is encountered.
By contrast, if the symmetry operations are to be determined automatically
(if <a href="varbas.html#nsym">nsym</a>=0), then the set of symmetries will
not include the non-symmorphic operations.
<p>
Note : this feature exist because in the present status of the GW calculations, non-symmorphic 
symmetry operations cannot be exploited. Thus, the k points cannot be restricted
to the IBZ. In order to prepare GW calculations, and to perform GW calculations,
<b>symmorphi</b>=0 should be used, together with <a href="varbas.html#nsym">nsym</a>=0.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="symsigma">symsigma</a></font>
<br><font id="definition">Mnemonics: SYMmetrization of SIGMA matrix elements </font>
<br><font id="category">Characteristic: GW </font>
<br><font id="vartype">Variable type: integer </font>
<br><font id="default">Default is 0 (TO BE CHANGED according to gwcalctype </font>
<br><br><font id="text">
<B>TO BE DESCRIBED</B>

</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


<font id="title"><a name="zcut">zcut</a></font>
<br><font id="definition">Mnemonics: Z-CUT </font>
<br><font id="category">Characteristic: GW, ENERGY </font>
<br><font id="vartype">Variable type: real parameter </font>
<br><font id="default">Default is 0.1 eV = 3.67493260d-03Ha </font>
<br><br><font id="text">
<p> 
Only relevant if <a href="vargs.html#optdriver">optdriver</a>=3 or 4, that is, screening or sigma calculations.
<p> 
It is meant to avoid some divergencies that might occur during the evaluation of the Adler-Wiser expression of 
the irreducible polarizability (<a href="vargw.html#opdriver">optdriver</a>=3) or during the numerical treatment 
of the integrals defining the contribution to the self-energy matrix elements 
(<a href="vargw.html#opdriver">optdriver</a>=4).
If the denominator becomes smaller than <b>zcut</b>, a small imaginary part (depending on <b>zcut</b>) is added, 
in order to avoid the divergence.
<br>
Ideally, one should make a convergence study decreasing the value of <b>zcut</b> for increasing number of k-points.
</font>


<br><br><br><br><a href=#top>Go to the top</a>
<B> | </B><a href="keyhr.html#list">Complete list of input variables</a><hr>


Goto :
<A href="http://www.abinit.org"><B>ABINIT home Page</B></A>
<B> | </B>
<A href="../users/acknowledgments.html"><B>Suggested acknowledgments</B></A>
<B> | </B>
<A href="keyhr.html"><B>List of input variables</B></A>
<B> | </B>
<A href="../tutorial/welcome.html"><B>Tutorial home page</B></A>
<B> | </B>
<A href="../users/bibliography.html"><B>Bibliography</B></A>
<HR ALIGN=left>
Help files :
<A href="../users/new_user_guide.html"><B>New user's guide</B></A>
<B> | </B>
<A href="../users/abinis_help.html"><B>Abinis (main)</B></A>
<B> | </B>
<A href="../users/respfn_help.html"><B>Abinis (respfn)</B></A>
<B> | </B>
<A href="../users/mrgddb_help.html"><B>Mrgddb</B></A>
<B> | </B>
<A href="../users/anaddb_help.html"><B>Anaddb</B></A>
<B> | </B>
<A href="../users/aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="../users/cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="../users/optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="../users/mrgscr_help.html"><B>Mrgscr</B></A>
<HR ALIGN=left>

</body>
</html>



