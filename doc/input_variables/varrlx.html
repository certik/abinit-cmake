<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>ABINIT : STRUCTURAL OPTIMIZATION input variables.</title>
  <link rel="stylesheet" type="text/css" href="formabinit.css">
</head>
<body bgcolor="#ffffff">
<hr>
<a name="top"></a>
<h1>ABINIT, structural optimization input variables:</h1>
<h2>List and description.</h2>
<hr>
<br>
This document lists and provides the description
of the name (keywords) of structural optimization input
variables to be used in the main input file of the abinis code.
<br>
The new user is advised to read first the <a
 href="../users/new_user_guide.html">new user's guide</a>, before
reading the present file. It will be easier to discover the present
file with the help of the <a href="../tutorial/welcome.html">tutorial</a>.
<br>
When the user is sufficiently familiarized with ABINIT, the reading of
the ~abinit/doc/users/tuning file might be useful. For
response-function calculations using abinis, please read <a
 href="../users/respfn_help.html">the response function help file</a>
<h5><a href="../users/respfn_help.html"></a>Copyright (C) 1998-2007
ABINIT group (DCA, XG, RC)
<br>
This file is distributed under the terms of the GNU General Public
License, see&nbsp;
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>. For the initials of
contributors, see ~abinit/doc/developers/contributors.txt .<br>
</h5>
<hr align="left">
Goto :
<a href="http://www.abinit.org"><b>ABINIT home Page</b></a>
<b> | </b>
<a href="../users/acknowledgments.html"><b>Suggested acknowledgments</b></a>
<b> | </b>
<a href="keyhr.html"><b>List of input variables</b></a>
<b> | </b>
<a href="../tutorial/welcome.html"><b>Tutorial home page</b></a>
<b> | </b>
<a href="../users/bibliography.html"><b>Bibliography</b></a>
<hr align="left">Help files :
<a href="../users/new_user_guide.html"><b>New user's guide</b></a>
<b> | </b>
<a href="../users/abinis_help.html"><b>Abinis (main)</b></a>
<b> | </b>
<a href="../users/respfn_help.html"><b>Abinis (respfn)</b></a>
<b> | </b>
<a href="../users/mrgddb_help.html"><b>Mrgddb</b></a>
<b> | </b>
<a href="../users/anaddb_help.html"><b>Anaddb</b></a>
<b> | </b>
<a href="../users/aim_help.html"><b>AIM (Bader)</b></a>
<b> | </b>
<a href="../users/cut3d_help.html"><b>Cut3D</b></a>
<b> | </b>
<a href="../users/optic_help.html"><b>Optic</b></a>
<b> | </b>
<a href="../users/mrgscr_help.html"><b>Mrgscr</b></a>
<hr align="left">Files that describe other input variables:<br>
<ul>
  <li> Basic variables, <a href="varbas.html">VARBAS</a></li>
  <li> Developper variables, <a href="vardev.html">VARDEV</a></li>
  <li> File handling variables, <a href="varfil.html">VARFIL</a></li>
  <li> Geometry builder + symmetry related variables, <a
 href="vargeo.html">VARGEO</a></li>
  <li> Ground-state calculation variables, <a href="vargs.html">VARGS</a></li>
  <li> GW variables, <a href="vargw.html">VARGW</a></li>
  <li> Internal variables, <a href="varint.html">VARINT</a></li>
  <li> Parallelisation variables, <a href="varpar.html">VARPAR</a></li>
  <li> Projector-Augmented Wave variables, <a href="varpaw.html">VARPAW</a></li>
  <li> Response Function variables, <a href="varrf.html">VARRF</a></li>
  <li> Wannier90 interface variables, <A href="varw90.html">VARW90</a></li>
</ul>
<hr>
<h3><b> Content of the file : alphabetical list of variables.</b></h3>
<br>
A. <a href="varrlx.html#amu">amu</a>&nbsp;&nbsp; <br>
B. 
<a href="varrlx.html#bmass">bmass</a>&nbsp;&nbsp;
<br>
C. <br>
D. <a href="varrlx.html#delayperm">delayperm</a>&nbsp;&nbsp; <a
 href="varrlx.html#dilatmx">dilatmx</a>&nbsp;&nbsp; <a
 href="varrlx.html#dtion">dtion</a>&nbsp;&nbsp; <br>
E. <a href="varrlx.html#ecutsm">ecutsm</a>&nbsp;&nbsp; <br>
F. <a href="varrlx.html#friction">friction</a>&nbsp;&nbsp; <br>
G. <a href="varrlx.html#getcell">getcell</a>&nbsp;&nbsp; <a
 href="varrlx.html#getxcart">getxcart</a>&nbsp;&nbsp; <a
 href="varrlx.html#getxred">getxred</a>&nbsp;&nbsp; <br>
H. <br>
I. <a href="varrlx.html#iatcon">iatcon</a>&nbsp;&nbsp; <a
 href="varrlx.html#iatfix">iatfix</a>&nbsp;&nbsp; <a
 href="varrlx.html#iatfixx">iatfixx</a>&nbsp;&nbsp; <a
 href="varrlx.html#iatfixy">iatfixy</a>&nbsp;&nbsp; <a
 href="varrlx.html#iatfixz">iatfixz</a>&nbsp;&nbsp; <a
 href="varrlx.html#ionmov">ionmov</a>&nbsp;&nbsp; <br>
J. <br>
K. <br>
L. <br>
M. <a href="varrlx.html#mdftemp">mdftemp</a>&nbsp;&nbsp; <a
 href="varrlx.html#mditemp">mditemp</a>&nbsp;&nbsp; <a
 href="varrlx.html#mdwall">mdwall</a>&nbsp;&nbsp; <br>
N. <a href="varrlx.html#natfix">natfix</a>&nbsp;&nbsp; <a
 href="varrlx.html#natfixx">natfixx</a>&nbsp;&nbsp; <a
 href="varrlx.html#natfixy">natfixy</a>&nbsp;&nbsp; <a
 href="varrlx.html#natfixz">natfixz</a>&nbsp;&nbsp; <a
 href="varrlx.html#natcon">natcon</a>&nbsp;&nbsp; 
 <a href="varrlx.html#nconeq">nconeq</a>&nbsp;&nbsp;
 <a href="varrlx.html#nnos">nnos</a>&nbsp;&nbsp;
 <a href="varrlx.html#ntime">ntime</a>&nbsp;&nbsp; 
 <br>
O. <a href="varrlx.html#optcell">optcell</a>&nbsp;&nbsp; <br>
P. <br>
Q. <br>
 <a href="varrlx.html#qmass">qmass</a>&nbsp;&nbsp;
R. <a href="varrlx.html#restartxf">restartxf</a>&nbsp;&nbsp; <br>
S. <a href="varrlx.html#signperm">signperm</a>&nbsp;&nbsp; <a
 href="varrlx.html#strfact">strfact</a>&nbsp;&nbsp; <a
 href="varrlx.html#strprecon">strprecon</a>&nbsp;&nbsp; <a
 href="varrlx.html#strtarget">strtarget</a>&nbsp;&nbsp; <br>
T. <a href="varrlx.html#tolmxf">tolmxf</a>&nbsp;&nbsp; <br>
U. <br>
V. 
<a href="varrlx.html#vel">vel</a>&nbsp;&nbsp; 
<a href="varrlx.html#vis">vis</a>&nbsp;&nbsp; 
<a href="varrlx.html#vmass">vmass</a>&nbsp;&nbsp;
<br>
W. <a href="varrlx.html#wtatcon">wtatcon</a>&nbsp;&nbsp; <br>
X. <br>
Y. <br>
Z.
<br>
<br>
<br>
<br>
<hr><font id="title"><a name="amu">amu</a></font>
<br>
<font id="definition">Mnemonics: Atomic Mass Units </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real array amu(<a
 href="varbas.html#ntypat">ntypat</a>) </font>
<br>
<font id="default">Default is provided by a database of atomic masses.</font>
<br>
<br>
<font id="text">Gives the masses in atomic mass units for each kind
of atom in cell. These masses are used in performing
molecular dynamical atomic motion if
<a href="varrlx.html#ionmov">ionmov</a>=1, 6, 7 or 8.
Note that one may set all masses to 1 for certain cases
in which merely structural relaxation is desired and not
actual molecular dynamics.
</font>
<p><font id="text">Using 1986 recommended values, 1 atomic mass unit =
1.6605402e-27 kg.
In this unit the mass of Carbon 12 is exactly 12.
</font></p>
<p><font id="text">A database of atomic masses is provided, giving
default values.
Note that the default database uses mixed isotope masses (for Carbon
the natural occurence of Carbon 13 is taken into account).
The values are those recommended by the commission on Atomic Weights
and
Isotopic Abundances, Inorganic Chemistry Division, IUPAC, in
<i>Pure Appl. Chem.</i> <b>60</b>, 841 (1988).
For Tc, Pm, Po to Ac, Pa and beyond U,
none of the isotopes has a half-life greater than 3.0d10 years, and
the values provided in the database do not come from that source.
For alchemical pseudoatoms, the masses of the constituents
atoms are mixed, according to the alchemical miwing
coefficients <a href="vargs.html#mixalch">mixalch</a>
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="delayperm">delayperm</a></font>
<br>
<font id="definition">Mnemonics: DELAY between trials to PERMUTE atoms </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer </font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">Delay (number of time steps) between trials to permute
two atoms, in
view of accelerated search of minima. Still in development. See the
routine moldyn.f. See also <a href="varrlx.html#signperm">signperm</a>.
When <b>delayperm</b> is zero, there is not permutation trials.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="dilatmx">dilatmx</a></font>
<br>
<font id="definition">Mnemonics: DILATation : MaXimal value </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 1.0 .</font>
<br>
<br>
<font id="text">Gives the maximal permitted scaling of
the lattice parameters when the cell shape and
dimension is varied (see variable <a href="varrlx.html#optcell">optcell</a>).
It is used to define the sphere of plane waves
and FFT box coherent with the possible modifications
of the cell (<a href="varrlx.html#ionmov">ionmov</a>==2 and <a
 href="varrlx.html#optcell">optcell</a>/=0).
For these definitions, it is equivalent
to changing <a href="varbas.html#ecut">ecut</a> by multiplying it by <b>dilatmx</b><sup>2</sup>
(the result is an "effective ecut", called internally "ecut_eff",
other uses of <a href="varbas.html#ecut">ecut</a> being not modified
when <b>dilatmx</b>&gt;1.0 .
<br>
Using <b>dilatmx</b>&lt;1.0 is equivalent to changing <a
 href="varbas.html#ecut">ecut</a>
in all its uses. This is allowed, although its meaning
is no longer related to a maximal expected scaling.
<br>
Setting <b>dilatmx</b> to a large value leads to waste
of CPU time and memory. Supposing you think that the
optimized <a href="varbas.html#acell">acell</a> values might be 10%
larger than your
input values, use simply <b>dilatmx</b> 1.1 . This will already
lead to an increase of the number of planewaves by a factor
(1.1)<sup>3</sup>=1.331 , and a corresponding increase in CPU time
and memory.
<br>
It is possible to use <b>dilatmx</b> when <a
 href="varrlx.html#optcell">optcell</a>=0, but
a value larger than 1.0 will be a waste.
</font><br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="dtion">dtion</a></font>
<br>
<font id="definition">Mnemonics: Delta Time for IONs </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 100.</font>
<br>
<br>
<font id="text">Used for controlling ion time steps.
If <a href="varrlx.html#ionmov">ionmov</a> is set to 1, 6 or 7, then
molecular dynamics is&nbsp;
used to update atomic positions in response to
forces. The parameter <b>dtion</b> is a time step in
atomic units of time. (One atomic time unit is
2.418884e-17 seconds, which is the value of
Planck's constant in hartree*sec.)
In this case the atomic masses, in amu (given in array "<a
 href="varrlx.html#amu">amu</a>"),
are used in Newton's equation and the viscosity (for <a
 href="varrlx.html#ionmov">ionmov</a>=1)
and number of time steps are provided to the code using input
variables "<a href="varrlx.html#vis">vis</a>" and "<a
 href="varrlx.html#ntime">ntime</a>".
The code actually converts
from masses in amu to masses in atomic units (in units
of electron masses) but the user enters masses in <a
 href="varrlx.html#amu">amu</a>.
(The conversion from amu to atomic units (electron
masses) is 1822.88851 electron masses/amu.)
<br>
A typical good value for <b>dtion</b> is about 100.
The user must try several values
for <b>dtion</b> in order to establish the stable and efficient
choice for the accompanying amu, atom types and positions,
and <a href="varrlx.html#vis">vis</a> (viscosity).
<br>
For quenched dynamics (<a href="varrlx.html#ionmov">ionmov</a>=7), a
larger time step might
be taken, for example 200.
<br>
No meaning for RF calculations.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="ecutsm">ecutsm</a></font>
<br>
<font id="definition">Mnemonics: Energy CUToff SMearing </font>
<br>
<font id="category">Characteristic: ENERGY </font>
<br>
<font id="vartype">Variable type: real parameter (in Hartree) </font>
<br>
<font id="default">Default is 0.d0</font>
<br>
<br>
<font id="text">This input variable is important when performing
relaxation of unit cell
size and shape (non-zero <a href="varbas.html#optcell">optcell</a>).
Using a non-zero
<b>ecutsm</b>, the total energy curves as a function of
<a href="varbas.html#ecut">ecut</a>, or <a href="varbas.html#acell">acell</a>,
can be smoothed,
keeping consistency with
the stress (and automatically including the Pulay stress). The
recommended
value is 0.5 Ha. Actually, when <a href="varbas.html#optcell">optcell</a>/=0,
ABINIT requires
<b>ecutsm</b> to be larger than zero. If you want to optimize cell
shape and size without
smoothing the total energy curve (a dangerous thing to do), use a very
small <b>ecutsm</b>,
on the order of one microHartree.
</font>
<p><font id="text">Technical information :
<br>
See Bernasconi et al, J. Phys. Chem. Solids 56, 501 (1995)
for a related method.
<br>
<b>ecutsm</b> allows to define an effective kinetic energy for plane
waves, close to, but
lower than the
maximal kinetic energy <a href="varbas.html#ecut">ecut</a>. For
kinetic
energies less than <a href="varbas.html#ecut">ecut</a>-<b>ecutsm</b>,
nothing is modified,
while between <a href="varbas.html#ecut">ecut</a>-<b>ecutsm</b> and <a
 href="varbas.html#ecut">ecut</a>,
the kinetic energy is multiplied by:
<br>
1.0 / ( x<sup>2</sup> (3+x-6x<sup>2</sup>+3x<sup>3</sup>))
<br>
where x = (<a href="varbas.html#ecut">ecut</a> - kinetic_energy)/<b>ecutsm</b>
<br>
Note that x<sup>2</sup> ( 3+x-6x<sup>2</sup>+3x<sup>3</sup>) is 0 at
x=0, with vanishing derivative,
and that at x=1 , it is 1, with also vanishing derivative.
<br>
If <b>ecutsm</b> is zero, the unmodified kinetic energy is used.
<br>
<b>ecutsm</b> can be specified in Ha (the default), Ry, eV or Kelvin,
since
<b>ecutsm</b> has the
'<a href="../users/abinis_help.html#dimensions">ENERGY</a>'
characteristics.
(1 Ha=27.2113845 eV).
<br>
A few test for Silicon (diamond structure, 2 k-points) have
shown 0.5 Ha to be largely enough for <a href="varbas.html#ecut">ecut</a>
between 2Ha and 6Ha,
to get smooth curves. It is likely that this value is OK
as soon as <a href="varbas.html#ecut">ecut</a> is larger than 4Ha.
Note that prior to v4.4 (in v4.3 and older versions), the smoothing
function was
<br>
1.0 / ( x<sup>2</sup> ( 3-2*x) )
<br>
However, the second derivative was not continuous at the cut-off
energy. This
leads to problems for elastic constant calculations using response
functions.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="friction">friction</a></font>
<br>
<font id="definition">Mnemonics: internal FRICTION coefficient </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 0.001 </font>
<br>
<br>
<font id="text">Gives the internal friction coefficient (atomic units)
for Langevin dynamics (when <a href="varrlx.html#ionmov">ionmov</a>=9):
fixed temperature simulations with random forces.
</font>
<p><font id="text">The equation of motion is :<br>
M<sub>I</sub> d<sup>2</sup>R<sub>I</sub>/dt<sup>2</sup>= F<sub>I</sub>
- <b>friction</b> M<sub>I</sub> dR<sub>I</sub>/dt - F_random<sub>I</sub>
<br>
where F_random<sub>I</sub> is a Gaussian random force with average
zero,
and variance 2 <b>friction</b> M<sub>I</sub> kT.
<br>
The atomic unit of friction is
hartrees*electronic mass*(atomic time units)/Bohr<sup>2</sup>. See J.
Chelikowsky, J. Phys. D : Appl Phys. 33(2000)R33.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="getcell">getcell</a></font>
<br>
<font id="definition">Mnemonics: GET CELL parameters from ... </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer parameter, an instance of a
'get' variable. </font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">This variable is typically used to chain the
calculations,
in the multi-dataset mode (<a href="varbas.html#ndtset">ndtset</a>&gt;0),
since it describes from which dataset <a href="varbas.html#acell">acell</a>
and
<a href="varbas.html#rprim">rprim</a> are to be taken, as input of the
present
dataset. The cell parameters are EVOLVING variables,
for which such a chain of calculations is useful.
<br>
If ==0, no use of previously computed values must occur.
<br>
If it is positive, its value gives the index of the dataset
from which the data are to be used as input data.
It must be the index of a dataset already computed in the
SAME run.
<br>
If equal to -1, the output data of the previous dataset
must be taken, which is a frequently occuring case.
However, if the first dataset is treated, -1 is equivalent
to 0, since no dataset has yet been computed in the same run.
<br>
If another negative number, it indicates the number
of datasets to go backward to find the needed data
(once again, going back beyond the first dataset is equivalent
to using a null get variable).</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="getxcart">getxcart</a></font>
<br>
<font id="definition">Mnemonics: GET XCART from ... </font>
<p><font id="title"><a name="getxred">getxred</a></font>
<br>
<font id="definition">Mnemonics: GET XRED from ... </font>
</p>
<p><font id="title"><a name="getvel">getvel</a></font>
<br>
<font id="definition">Mnemonics: GET VEL from ... </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer parameters, instances of
'get' variables </font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">These variables are typically used to chain the
calculations,
in the multi-dataset mode (<a href="varbas.html#ndtset">ndtset</a>&gt;0)
since they describe from which dataset the corresponding
output variables are to be taken, as input of the present
dataset. The atomic positions and velocities are EVOLVING variables,
for which such a chain of calculation is useful.
<br>
Note that the use of <b>getxcart</b> and <b>getxred</b> differs when
<a href="varbas.html#acell">acell</a> and <a href="varbas.html#rprim">rprim</a>
are different from one dataset
to the other.
<br>
If ==0, no use of previously computed values must occur.
<br>
If it is positive, its value gives the index of the dataset
from which the data are to be used as input data.
It must be the index of a dataset already computed in the
SAME run.
<br>
If equal to -1, the output data of the previous dataset
must be taken, which is a frequently occuring case.
However, if the first dataset is treated, -1 is equivalent
to 0, since no dataset has yet been computed in the same run.
<br>
If another negative number, it indicates the number
of datasets to go backward to find the needed data
(once again, going back beyond the first dataset is equivalent
to using a null get variable).
<br>
Note : <b>getxred</b> and <b>getxcart</b> cannot be simultaneously
non-zero for the same dataset. On the other hand the use of
<b>getvel</b> with <b>getxred</b> is allowed, despite the different
coordinate system.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="iatcon">iatcon</a></font>
<br>
<font id="definition">Mnemonics: Indices of AToms in CONstraint
equations</font>
<br>
<font id="category">Characteristic: NO MULTI, NOT INTERNAL </font>
<br>
<font id="vartype">Variable type: integer array iatcon(<a
 href="varrlx.html#natcon">natcon</a>,<a href="varrlx.html#nconeq">nconeq</a>)</font>
<br>
<font id="default">Default is 0 </font>
<br>
<br>
<font id="text">Gives the indices of the atoms appearing in each of the
<a href="varrlx.html#nconeq">nconeq</a>
independent equations constraining the motion of
atoms during structural optimization or molecular dynamics (see <a
 href="varrlx.html#nconeq">nconeq</a>, <a href="varrlx.html#natcon">natcon</a>,
and <a href="varrlx.html#wtatcon">wtatcon</a>).
<br>
(Note : combined with wtatcon to give internal representation of the
latter - this should be described)
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="iatfix">iatfix</a></font>
<br>
<font id="definition">Mnemonics: Indices of AToms that are FIXed </font>
<p><font id="title"><a name="iatfixx">iatfixx</a></font>
<br>
<font id="definition">Mnemonics: Indices of AToms that are FIXed along
the X direction </font>
</p>
<p><font id="title"><a name="iatfixy">iatfixy</a></font>
<br>
<font id="definition">Mnemonics: Indices of AToms that are FIXed along
the Y direction </font>
</p>
<p><font id="title"><a name="iatfixz">iatfixz</a></font>
<br>
<font id="definition">Mnemonics: Indices of AToms that are FIXed along
the Z direction </font>
<br>
<font id="category">Characteristic: <b>iatfixx</b>,<b>iatfixy</b> and <b>iatfixz</b>
are NOT INTERNAL </font>
<br>
<font id="vartype">Variable type: integer arrays of length <a
 href="varrlx.html#natfix">natfix</a>,
<a href="varrlx.html#natfixx">natfixx</a>, <a
 href="varrlx.html#natfixy">natfixy</a> or
<a href="varrlx.html#natfixz">natfixz</a> </font>
<br>
<font id="default">Default is No Default (ignored unless <a
 href="varrlx.html#natfix">natfix</a>,
<a href="varrlx.html#natfixx">natfixx</a>, <a
 href="varrlx.html#natfixy">natfixy</a> or
<a href="varrlx.html#natfixz">natfixz</a> &gt; 0).</font>
<br>
<br>
<font id="text">Give the index (in the range 1 to <a
 href="varbas.html#natom">natom</a>)
of each atom which is to
be held fixed for structural optimization or molecular dynamics.
The variable <b>iatfix</b> lists those fixed in the three directions,
while the other variables allow to fix some atoms along
x, y or z directions, or a combination of these.
</font></p>
<p><font id="text">WARNING : The implementation is inconsistent !! For <a
 href="varrlx.html#ionmov">ionmov</a>==1, the fixing of directions
was done in cartesian coordinates, while for the other values
of <a href="varrlx.html#ionmov">ionmov</a>, it was done in reduced
coordinates. Sorry for this.
</font></p>
<p><font id="text"> There is no harm in fixing one atom in the three
directions
using <b>iatfix</b>, then fixing it again in other directions
by mentioning it in <b>iatfixx</b>, <b>iatfixy</b> or <b>iatfixz</b>.
<br>
The internal representation of these input data is done
by the mean of one variable <b>iatfix</b>(3,<a href="varbas.html#natom">natom</a>),
defined
for each direction and each atom, being 0 if the atom is
not fixed along the direction, and 1 if the atom is fixed
along the direction.
When some atoms are fixed along 1 or 2 directions, the
use of symmetries is restricted to symmetry operations
whose (3x3) matrices <a href="varbas.html#symrel">symrel</a> are
diagonal.
<br>
If the geometry builder is used, <b>iatfix</b> will be related
to the preprocessed set of atoms, generated by the
geometry builder. The user must thus foresee the effect
of this geometry builder (see <a href="vargeo.html#objarf">objarf</a>).</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="ionmov">ionmov</a></font>
<br>
<font id="definition">Mnemonics: IONic MOVEs </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer parameter </font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">Control the displacements of
ions, and eventually (see <a href="varrlx.html#optcell">optcell</a>)
changes of cell shape
and size.
</font>
<ul>
  <font id="text">
  <li>0=&gt; do not move ions; </li>
  <li>1=&gt; move atoms using molecular dynamics with
optional viscous damping (friction linearly proportional
to velocity). The viscous damping is controlled by the
parameter "<a href="varrlx.html#vis">vis</a>".
If actual undamped molecular dynamics is desired,
set <a href="varrlx.html#vis">vis</a> to 0. The implemented algorithm
is the generalisation
of the Numerov technique (6th order), but is NOT invariant
upon time-reversal, so that the energy is not conserved.
The value <b>ionmov</b>=6 will usually be preferred, although the
algorithm that is implemented is lower-order.
opcell/=0 is not available</li>
  <li>2=&gt; conduct structural optimization using the
Broyden-Fletcher-Goldfarb-Shanno minimization (BFGS).
This is much more efficient for structural optimization
than viscous damping, when there are less than
let's say 10 degrees of freedom to optimize.</li>
  <li>3=&gt; conduct structural optimization using the
Broyden-Fletcher-Goldfarb-Shanno minimization (BFGS),
modified to take into account the total energy as well as
the gradients (as in usual BFGS). <br>
See the paper by
Schlegel, J. Comp. Chem. 3, 214 (1982).
Might be better than <b>ionmov</b>=2 for few degrees of freedom
(less than 3 or 4)</li>
  <li>4=&gt; conjugate gradient algorithm for simultaneous
optimization of potential and ionic degrees of freedom.
It can be used with <a href="varbas.html#iscf">iscf</a>=2 and <a
 href="varbas.html#iscf">iscf</a>=5 or 6
(WARNING : this is under development, and does not work very well in
many
cases). <a href="varrlx.html#optcell">optcell</a>/=0 is not available.</li>
  <li>5=&gt; Simple relaxation of ionic positions according
to (converged) forces. Equivalent to <b>ionmov</b>=1 with
zero masses, albeit the relaxation coefficient is not <a
 href="varrlx.html#vis">vis</a>,
but <a href="vardev.html#iprcfc">iprcfc</a>. <a
 href="varrlx.html#optcell">optcell</a>/=0 is not available.</li>
  <li>6=&gt; Molecular dynamics using the Verlet algorithm, see
Allen &amp; Tildesley "Computer simulation of liquids" 1987, p 81.
Although partly coded, <a href="varrlx.html#optcell">optcell</a>/=0 is
not available.
The only related parameter is the time step
(<a href="varrlx.html#dtion">dtion</a>).</li>
  <li>7=&gt; Quenched Molecular dynamics using the Verlet
algorithm, and stopping each atom for which the scalar product
of velocity and force is negative.
Although partly coded, <a href="varrlx.html#optcell">optcell</a>/=0 is
not available.
The only related parameter is the time step
(<a href="varrlx.html#dtion">dtion</a>).
The goal is not
to produce a realistic dynamics, but to go as fast as possible
to the minimum. For this purpose, it is advised to set
all the masses to the same value (for example, use the Carbon mass,
i.e. set <a href="varrlx.html#amu">amu</a> to 12 for all type of
atoms).</li>
  <li>8=&gt; Molecular dynamics with Nose-Hoover thermostat,
using the Verlet algorithm.
Although partly coded, <a href="varrlx.html#optcell">optcell</a>/=0 is
not available.
Related parameters :
the time step (<a href="varrlx.html#dtion">dtion</a>),
the initial temperature (<a href="varrlx.html#mditemp">mditemp</a>),
the final temperature (<a href="varrlx.html#mdftemp">mdftemp</a>),
and the thermostat mass (<a href="varrlx.html#noseinert">noseinert</a>).</li>
  <li>9=&gt; Langevin molecular dynamics.
Although partly coded, <a href="varrlx.html#optcell">optcell</a>/=0 is
not available.
Related parameters :
the time step (<a href="varrlx.html#dtion">dtion</a>),
the initial temperature (<a href="varrlx.html#mditemp">mditemp</a>),
the final temperature (<a href="varrlx.html#mdftemp">mdftemp</a>),
and the friction coefficient (<a href="varrlx.html#friction">friction</a>).
  </li>
  <li>12=&gt; Isokinetic ensemble molecular dynamics.
The equation of motion of the ions in contact with a thermostat
are solved with the algorithm proposed by Zhang [J. Chem. Phys. 106,
6102 (1997)],
as worked out by Minary et al [J. Chem. Phys. 188, 2510 (2003)].
The conservation of the kinetic energy is obtained within machine
precision,
at each step. <br>
Although partly coded, <a href="varrlx.html#optcell">optcell</a>/=0 is
not available.
Related parameters : the time step (<a href="varrlx.html#dtion">dtion</a>),
the initial temperature (<a href="varrlx.html#mditemp">mditemp</a>),
the final temperature (<a href="varrlx.html#mdftemp">mdftemp</a>),
and the friction coefficient (<a href="varrlx.html#friction">friction</a>).</li>
  <li>13=&gt; Iosthermal/isenthalpic ensemble.
The equation of motion of the ions in contact with a thermostat
and a barostat are solved with the algorithm proposed by Martyna,
Tuckermann Tobias and Klein [Mol. Phys., 1996, p. 1117].<br>
&nbsp; <a href="varrlx.html#optcell">optcell</a>/=0 is available.
Related parameters : the time step (<a href="varrlx.html#dtion">dtion</a>),
the initial temperature (<a href="varrlx.html#mditemp">mditemp</a>),
the final temperature (<a href="varrlx.html#mdftemp">mdftemp</a>),
the number of thermostats (<a href="varrlx.html#nnos">nnos</a>),
and the masses of thermostats (<a href="varrlx.html#qmass">qmass</a>).
If optcell=1 or 2, the mass of the barostat (<a href="varrlx.html#bmass">bmass</a>
or <a href="varrlx.html#bmass">vmass</a>) must be given in addition. <br>
  </li>
  </font>
</ul>
<ul>
</ul>
<font id="text"><br>
No meaning for RF calculations.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="mdftemp">mdftemp</a></font>
<br>
<font id="definition">Mnemonics: Molecular Dynamics Final Temperature </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real mdftemp</font>
<br>
<font id="default">Default is <b>mdftemp</b>=<a
 href="varrlx.html#mditemp">mditemp</a></font>
<br>
<br>
<font id="text">Give the final temperature (for itime=<a
 href="varrlx.html#ntime">ntime</a>)
of the Nose-Hoover thermostat (<a href="varrlx.html#ionmov">ionmov</a>=8)
and Langevin dynamics (<a href="varrlx.html#ionmov">ionmov</a>=9), in
Kelvin.
This temperature will change linearly from
<a href="varrlx.html#mditemp">mditemp</a> at itime=1 to
the final temperature <b>mdftemp</b> at the end of the
<a href="varrlx.html#ntime">ntime</a> timesteps.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="mditemp">mditemp</a></font>
<br>
<font id="definition">Mnemonics: Molecular Dynamics Initial Temperature
</font><br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real mditemp</font>
<br>
<font id="default">Default is 300</font>
<br>
<br>
<font id="text">Give the initial temperature (for itime=1)
of the Nose-Hoover thermostat (<a href="varrlx.html#ionmov">ionmov</a>=8)
and Langevin dynamics (<a href="varrlx.html#ionmov">ionmov</a>=9), in
Kelvin.
This temperature will change linearly to reach
the temperature <a href="varrlx.html#mdftemp">mdftemp</a> at the end
of the
<a href="varrlx.html#ntime">ntime</a> timesteps.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="mdwall">mdwall</a></font>
<br>
<font id="definition">Mnemonics: Molecular Dynamics WALL location </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 10000.0 Bohr (the walls are extremely far
away).</font>
<br>
<br>
<font id="text">Gives the location (atomic units) of walls
on which the atoms will bounce back.
when <a href="varrlx.html#ionmov">ionmov</a>=6, 7, 8 or 9. For each
cartesian direction idir=1, 2 or 3, there is a pair of walls with
coordinates xcart(idir)=-wall and xcart(idir)=rprimd(idir,idir)+wall .
Supposing the particle will cross the wall, its velocity normal to the
wall is reversed, so that it bounces back.
<br>
By default, given in Bohr atomic units
(1 Bohr=0.5291772108 Angstroms), although Angstrom can be specified,
if preferred, since <b>mdwall</b> has the
'<a href="../users/abinis_help.html#dimensions">LENGTH</a>'
characteristics.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="natcon">natcon</a></font>
<br>
<font id="definition">Mnemonics: Number of AToms in CONstraint equations</font>
<br>
<font id="category">Characteristic: NO MULTI </font>
<br>
<font id="vartype">Variable type: integer array of length <a
 href="varrlx.html#nconeq">nconeq</a></font>
<br>
<font id="default">Default is 0 </font>
<br>
<br>
<font id="text">Gives the number of atoms appearing in each of the <a
 href="varrlx.html#nconeq">nconeq</a>
independent equations constraining the motion of
atoms during structural optimization or molecular dynamics (see <a
 href="varrlx.html#nconeq">nconeq</a>, <a href="varrlx.html#iatcon">iatcon</a>,
and <a href="varrlx.html#wtatcon">wtatcon</a>).
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="natfix">natfix</a></font>
<br>
<font id="definition">Mnemonics: Number of Atoms that are FIXed </font>
<p><font id="title"><a name="natfixx">natfixx</a></font>
<br>
<font id="definition">Mnemonics: Number of Atoms that are FIXed along
the X direction </font>
</p>
<p><font id="title"><a name="natfixy">natfixy</a></font>
<br>
<font id="definition">Mnemonics: Number of Atoms that are FIXed along
the Y direction </font>
</p>
<p><font id="title"><a name="natfixz">natfixz</a></font>
<br>
<font id="definition">Mnemonics: Number of Atoms that are FIXed along
the Z direction </font>
<br>
<font id="category">Characteristic: NOT INTERNAL </font>
<br>
<font id="vartype">Variable type: integer parameter </font>
<br>
<font id="default">Default is 0 (no atoms held fixed).</font>
<br>
<br>
<font id="text">Gives the number of atoms (not to exceed
<a href="varbas.html#natom">natom</a>) which are to be held fixed
during a structural
optimization or molecular dynamics. <br>
When <b>natfix</b> &gt; 0,
<b>natfix</b> entries should be provided in array <a
 href="varrlx.html#iatfix">iatfix</a>.
<br>
When <b>natfixx</b> &gt; 0, <b>natfixx</b> entries should be provided
in array <a href="varrlx.html#iatfixx">iatfixx</a>, and so on ...</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="nconeq">nconeq</a></font>
<br>
<font id="definition">Mnemonics: Number of CONstraint EQuations</font>
<br>
<font id="category">Characteristic: NO MULTI </font>
<br>
<font id="vartype">Variable type: integer parameter</font>
<br>
<font id="default">Default is 0 </font>
<br>
<br>
<font id="text">Gives the number of independent equations constraining
the motion of
atoms during structural optimization or molecular dynamics (see <a
 href="varrlx.html#natcon">natcon</a>, <a href="varrlx.html#iatcon">iatcon</a>,
and <a href="varrlx.html#wtatcon">wtatcon</a>).
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="noseinert">noseinert</a></font>
<br>
<font id="definition">Mnemonics: NOSE INERTia factor </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real noseinert</font>
<br>
<font id="default">Default is 1.0d5 </font>
<br>
<br>
<font id="text">Give the inertia factor W<sub>T</sub> of the
Nose-Hoover thermostat
(when <a href="varrlx.html#ionmov">ionmov</a>=8), in atomic
units of weight*length<sup>2</sup>, that is (electron mass)*(Bohr)<sup>2</sup>.
The equations of motion are :<br>
M<sub>I</sub> d<sup>2</sup>R<sub>I</sub>/dt<sup>2</sup>= F<sub>I</sub>
- dX/dt M<sub>I</sub> dR<sub>I</sub>/dt
<br>
and
<br>
W<sub>T</sub> d<sup>2</sup>X/dt<sup>2</sup>=
Sum(I) M<sub>I</sub> (dR<sub>I</sub>/dt)<sup>2</sup>
- 3Nk<sub>B</sub>T
<br>
where I represent each nucleus, M<sub>I</sub> is the mass of each
nucleus
(see <a href="varrlx.html#amu">amu</a>),
R<sub>I</sub> is the coordinate of each nucleus (see <a
 href="varbas.html#xcart">xcart</a>),
dX/dt is a dynamical friction coefficient, and T is the temperature
of the thermostat (see <a href="varrlx.html#mditemp">mditemp</a> and <a
 href="varrlx.html#mdftemp">mdftemp</a>).
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="nnos">nnos</a></font><br>
<font id="definition">Mnemonics: Number of nose masses</font><br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer nnos</font><br>
<font id="default">Default is 0</font><br>
<br>
<font id="text">Give the number of oscillators in the Martyna et al.
chain of oscillators thermostats (when <a href="varrlx.html#ionmov">ionmov</a>=13).
The mass of these oscillators is given by qmass (similar to <a
 href="varrlx.html#noseinert">noseinert</a>)&nbsp;</font>
<br>
<br>
<br>
<br>
<a href="varrlx.html#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="ntime"></a></font><br>
<font id="title"><a name="ntime">ntime</a></font>
<br>
<font id="definition">Mnemonics: Number of TIME steps </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer parameter </font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">Gives the number of molecular dynamics time steps or
Broyden
structural optimization steps to be done if <a
 href="varrlx.html#ionmov">ionmov</a>=1 or 2
respectively. <br>
Note that at the present
the option <a href="varrlx.html#ionmov">ionmov</a>=1 is initialized
with four
Runge-Kutta steps which costs some overhead in the startup.
By contrast, the initialisation of
other <a href="varrlx.html#ionmov">ionmov</a> values is only one
SCF call. <br>
<b>ntime</b> is ignored if <a href="varrlx.html#ionmov">ionmov</a>=0.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="ntypat">ntypat</a></font>
<br>
<font id="definition">Mnemonics: Number of TYPEs of atoms </font>
<br>
<font id="category">Characteristic: NO MULTI </font>
<br>
<font id="vartype">Variable type: integer parameter </font>
<br>
<font id="default">Default is 1.</font>
<br>
<br>
<font id="text">Gives the number of types of atoms. E.g. for
a homopolar system (e.g. pure Si) <b>ntypat</b> is 1.
<br>
The code tries to read the same number pseudopotential files.
<br>
The first pseudopotential is assigned type number 1, and so
on ...</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="optcell">optcell</a></font>
<br>
<font id="definition">Mnemonics: OPTimize the CELL shape and dimensions
</font><br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer parameter </font>
<br>
<font id="default">The Default is <b>optcell</b>=0</font>
<br>
<br>
<font id="text">Allows to optimize the
unit cell shape and dimensions, when <a href="varrlx.html#ionmov">ionmov</a>=2
or 3.
The configuration for which the stress almost vanishes
is iteratively determined, by using the same algorithms
as for the nuclei positions. Will eventually
modify <a href="varbas.html#acell">acell</a> and/or <a
 href="varbas.html#rprim">rprim</a>.
The ionic positions are ALWAYS updated, according to the forces.
A target stress tensor might be defined, see <a
 href="varrlx.html#strtarget">strtarget</a>
</font>
<ul>
  <font id="text">
  <li><b>optcell</b>=0 : modify nuclear positions, since <a
 href="varrlx.html#ionmov">ionmov</a>=2, but no cell shape and
dimension optimisation.</li>
  <li><b>optcell</b>=1 : optimisation of volume only (do not modify <a
 href="varbas.html#rprim">rprim</a>, and allow an homogeneous
dilatation of the three components of <a href="varbas.html#acell">acell</a>)</li>
  <li><b>optcell</b>=2 : full optimization of cell geometry (modify <a
 href="varbas.html#acell">acell</a> and <a href="varbas.html#rprim">rprim</a>
- normalize the vectors of <a href="varbas.html#rprim">rprim</a> to
generate the <a href="varbas.html#acell">acell</a>). This is the usual
mode for cell shape and volume optimization. It takes into account the
symmetry of the system, so that only the effectively relevant degrees
of freedom are optimized.</li>
  <li><b>optcell</b>=3 : constant-volume optimization of cell geometry
(modify <a href="varbas.html#acell">acell</a> and <a
 href="varbas.html#rprim">rprim</a> under constraint - normalize the
vectors of <a href="varbas.html#rprim">rprim</a> to generate the <a
 href="varbas.html#acell">
acell</a>)</li>
  <li><b>optcell</b>=4,5 or 6 : optimize <a href="varbas.html#acell">acell</a>(1),
    <a href="varbas.html#acell">acell</a>(2) or <a
 href="varbas.html#acell">acell</a>(3), respectively (only works if the
two other vectors are orthogonal to the optimized one, the latter being
along its cartesian axis).</li>
  <li><b>optcell</b>=7,8 or 9 : optimize the cell geometry while
keeping the first, second or third vector unchanged (only works if the
two other vectors are orthogonal to the one left unchanged, the latter
being along its cartesian axis).</li>
  </font>
</ul>
<font id="text">NOTE that a few details require attention when
performing
unit cell optimisation :
</font>
<ul>
  <font id="text">
  <li> one has to get rid of the discontinuites due to discrete changes
of plane wave number with cell size, by using a suitable value of <a
 href="varrlx.html#ecutsm">ecutsm</a>;</li>
  <li> one has to allow for the possibility of a larger sphere of plane
waves, by using <a href="varrlx.html#dilatmx">dilatmx</a>;</li>
  <li> one might have to adjust the scale of stresses to the scale of
forces, by using <a href="varrlx.html#strfact">strfact</a>.</li>
  <li> if all the reduced coordinates of atoms are fixed by symmetry,
one cannot use <a href="varbas.html#toldff">toldff</a> to stop the SCF
cycle. (Suggestion : use <a href="varbas.html#toldfe">toldfe</a> with
a small value, like 1.0d-10)</li>
  </font>
</ul>
<font id="text">It is STRONGLY suggested first to optimize the ionic
positions
without cell shape and size optimization (<b>optcell</b>=0),
then start the cell shape and size optimization
from the cell with relaxed ionic positions.
</font>
<p><font id="text">Presently (v3.1), one cannot restart (<a
 href="varrlx.html#restartxf">restartxf</a>)
a calculation with a non-zero <b>optcell</b> value from the
(x,f) history of another run with a different non-zero <b>optcell</b>
value. There
are still a few problems at that level.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="restartxf">restartxf</a></font>
<br>
<font id="definition">Mnemonics: RESTART from (X,F) history </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer parameter </font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">Control the restart of broyden minimisation.
<br>
Works only for <a href="varrlx.html#ionmov">ionmov</a>=2 (Broyden) and
when an input
wavefunction file is specified, thanks to the
appropriate values of <a href="varfil.html#irdwfk">irdwfk</a> or <a
 href="varfil.html#getwfk">getwfk</a>.
<br>
If positive, the code reads from the input wf file,
the previous history of atomic coordinates and
corresponding forces, in order to continue the work done
by the job that produced this wf file. If <a href="varrlx.html#optcell">optcell</a>/=0,
the history of <a href="varbas.html#acell">acell</a> and <a
 href="varbas.html#rprim">rprim</a> variables is also taken
into account. The code will take
into consideration the whole history (if <b>restartxf</b>==1),
or discard the few first (x,f) pairs, and begin only at the
pair whose number corresponds to <b>restartxf</b>.
<br>
If zero, the Broyden minimization is done from scratch.
<br>
NOTE : the input wf file must have been produced by a
run that exited cleanly. It cannot be one of the temporary
wf files that exist when a job crashed.
</font>
<p><font id="text">Presently (v3.1), one cannot restart a calculation
with a non-zero <a href="varrlx.html#optcell">optcell</a> value from
the
(x,f) history of another run with a different non-zero <a
 href="varrlx.html#optcell">optcell</a> value. There
are still a few problems at that level. Starting a non-zero <a
 href="varrlx.html#optcell">optcell</a>
run from a zero <a href="varrlx.html#optcell">optcell</a> run should
work.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="rfasr">rfasr</a></font>
<br>
<font id="definition">Mnemonics: Response Function : Acoustic Sum Rule </font>
<br>
<font id="category">Characteristic: RESPFN </font>
<br>
<font id="vartype">Variable type: integer parameter </font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">Control the evaluation of the
acoustic sum rule in effective charge calculations
within a response function calculation.
<ul>
  <li>0 =&gt; no acoustic sum rule imposed</li>
  <li>1 =&gt; acoustic sum rule imposed with
extra charge evenly distributed among atoms</li>
  <li>2 =&gt; acoustic sum rule imposed with
extra charge given proportionally to those atoms with
the largest effective charge.</li>
</ul>
</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="signperm">signperm</a></font>
<br>
<font id="definition">Mnemonics: SIGN of PERMutation potential </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: integer </font>
<br>
<font id="default">Default is 1.</font>
<br>
<br>
<font id="text">In development. See the routine moldyn.f. See also <a
 href="varrlx.html#delayperm">delayperm</a>.
</font>
<p><font id="text"> +1 favors alternation of species
</font></p>
<p><font id="text"> -1 favors segregation
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="strfact">strfact</a></font>
<br>
<font id="definition">Mnemonics: STRess FACTor </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 100.0 (Bohr^2)</font>
<br>
<br>
<font id="text">The stresses multiplied
by <b>strfact</b> will be treated like forces in the
process of optimization (<a href="varrlx.html#ionmov">ionmov</a>=2,
non-zero
<a href="varrlx.html#optcell">optcell</a>).
<br>
For example, the stopping criterion defined by
<a href="varrlx.html#tolmxf">tolmxf</a> relates to these scaled
stresses.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="strprecon">strprecon</a></font>
<br>
<font id="definition">Mnemonics: STRess PRECONditioner </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 1.0 </font>
<br>
<br>
<font id="text">This is a scaling factor to initialize the part of
the Hessian related to the treatment of the stresses (optimisation
of the unit cell). In case there is an instability, decrease the
default value, e.g. set it to 0.1 .
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="strtarget">strtarget</a></font>
<br>
<font id="definition">Mnemonics: STRess TARGET </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real array strtarget(6) </font>
<br>
<font id="default">Default is 6*0.0 (Ha/Bohr**3)</font>
<br>
<br>
<font id="text">The optimization of cell size and shape,
as might be asked through <a href="varrlx.html#optcell">optcell</a>,
will target
the stress tensor defined by
by <b>strtarget</b>, or part thereof (if restricted optimizations
are asked, like fixed shape). Presently, this required target
stress is not taken into account for the determination of
the symmetries. If it breaks the symmetries of the input unit cell,
so that <a href="varbas.html#symrel">symrel</a> disagrees with <b>strtarget</b>,
the result will be unreliable. Also, presently, the thermodynamical
potential to be used in this situation (the free energy) does not
replace the total energy, so that, for exemple,
<a href="varrlx.html#ionmov">ionmov</a>=3 cannot be used,
since this algorithm is taking into account the total energy.
</font>
<p><font id="text">The components of the stress tensor must be stored
according to :
(1,1)-&gt;1 ; (2,2)-&gt;2 ; (3,3)-&gt;3 ; (2,3)-&gt;4 ; (3,1)-&gt;5 ;
(1,2)-&gt;6.
The conversion factor
between Ha/Bohr**3 and GPa is : 1 Ha/Bohr**3 = 29421.033d0 GPa.
<br>
Not used if <a href="varrlx.html#optcell">optcell</a>==0.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="qmass">qmass</a></font><br>
<font id="definition">Mnemonics: Q thermostat mass </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real array qmass(<a
 href="varrlx.html#nnos">nnos</a>) </font>
<br>
<font id="default">Default is nnos*10.0 </font><br>
<br>
<font id="text">This are the masses of the chains of <a
 href="varrlx.html#nnos">nnos</a> thermostats
to be used when <a href="varrlx.html#ionmov">ionmov</a>=13. </font>
<p><font id="text"><br>
This temperature control can be used with&nbsp; <a
 href="varrlx.html#optcell">optcell</a>==0, 1 (homogeneous cell
deformation) or 2 (full cell deformation)</font><br>
<br>
<br>
<br>
<a href="varrlx.html#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a><br>
</p>
<hr><font id="title"><a name="bmass">bmass,vmass</a></font><br>
<font id="definition">Mnemonics: Barostat mass</font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 10.</font><br>
<br>
&nbsp; <font id="text">vmass is the mass of the barostat when <a
 href="varrlx.html#ionmov">ionmov</a>=13 (constant pressure), and <a
 href="varrlx.html#optcell">optcell</a>=1 full cell fluctuations.</font><font
 id="text"><br>
&nbsp;bmass is the mass of the barostat when <a
 href="varrlx.html#ionmov">ionmov</a>=13 (constant pressure), and <a
 href="varrlx.html#optcell">optcell</a>=2 full cell fluctuations.</font><br>
<br>
<br>
<br>
<a href="varrlx.html#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="vel"></a></font><font id="title"><a
 name="tolmxf">tolmxf</a></font>
<br>
<font id="definition">Mnemonics: TOLerance on the MaXimal Force </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 5.0d-5 hartree/Bohr.</font>
<br>
<br>
<font id="text">Sets a maximal absolute force tolerance
(in hartree/Bohr) below which
BFGS structural relaxation iterations will stop.
<br>
Can also control tolerance on stresses, when <a
 href="varrlx.html#optcell">optcell</a>/=0,
using the conversion factor <a href="varrlx.html#strfact">strfact</a>.
This tolerance applies to any particular cartesian
component of any atom, excluding fixed ones.
See the parameter <a href="varrlx.html#ionmov">ionmov</a>.
<br>
This is to be used when trying to equilibrate a
structure to its lowest energy configuration (<a
 href="varrlx.html#ionmov">ionmov</a>=2).
<br>
A value of about 5.0d-5 hartree/Bohr or smaller
is suggested (this corresponds to about 2.5d-3 eV/Angstrom).
<br>
No meaning for RF calculations.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="vel">vel</a></font>
<br>
<font id="definition">Mnemonics: VELocity </font>
<br>
<font id="category">Characteristic: EVOLVING </font>
<br>
<font id="vartype">Variable type: real array vel(3,<a
 href="varbas.html#natom">natom</a>) </font>
<br>
<font id="default">Default is 3*<a href="varbas.html#natom">natom</a>
0's.</font>
<br>
<br>
<font id="text">Gives the starting velocities
of atoms, in cartesian coordinates, in Bohr/atomic time
units (atomic time units given where <a href="varrlx.html#dtion">dtion</a>
is described).
<br>
Irrelevant unless <a href="varrlx.html#ionmov">ionmov</a> &gt; 0.
<br>
For <a href="varrlx.html#ionmov">ionmov</a>=8 (Nose thermostat),
if <b>vel</b> is not initialized, a random initial
velocity giving the right kinetic energy will be generated.
<br>
If the geometry builder is used, <b>vel</b> will be related
to the preprocessed set of atoms, generated by the
geometry builder. The user must thus foresee the effect
of this geometry builder (see <a href="vargeo.html#objarf">objarf</a>).
<br>
Velocities evolve is <a href="varrlx.html#ionmov">ionmov</a>==1.</font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr><font id="title"><a name="vis">vis</a></font>
<br>
<font id="definition">Mnemonics: VIScosity </font>
<br>
<font id="category">Characteristic: </font>
<br>
<font id="vartype">Variable type: real parameter </font>
<br>
<font id="default">Default is 100.</font>
<br>
<br>
<font id="text">Gives the viscosity (atomic units) for linear
frictional damping term applied to molecular dynamics
when <a href="varrlx.html#ionmov">ionmov</a>=1. Used for eventual
relaxation of structure
(however, <a href="varrlx.html#ionmov">ionmov</a>=2 is in general more
efficient).
</font>
<p><font id="text">The equation of motion is :<br>
M<sub>I</sub> d<sup>2</sup>R<sub>I</sub>/dt<sup>2</sup>= F<sub>I</sub>
- <b>vis</b> dR<sub>I</sub>/dt
<br>
<br>
The atomic unit of viscosity is hartrees*(atomic time units)/Bohr<sup>2</sup>.
Units are not
critical as this is a fictitious damping used to relax
structures. A typical value for silicon is 400 with
<a href="varrlx.html#dtion">dtion</a> of 350 and atomic mass 28 <a
 href="varrlx.html#amu">amu</a>. Critical
damping is most desirable and is found only by
optimizing <b>vis</b> for a given situation. </font>
<br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a></p>
<hr><font id="title"><a name="wtatcon">wtatcon</a></font>
<br>
<font id="definition">Mnemonics: WeighTs for AToms in CONstraint
equations</font>
<br>
<font id="category">Characteristic: NO MULTI </font>
<br>
<font id="vartype">Variable type: real array wtatcon(3,<a
 href="varrlx.html#natcon">natcon</a>,<a href="varrlx.html#nconeq">nconeq</a>)</font>
<br>
<font id="default">Default is 0.</font>
<br>
<br>
<font id="text">Gives the weights determining how the motion of atoms
is constrained
during structural optimization or molecular dynamics (see <a
 href="varrlx.html#nconeq">nconeq</a>, <a href="varrlx.html#natcon">natcon</a>,
and <a href="varrlx.html#iatcon">iatcon</a>). For each of the <a
 href="varrlx.html#nconeq">nconeq</a> independent constraint equations,
wtatcon is a 3*<a href="varrlx.html#natcon">natcon</a> array giving
weights, W<sub>I</sub>,
for the x, y, and z components of each of the atoms (labeled by I) in
the list of indices <a href="varrlx.html#iatcon">iatcon</a>.
Prior to taking an atomic step, the calculated forces, F<sub>I</sub>,
are
replaced by projected forces, F'<sub>I</sub>, which satisfy the set of
constraint equations
<br>
<br>
Sum<sub>mu=x,y,z; I=1,natcon</sub>: W<sub>mu,I</sub> * F'<sub>mu,I</sub>
= 0 for each of the <a href="varrlx.html#nconeq">nconeq</a> arrays W<sub>I</sub>.
<br>
<br>
Different types of motion constraints can be implemented this way. For
example,
<br>
<br>
nconeq 1 natcon 2 iatcon 1 2 wtatcon 0 0 +1 0 0 -1
<br>
<br>
could be used to constrain the relative height difference of two
adsorbate atoms on a surface (assuming their
masses are equal), since F'<sub>z,1</sub> - F'<sub>z,2</sub> = 0
implies z<sub>1</sub> - z<sub>2</sub> = constant.
</font><br>
<br>
<br>
<br>
<a href="#top">Go to the top</a>
<b> | </b><a href="keyhr.html#list">Complete list of input variables</a>
<hr>Goto :
<a href="http://www.abinit.org"><b>ABINIT home Page</b></a>
<b> | </b>
<a href="../users/acknowledgments.html"><b>Suggested acknowledgments</b></a>
<b> | </b>
<a href="keyhr.html"><b>List of input variables</b></a>
<b> | </b>
<a href="../tutorial/welcome.html"><b>Tutorial home page</b></a>
<b> | </b>
<a href="../users/bibliography.html"><b>Bibliography</b></a>
<hr align="left">Help files :
<a href="../users/new_user_guide.html"><b>New user's guide</b></a>
<b> | </b>
<a href="../users/abinis_help.html"><b>Abinis (main)</b></a>
<b> | </b>
<a href="../users/respfn_help.html"><b>Abinis (respfn)</b></a>
<b> | </b>
<a href="../users/mrgddb_help.html"><b>Mrgddb</b></a>
<b> | </b>
<a href="../users/anaddb_help.html"><b>Anaddb</b></a>
<b> | </b>
<a href="../users/aim_help.html"><b>AIM (Bader)</b></a>
<b> | </b>
<a href="../users/cut3d_help.html"><b>Cut3D</b></a>
<b> | </b>
<a href="../users/optic_help.html"><b>Optic</b></a>
<b> | </b>
<a href="../users/mrgscr_help.html"><b>Mrgscr</b></a>
<hr align="left">
</body>
</html>
