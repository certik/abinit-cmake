<html>
<head>
<title>Optic help file</title>
<link rel=stylesheet type="text/css" href="formabinit.css">
</head>
<body bgcolor="#ffffff">

<h1>Help file for the optic utility of the ABINIT package.</h1>

<h3>
This file explains the i/o parameters needed for the calculation of the
frequency dependent linear optical dielectric function and second order
nonlinear optical susceptibility, thanks to the Optic utility
of the ABINIT package. 
</h3>

<p> The user is advised to be familiar with
the <A href="abinis_help.html"><B>main ABINIT help file</B></A> before reading the present file. 
<p>
A knowledge of the computation of the linear response d/dk
perturbation, explained in the 
<A href="respfn_help.html"><B>ABINIT (respfn) help file</B></A>, is also requested.
Actually, a full understanding of the ABINIT treatment of perturbation (respfn) should NOT be requested
in order to use Optic, but with the present ordering of the help files and tutorial, this is not obvious.
In a future version, the tutorials and help files will be reorder and modified. 
<p>
It will be easier to discover the present file with the help of the <a "href="../tutorial/lesson_optic.html">Optic tutorial</a>.
<br>It is worthwhile to print this help file, for ease of reading.

<h5>Copyright (C) 2005-2008 ABINIT group (SS,XG)
<br> This file is distributed under the terms of the GNU General Public License, see
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br> For the initials of contributors, see ~abinit/doc/developers/contributors.txt .
</h5>

<HR ALIGN=left>
Goto :
<A href="http://www.abinit.org"><B>ABINIT home Page</B></A>
<B> | </B>
<A href="acknowledgments.html"><B>Suggested acknowledgments</B></A>
<B> | </B>
<A href="../input_variables/keyhr.html"><B>List of input variables</B></A>
<B> | </B>
<A "href="../tutorial/welcome.html"><B>Tutorial home page</B></A>
<B> | </B>
<A href="bibliography.html"><B>Bibliography</B></A>
<HR ALIGN=left>
Help files :
<A href="new_user_guide.html"><B>New user's guide</B></A>
<B> | </B>
<A href="abinis_help.html"><B>Abinis (main)</B></A>
<B> | </B>
<A href="respfn_help.html"><B>Abinis (respfn)</B></A>
<B> | </B>
<A href="mrgddb_help.html"><B>Mrgddb</B></A>
<B> | </B>
<A href="anaddb_help.html"><B>Anaddb</B></A>
<B> | </B>
<A href="aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="mrgscr_help.html"><B>Mrgscr</B></A>
<HR ALIGN=left>

<h3><b> Content of the help file.</b></h3>
<ul>
  <li><a href="optic_help.html#1">1. Introduction</a>
  <li><a href="optic_help.html#2">2. How to run optic ?</a>
  <li><a href="optic_help.html#3">3. Optic input file and input variables</a>
  <li><a href="optic_help.html#4">4. Optic output files</a>
  <li><a href="optic_help.html#5">5. Trouble shooting</a>
  <li><a href="optic_help.html#6">6. Results for GaAs</a>
</ul>

<hr>
<h3>&nbsp;</h3>

<h3><b><a name="1"></a>1. Introduction </b></h3>
Optic allows to compute the 
frequency dependent linear optical dielectric function and second order
nonlinear optical susceptibility. 
An introduction to such computations is given in the following paper :
<ul>
 <li><a name="Ref1"></a> Ref. 1 : S. Sharma and C. Ambrosch-Draxl
  Physica Scripta T109, 128 (2004) or online: 
  <a href="http://arxiv.org/abs/cond-mat/0305016">http://arxiv.org/abs/cond-mat/0305016</a>  </li>
</ul>
The following are also very useful references :
<ul>
 <li><a name="Ref2"></a> Ref. 2 : James L. P. Hughes and J. E. Sipe, Phys. Rev. B 53 10751 (1996) </li>
 <li><a name="Ref3"></a> Ref. 3 : C. Ambrosch-Draxl and J. O. Sofo,  online:
   <a href="http://arxiv.org/abs/cond-mat/0402523">http://arxiv.org/abs/cond-mat/0402523</a> </li>
 <li><a name="Ref4"></a> Ref. 4 : S. Sharma J. K. Dewhurst and C. Ambrosch-Draxl
  Phys. Rev. B 67 165332 (2003) or online: 
  <a href="http://arxiv.org/abs/cond-mat/0211512">http://arxiv.org/abs/cond-mat/0211512</a> </li>
</ul>
Before going to the detailed explanation of the Optic utility, the user
is advised to get familiar to the theory behind it, explained in these
references. So, either you know this theory and you continue the tutorial, 
or you should stop the tutorial here, and read at least <a href="optic_help.html#Ref1">Ref. 1</a>.

<p>
The specific purpose of the Optic utility is to read in the position matrix elements 
generated by ABINIT (also giving the momentum matrix elements), and then use Eq. 46 in 
<a href="optic_help.html#Ref1">Ref. 1</a>
to determine the 
linear and Eqs. 49, 50 and 51 in <a href="optic_help.html#Ref1">Ref. 1</a> to determine the nonlinear 
optical response of the material under investigation. 

<hr>

<h3><b><a name="2"></a>2. How to run Optic ? </b></h3>

<p>
The use of Optic is quite simple :
<pre>
optic < optic.files > optic.log
</pre>
where the optic.files file contains three information : the name
of the input file, the name of an output file (actually unused), and
the root name for all other output files. These input files
will be described in the next section.

<p>
However, before being able to use Optic, you must have obtained, from the main abinit program,
four different files, corresponding to the physical system that you want to study :
<ul>
 <li>The ground state wavefunction file, indexed with _WFK </li>
 <li>Three files containing the matrix elements of the position operator (or the derivative with respect to wavector), 
     one for each direction of space</li>
</ul>
Supposing you have read
the <A href="abinis_help.html"><B>main ABINIT help file</B></A>,
the production of the first file should not require any additional explanation. 
However, the way to obtain the matrix elements is worth explaining.
<br>
The long-wave method as well as the Berry-phase treatment of electric field, 
allow to establish the equivalence between
the off-diagonal matrix elements of the position operator, and the 
off-diagonal matrix elements of the derivative with respect to the wavevector (d/dk),
for the periodic part of the Bloch functions, see for example
section VI of X. Gonze, Phys. Rev. B 55, 10337 (1997), 
or Nunes and Gonze, Phys. Rev. B 63, 155107 (2001), and references therein. 
Moreover, a straightforward relationship exists between these matrix elements,
and the matrix elements of the momentum operator.
<p>
The main abinit program has
the capability to compute derivatives of wavefunctions with respect to their
wavevector. This is explained in the 
<A href="respfn_help.html"><B>ABINIT (respfn) help file</B></A>. 
Such a calculation implies treating three d/dk perturbations, with numbers 3*natom+1,
3*natom+2 and 3*natom+3 (that is, for a unit cell with 2 atoms, perturbations
number 7, 8 and 9). In the 2-atom case, the associated files needed for Optic have the
index _1WF7 , _1WF8 , and _1WF9 .
<p> The formalism implemented in Optic treats explicitely
the eigenstates lying in the range of energy between the lowest
occupied wavefunction and the highest one plus the maximal excitation energy 
(chosen by the user).
All the other ones are neglected. This has two important consequences for the
preliminary runs :
<ul>
 <li>The ground calculation must produce explicitely all the eigenstates
     and eigenvalues for that target range of energy, so it cannot be restricted to the occupied wavefunctions only</li>
 <li>One does not need the full change of Bloch wavefunctions with respect to d/dk, but only
     the matrix elements between the wavefunctions of this range of energy</li>
</ul>
Because of the latter, the computation of the response to d/dk perturbations is much
shorter than usual : indeed, the matrix elements between the explicitely ground-state
wavefunctions are computed at the very beginning of the abinis(respfn) run. It is not
worth to make a full calculation of the modification of the wavefunctions due to a change
of wavevector.

<p>
(XG050701)
HERE, I SHOULD GIVE EXPLICITELY THE SENSITIVE INPUT VARIABLES FOR ABINIT.
AND ALSO I SHOULD EXPLAIN SUBTLETIES RELATED TO THE USE OF SYMMETRIES.


<hr>


<h3><b><a name="3"></a>3. Optic input file and input variables </b></h3>

A typical optic.files file is presented below :
<pre>
optic.in     ! Name of input file
optic.out    ! Unused
optic        ! Root name for all files that will be produced
</pre>

Since very few input parameters are required for Optic, the optic.in file contains them in the 
following order which must be kept unaltered :

<pre>
abo_1WF7      ! Name of the first d/dk response wavefunction file, produced by abinit
abo_1WF8      ! Name of the second d/dk response wavefunction file, produced by abinit
abo_1WF9      ! Name of the third d/dk response wavefunction file, produced by abinit
abo_WFK       ! Name of the ground-state wavefunction file, produced by abinit
0.01          ! Value of the *smearing factor*, in Hartree
0.010   1     ! frequency *step* and *maximum* frequency (Ha)
0.000         ! *Scissor* shift if needed, in Hartree
0.001         ! *Tolerance* on closeness of singularities (in Hartree)
3             ! *Number of components* of linear optic tensor to be computed
11 33 23      ! Linear *coefficients* to be computed (x=1, y=2, z=3)
2             ! Number of components of nonlinear optic tensor to be computed
123 222       ! Non-linear coefficients to be computed
</pre>

You might use the sign ! as a delimiter for comments : the parser will ignore everything on the
same line after it.
<p>
We now describe in turn each line after the four first ones (already explained).

<hr>


<font id="title"><a name="smearing factor">Smearing factor</a></font>
<br><font id="vartype">Variable type: real parameter, given in Hartree </font>
<br><br><font id="text">
In Eq. 46 of <a href="optic_help.html#Ref1">Ref. 1</a>, it is clear that when ever wnm(k) is equal to w, 
there is a resonance. Numerically this would lead to an infinity. In order to 
avoid this one could do two things. You could change the sum over k-points to 
integration and then use linear tetrahedron method (see <a href="optic_help.html#Ref2">Ref. 2</a> for 
details). Another way to get around the problem is, like we do in the present 
case, avoid this singularity by adding a small complex number to the denominator. 
This prevents the denominator from ever going to 0 and acts as a broadening to 
the spectrum. The broadening should not be too large as this would wash out the 
features in the spectrum.
</font>
<br><br><a href=#top>Go to the top</a>
<hr>


<font id="title"><a name="frequency grid">Frequency grid : step and maximum</a></font>
<br><font id="vartype">Variable type: two real parameters, given in Hartree </font>
<br><br><font id="text">
The step and maximum sets your energy grid for the calculation using the formula
number of energy mesh points=maximum/step (zero excluded). So  in order to capture more 
features you can decrease the step size to get a finer energy grid. In order
to go to higher frequency, increase the maximum. 
</font>
<br><br><a href=#top>Go to the top</a>
<hr>


<font id="title"><a name="scissor shift">Scissors shift</a></font>
<br><font id="vartype">Variable type: real parameter, given in Hartree </font>
<br><br><font id="text">
LDA/GGA are well known to underestimate the band-gap by up to 100%. In order 
to get the optical spectrum and make a realistic comparison with experiments 
one needs to correct for this. This can be achieved in two ways. The scissors 
shift is normally chosen to be the difference between the experimental and 
theoretical band-gap and is used to shift the conduction bands only. Another 
way in which you do not have to rely on experimental data is to determine the 
self energy using the <a href="lesson_gw.html">GW approach</a>. 
In this case the opening of the gap due to the GW correction can be used as 
scissor shift.
</font>
<br><br><a href=#top>Go to the top</a>
<hr>



<font id="title"><a name="number of components">Number of components</a></font>
<br><font id="vartype">Variable type: integer </font>
<br><br><font id="text">
How many components out of 9 of the linear optical dielectric tensor do you 
want to calculate. Most of these are either equal or zero depending upon the 
symmetry of the material (for detail see <a href="optic_help.html#Ref3">Ref. 3</a>).
<br>Note that the directions are along the crystal axis.
</font>
<br><br><a href=#top>Go to the top</a>
<hr>


<font id="title"><a name="components">Components</a></font>
<br><font id="vartype">Variable type: integers (their number is given by the preceeding variable) </font>
<br><br><font id="text">
This tells which component of the dielectric tensor you want to calculate. 
These numbers are called a and b Eqs. 46 in <a href="optic_help.html#Ref1">Ref. 1</a>. 1 2 3 represent x y 
and z respectively. For example 11  would be xx and 32 would mean zy.
</font>
<br><br><a href=#top>Go to the top</a>
<hr>

<p>
The next two lines are same as the two above but for nonlinear optical susceptibility.
<br>
Remember second order non-linear optical response for materials with inversion 
symmetry is zero.

<hr>




<h3><b><a name="4"></a>4. Optic output files </b></h3>

<h4><b><a name="4.1"></a>4.1. Linear optical response data files</b></h4>
<p>
Name: case_a_b-linopt.out
<br>
Contains the following 3 data sets
<ul>
 <li>1) Column 1 - energy(eV), column 2 - imaginary part of the ab component of the 
   frequency dependent linear dielectric tensor.</li>
 <li>2) Column 1 - energy(eV), column 2 - real part of the ab component of the 
   frequency dependent linear dielectric   tensor.</li>
 <li>3) Column 1 - energy(eV), column 2 - absolute value of the ab component of the 
   frequency dependent linear dielectric tensor.</li>
</ul>
In the header of the file you can find information about the calculation. Some 
results for GaAs(LiF???) are presented in this document to show what can be 
expected.

<h4><b><a name="4.2"></a>4.2. Non-linear optical response data files</b></h4>

<p>
Name: case_a_b_c-ChiKIND1.out
<br>
KIND1:This can be TotIm, TotRe or TotAbs
<br>
Contains: column 1 - energy(eV), column 2 and 3 - imaginary (KIND1=TotIm), 
real (KIND1=TotRe) or  absolute (KIND1=TotAbs) value of the abc component of 
the nonlinear optical susceptibility. Second column contains values in 
electro-static units (esu) and third column  contains values in the SI units.
<br>

<p>
Name: case_a_b_c-ChiKIND2.out
<br>
KIND2:This can be Im, Re or abs
<br>
Contains: column 1 - energy(eV), column 2, 3 inter and column 4, 5 intra band 
contributions to the imaginary (KIND2=Im), real (KIND2=Re) or absolute 
(KIND2=Abs) value of the abc component of the nonlinear optical susceptibility. 
These components are labeled as inter and intra in Eqs. 49-51 in <a href="optic_help.html#Ref1">Ref. 1</a>.
<br>

<p>
All the values are in electro-static units (esu). In the header of all the 
above files you can find information about the calculation.

Some results of nonlinear optical spectrum for
GaAs(LiF???) are presented in this document to show what can be expected.

<hr>




<h3><b><a name="5"></a>5. Trouble shooting </b></h3>

<p>
1) All I get is zeros in my *-linopt.out file. Why?

<p>
There are several possibilities. 
<br>
Let us explore some of them here:
<ul>
 <li>(i) The component of the dielectric tensor that you are looking at could be zero 
    due to symmetry of the crystal. Normally zz component is a good place to 
    start. It is almost never zero. So check the file case__0003_0003-linopt.out.</li>
 
 <li>(ii) If the components zz is zero this is more serious, if you are using the 
     default input file t57.in then please check that  on the line number 10 
     the second number is 33. If you are not using the default input file 
     please calculate the 33 (or zz) component and make sure it is not zero.</li>
   
 <li>(iii) If even zz component is zero then possibilities are endless maximum 
      frequency on line number 6 of t57.in is too small, or the number of bands 
      used for performing ground state calculation are too small.</li>
</ul>
<p>
2) All I get is zeros in my *-ChiKIND.out file. Why?

<p>
Two most common mistakes are:
<ul>
 <li>(i) You are calculating the second order response for material with inversion 
    symmetry in this case all the components will be correctly zero or very 
    small like 10-15.</li>

 <li>(ii) Most components out of the 27 are zero due to the symmetry of the crystal. 
     Please calculate a different component.</li>
</ul>


<hr>

<h3><b><a name="6"></a>6. Results for GaAs </b></h3>

<pre>
SHOULD STILL BE DONE !
A small description of results.
excitonic effects!!!

Fig LO

Fig NLO
</pre>

For details about how to identify peaks and get information from them see 
<a href="optic_help.html#Ref4">Ref. 4</a>

<HR ALIGN=left>
Goto :
<A href="http://www.abinit.org"><B>ABINIT home Page</B></A>
<B> | </B>
<A href="acknowledgments.html"><B>Suggested acknowledgments</B></A>
<B> | </B>
<A href="../input_variables/keyhr.html"><B>List of input variables</B></A>
<B> | </B>
<A "href="../tutorial/welcome.html"><B>Tutorial home page</B></A>
<B> | </B>
<A href="bibliography.html"><B>Bibliography</B></A>
<HR ALIGN=left>
Help files :
<A href="new_user_guide.html"><B>New user's guide</B></A>
<B> | </B>
<A href="abinis_help.html"><B>Abinis (main)</B></A>
<B> | </B>
<A href="respfn_help.html"><B>Abinis (respfn)</B></A>
<B> | </B>
<A href="mrgddb_help.html"><B>Mrgddb</B></A>
<B> | </B>
<A href="anaddb_help.html"><B>Anaddb</B></A>
<B> | </B>
<A href="aim_help.html"><B>AIM (Bader)</B></A>
<B> | </B>
<A href="cut3d_help.html"><B>Cut3D</B></A>
<B> | </B>
<A href="optic_help.html"><B>Optic</B></A>
<B> | </B>
<A href="mrgscr_help.html"><B>Mrgscr</B></A>
<HR ALIGN=left>

</body>
</html>

