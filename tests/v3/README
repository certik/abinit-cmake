<html>
<head>
<title>v3 : README</title>
</head>
<body>

<h5>Copyright (C) 1997-2008 ABINIT group (XG)
<br> This file is distributed under the terms of the GNU General Public License, see
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br> For the initials of contributors, see ~abinit/doc/developers/contributors.txt .
</h5>

<pre>
This directory, v3, contains tests which 
are related to the development of ABINITv3.x
This file gives first a very brief description
of the tests, then a much longer one.

A classification of the tests is provided now. Later, each test is described
in more detail, with accompanying notes and references (some of the notes
might have to be updated, due to the small possible drift related to improvement
of the accuracy of the code).

------------------------------------------------------------------
* Tests 1 to 19 concern response-function (RF) calculations

Tests 1 and 2 are related to the computation of the stresses and
responses with spin-orbit coupling.

Tests 3 to 5 are related to Berry phase computation of polarisation
and derivative with respect to wavevector

Tests 6 test of RF with dilatmx
 
Tests 7 and 8 concerns RF for GGA with q=0

Test 9 computes the derivative of the eigenenergies
with respect to k from finite differences and analytical derivative

Tests 10 to 12 test spin-polarized RF calculation (ferromagnetic and
anti-ferromagnetic)

Tests 13 and 14 test the writing, reading and conversion 
of spinor wavefunction and the responses with spin-orbit coupling

Test 15 test spin-polarized GS and RF calculation, at varying occupation
number

Tests 16 to 18 test GGA RF : spin-polarization, non-linear core 
correction, non-zero q vectors.

Test 19 test spin-polarized GS and RF calculation, at fixed occupation
number, for atomic Fe.

------------------------------------------------------------------
* Tests 20 to 29 concern symmetry recognition and use

Test 20 test Shubnikov symmetries

Test 21 test the recognition of several enantiomorph space groups

Test 23 and 24 test the generation and recognition of the
magnetic space groups, Shubnikov type III, for triclinic, monoclinic
and cubic systems.

Tests 25 to 29 test the generation and recognition of the
space groups, from spgroup number 1 to 230.

------------------------------------------------------------------
* Tests 30 to 31 concern GW

Tests 30 and 31 are two simple tests of GW

------------------------------------------------------------------
* Tests 32 to 39 concern again symmetry recognition and use

Tests 32 to 39 test the generation and recognition of the
magnetic space groups, Shubnikov type IV.

------------------------------------------------------------------
* Tests 40 to 69 concern different topics (not yet well-ordered)

Test 40 concerns generalized constraints placed on forces

Test 41 tests standard and blocked algorithm for wf optimisation

Test 42 tests hexagonal cell optimisation

Test 43 tests boxcutmin

Test 45 tests inner eigenvalues algorithm for wf optimisation.

Test 46 tests DOS computation, using the tetrahedron method

Test 47 tests the coupling of magnetism and spin-orbit (nspinor=2,nspden=4)

Tests 48 and 49 test HCTH GGA functional

Test 50 tests 2002' SGoedecker FFT

Test 51 tests fixed magnetic moment calculation

Tests 52 and 53 test different input file format 

Tests 54 and 55 test TDDFT excitation energies, oscillator strengths,
 polarisability and Cauchy coefficients.
 
Tests 56 and 57 test Bader charge analysis

Tests 58 and 59 are for cut3d testing (wavefunction files)

Tests 60 and 61 test Hirshfeld charge analysis

Tests 62 to 67 are again for cut3d testing (wavefunction files, angular analysis)

Tests 68 to 69 are for CML testing

-----------------------------------------------------------------
* Tests 70 to 87 concern again RF

Tests 70 and 71 : different GGA functionals

Tests 72 and 73 : RF with non-zero wavevectors for GGA functionals

Tests 74 and 75 : accuracy of the finite-difference testing of RF,
  effect of symmetrisation and XC grid, and 
  warning in the case of metallic occupation numbers at Gamma

Test 76 : GGA, RF non-zero wavevector, metallic.

Test 77 : band-by-band decomposition of Born effective charge
 and localization tensor

Tests 78 and 79 : test of optical conductivity

Test 80 : examine the rotational frequency of H2 molecule

Tests 81 and 82 : GS and RF calculation, for combined local and non-local psps

Test 83 : test of non-linear features

Test 84 : rhombohedral cell of Bi

Test 85 : NiTi from MTijssens, with q= 0 0 0.1

Test 86 : spin-polarized Si from Hasegawa-san, with q= 0.5 0 0

-----------------------------------------------------------------
* Tests 87 to 89 : GW and mrgscr utility

-----------------------------------------------------------------
* Tests 90 to 95 : alchemical psps

-----------------------------------------------------------------
* Tests 96 and 97 : Lattice Wannier Functions

-----------------------------------------------------------------
* Tests 98 and 99 : parareel

***************

*Tests 100 and 102 : partial screening files and mrgscr utility


To run these tests, do the following:

0. Be sure that the perl script "run-standard-tests", in the main directory,
   has been generated from the primitive file "run-standard-tests.pl",
   thanks to the command "make perl"
   issued in ~abinit (see the installation notes on the Web).

1. Submit the "run-standard-tests" script, specifying a machine, and
   the keyword "v3" (for Tests_v3) and either
   the index of a test case, i.e.
   (run-standard-tests name_of_machine v3 22) >& log_file
   or a whole range of test cases (two indices), i.e.
   (run-standard-tests name_of_machine v3 02 08) >& log_file
   or, if you want to run all the test cases of this directory
   (run-standard-tests name_of_machine v3) >& log_file
   This will send stdout and stderr to log_file.
   The script 'run-standard-tests', will create a subdirectory of ~abinit/tests/v3,
   with the name_of_machine and the
   date, where all the results will be placed.

2. In that directory, you will find for each test case that you have
   run, a log file (with the name of the test case), an output
   file, but also a 'diff.xxx' file, automatically created by making
   a 'diff' with respect to the "Refs" subdirectory output files.
   It contains output files from a recent version of the ABINIT code.
   There may be large differences in timing but there should only
   be minor differences in the output of physical quantities.

3. There is also a global report file, generated by the use of the
   fldiff script. Its name is fldiff.report . See the last
   version of the  ~abinit/doc/install_notes/install** file
   in the Infos directory for information about the use of this file.
   This file is the most convenient for a quick look at the correctness
   of results. When the results are not correct, one has often to
   rely on the 'diff.xxx' file to understand what was going wrong.


**********

Test cases:

  1. BCC Tantalum (1 atoms per unit cell),
     using the HGH pseudopotential, within LDA.
     Fixed cell dimensions: 2 slightly different 
     cell sizes.
     Use only one k point. Test whether the stress
     is correctly given, even with spin-orbit coupling.
     Difference of total energies : 0.0000588977 Ha
     Difference of unit cell volume : 0.05861 Bohr^3
     Stress from finite difference : 1.0049 Ha/Bohr^3
     Average stress : 1.0062 Ha/Bohr^3
     Test case provided by M. Torrent and F. Jollet.

  2. Bi A7 structure (2 atoms per unit cell),
     using the HGH pseudopotential, within LDA. 
     Fixed cell dimensions. Treated as a semi-conductor
     Test the response to atomic displacements,
     with and without spin-orbit.
     Perform first computation without spin-orbit.
     Datasets 1-3 : frozen-phonon, without SO
     Datasets 4 : RF, without SO
      the comparison between frozen-phonon
      from dataset 1 and 3 (2DTE=2.35465660) 
      and RF from dataset 4(2DTE=2.35465792)
      is excellent.
     Dataset 5 : GS, with nspinor=2, but no
      spin-orbit yet.
     Dataset 6 : RF, with nspinor=2, but no
      spin-orbit yet. The agreement with 
      nspinor=1 RF is excellent.
     Dataset 7-9 : frozen-phonon with spin-orbit
     Dataset 10 : RF with spin-orbit.
      The agreement is as good as without
      spin-orbit ! Frozen-phonon 2DTE=2.48156,
      RF 2DTE=2.48156 .
     NOTE : the old t02.in file, which was giving
     troubles in v3.1.2 is now called t02a.in

  3. Zinc-blende GaAs (2 atoms per unit cell),
     using HGH psps. 
     Test the computation of the Berry phase.
     Grid sampling is very rough, for speed.
     8 dataset, testing all combinations of
     location of wfs (memory or disk), spin polarisation,
     use (or non-use) of time-reversal symmetry. 
     Test case provided by M. Veithen
    

  4. Zinc-blende GaAs (2 atoms per unit cell),
     using old, rather inaccurate psps.
     Computation of the Berry phase.
     Test the doubling of the step of the sampling. 
     ngkpt 20 4 4 (shiftk 0 0 0)
      kberry 1 0 0  electronic phase (1): -2.3993E-3
      kberry 2 0 0  electronic phase (2): -1.4425E-3
     ngkpt 10 4 4 (shiftk 0 0 0)
      kberry 1 0 0  electronic phase (3): -1.3753E-3 
     ngkpt 10 4 4 (shiftk 0.5 0 0)
      kberry 1 0 0  electronic phase (4): -1.5096E-3
     Note that (2) is the mean of (3) and (4),
     as it should ...
     Test case provided by M. Veithen


  5. Si diamond. Usual geometry, psps. Low ecut (3 Ha)
     With a 4x4x4 k point grid (!only one shift, but OK
     because symmetry is imposed), compute the
     dielectric constant by two different techniques :
     the d/dk operator is either applied thanks to RF
     methodology or thanks to Berry phase finite-difference.
     At very good k-sampling, the two techniques 
     converge to the same result, but 4x4x4 is definitely
     NOT enough:
                   Berry phase      RF
     4x4x4         9.0775           14.3269   
     6x6x6        10.1004           12.5502   
     8x8x8        10.6532           11.9872   
     10x10x10     11.0067           11.8010   
     12x12x12     11.2275           11.7275   
     16x16x16     11.4832           11.7082   
     Remark that the convergence of the RF results
     is much better : about 1% is achieved with a 10x10x10 grid

     WARNING WARNING WARNING : the output of this test, for
     dataset 5, changed at v3.1.3g, because of the change
     v3.1.3g.6, in fxphas.f . This was likely due to 
     lack of good convergence in the ground state,
     so that mixing of degenerate vectors influence
     the final result ! 
     In particular, the value obtained for 4x4x4 by
     the Berry phase in 3.1.3g is  : 9.3597, instead of 9.0775 .
     Furthermore, this value is lacking portability.
     For v3.2, the accuracy of the calculation
     was improved a lot, and the reference value is 9.3590 . 
     More tests are needed to investigate this effect.
   

  6. Linear chain of Ge2 molecules (2 atoms per unit cell),
     using a local (Starkloff-Joannopoulos) pseudopotential,
     and no exchange-correlation (ixc=0). Uses 4 k-points.
     Computation of the second derivative of the total energy
     with respect to a atomic displacement along the chain,
     with q(0 0 0) wavevector. Similar to test v2 #1, except
     that it uses dilatmx=1.1 .

  7. H2 molecule, using a local pseudopotential, and GGA.
     Similar to test 33 of v2.
     Use the x-only PBE functional.
     Compute the interatomic force constant for the
     displacement of the second atom along x.
     RF calculation of the 2DTE gives 189.10691 Ha
     while finite differences gives :
     with delta(xred)=0.0002, 189.10790 Ha
     with delta(xred)=0.0001, 189.10703 Ha .
     Combining the results gives 189.10675 Ha. The
     agreement is quite good, and might likely be improved
     by increasing tolvrs.

  8. H2 molecule, using a local pseudopotential, and GGA.
     Similar to test 33 of v2, and preceeding test,
     but use the full XC PBE functional.
     Also, tolvrs is better.
     Compute the interatomic force constant for the
     displacement of the second atom along x.
     RF calculation of the 2DTE gives 188.81162533 Ha
     while finite differences gives :
     with delta(xred)=0.0002, 188.81213804 Ha
     with delta(xred)=0.0001, 188.81175352 Ha .
     Combining the results gives 188.81162525 Ha. 

  9. FCC Yb (1 atom per unit cell),
     using a l=3 psp with s local part.
     Crazy cut-off and number of k points.
     Shows that the derivative of the eigenenergies
     with respect to the wavevector can be obtained
     both by finite differences and analytical means
     (from a preliminary computation in the
     treatment of the ddk perturbation).
     For the (0.25,0.25,0.25) k point,
     the tenth band eigenvalue is -3.01209 eV.
     Going to the (0.251,0.251,0.251) k point
     it becomes -3.00562 eV, with finite-difference
     estimation of the derivative with respect
     to ONE wavevector change (all three
     components changed) being 0.00647 eV/0.001/3=2.157 eV
     This value is unchanged when using the
     data at the (0.253,0.253,0.253) k point.
     The analytical value is 2.15566 eV.

 10. Si2 diatomic molecule. Spin-polarized (ferromagnetic).
     Test phonon RF for spin-polarized case.
     ixc=1 (Teter LSDA)
     From dataset 2 and 3, one gets the derivatives
     with respect to the atomic displacement along x.
     The simple finite-difference formula gives the
     2DTE 10.88934274 Ha, while the direct computation,
     in dataset 4 gives 10.88933963 Ha .

 11. Si2 diatomic molecule. Spin-polarized (ferromagnetic).
     Test phonon RF for spin-polarized case.
     ixc=7 (Perdew-Wang 92 LSDA)
     From dataset 2 and 3, one gets the derivatives
     with respect to the atomic displacement along x.
     The simple finite-difference formula gives the
     2DTE 10.88283478 Ha, while the direct computation,
     in dataset 4 gives 10.882832 Ha .

 12. H2 diatomic molecule. Spin-polarized (anti-ferromagnetic).
     Test phonon RF for spin-polarized case.
     ixc=1 (Teter LSDA)
     From datasets 3 and 4, one gets the derivatives
     with respect to the atomic displacement along x.
     The simple finite-difference formula gives the
     2DTE 6.283100652 Ha, while the direct computation,
     without using Shubnikov symmetries, gives
     6.282967527 Ha.

 13. Bi A7 structure (2 atoms per unit cell),
     using the HGH pseudopotential, within LDA.
     Fixed cell dimensions. Treated as a semi-conductor
     First dataset : compute the density
     Second dataset : compute the spinor wfs at one k point, 
     non-self consistently 
     Third dataset : use the spinor wfs of the previous dataset 
     to restart computations at symmetric k points.

 14. Bi A7 structure (2 atoms per unit cell),
     using the HGH pseudopotential, within LDA.
     Fixed cell dimensions. Treated as a semi-conductor
     Test the response to atomic displacements,
     with spin-orbit. Should give the same answer
     than test 2, except that the k point grid is now
     defined automatically.
     Dataset 8 : frozen-phonon with spin-orbit
     Dataset 10 : RF with spin-orbit.
      The agreement is as good as without
      spin-orbit ! Frozen-phonon 2DTE=2.48156,
      RF 2DTE=2.48156 .
     Warning : the output file of this test 
     is machine-dependent, although the final
     result is not. This is because the
     degeneracy of the GS wavefunctions with
     different spin orientation has not been broken.

 15. Fe FCC, spin-polarized (ferro), with only the Gamma point.
     Test spin-polarized GS and RF calculation, at varying occupation
     number (occopt=4). Check acoustic sum rule.

 16. Si crystal
     GGA + non-linear XC core correction.
     Compute the interatomic force constant for the
     displacement of the second atom along (111).
     RF calculation of the 2DTE gives 7.51663417 Ha
     while finite differences gives :
     with delta(xred)=0.0001, 7.15663267 Ha .
     The agreement is quite good, and might likely be improved
     by combining finite differences.
     Also compute the ddk and electric field responses.
     The number of k points is much too small to 
     obtain physical values, but are quite
     comparable to the result of test v2 #6

 17. Si2 diatomic molecule. Spin-polarized (ferromagnetic).
     Test phonon RF for spin-polarized case.
     ixc=11 (PBE GGA)
     From dataset 2 and 3, one gets the derivatives
     with respect to the atomic displacement along x.
     The simple finite-difference formula gives the
     2DTE 10.56548267 Ha, while the direct computation,
     in dataset 4 gives 10.565831 Ha .
     The difference is quite small, but does NOT go away
     when a better finite-difference formula is used.
     TO BE EXAMINED ...

 18. Orthorhombic Al system, q(1/2 0 0), partial occupation numbers.
     Compares with frozen-phonon calculations. 
     Similar to test v2 #11, except use of PBE GGA.
     Examine two cases:
     varying occupation numbers, and fixed occupation numbers.
     A. Varying occupation numbers (occopt=4):
        RF calculation in dataset 5 gives
        2DE equal to -4.053115 Ha, while finite difference of "TOTAL"
        energy (datasets 6 and 7, including entropy term) gives -4.0475002 Ha.
        This is fair, BUT it does not improve with a better
        finite-difference, so there is a problem.
     B. Fixed occupation numbers (occopt=2):
        RF calculation in dataset 8 gives
        2DE equal to +5.394365 Ha, while finite difference of total
        energy (no entropy term is present with occopt=2) gives +5.3998556 Ha
        This is fair, BUT it does not improve with a better
        finite-difference, so there is a problem.
        Then, in dataset 11, compute phonon frequencies at Gamma
        of the doubled cell. The 2DTE is 10.7997781 Ha, which
        corresponds to 5.3998890 Ha, so in much better agreement
        with the frozen-phonon calculation.
     TO BE UNDERSTOOD ...

 19. Fe, one atom in a big box.
     Test spin-polarized GS and RF calculation, at fixed occupation
     number. Check acoustic sum rule.
     The ecut is 18 Hartree. It seems quite low, but gives
     phonon frequency of 3.83i cm-1, which is quite small,
     while increasing it to 22 Ha or 26 Ha, respectively,
     gives 4.73i cm-1 and 1.32i cm-1, respectively.

 20. H diatomic molecule in the antiferromagnetic regime. 
     Different data sets.
     Test Shubnikov symmetries.

 21. H based fake crystals.
     Test the recognition of several enantiomorph space groups :
     76, 151, 152, 178 and 180.

 23. H based fake crystals : magnetic groups, Shubnikov type III
     Test the generation and recognition of the
     triclinic and monoclinic space groups

 24. H based fake crystals : magnetic groups, Shubnikov type III
     Test the generation and recognition of the
     cubic space groups

 25. H based fake crystals.
     Test the generation and recognition of the
     triclinic and monoclinic space groups, from
     spgroup 1 to 15.

 26. H based fake crystals.
     Test the generation and recognition of the
     orthorhombic space groups, from
     spgroup 16 to 74.

 27. H based fake crystals.
     Test the generation and recognition of the
     tetragonal space groups, from
     spgroup 75 to 142.

 28. H based fake crystals.
     Test the generation and recognition of the
     trigonal and hexagonal space groups, from
     spgroup 143 to 194.

 29. H based fake crystals.
     Test the generation and recognition of the
     cubic space groups, from
     spgroup 195 to 230.

 30. Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
     In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16), then
     perfoms a full diagonalisation of the Hamiltonian (nbandkss -1; npwkss 0),
     the eigenvectors necessary for the GW calculation being stored in _KSS.
     In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3; npweps 27;
     npwwfn 27; nband 10) for the GW calculation and stores it in _EM1.
     In dataset 3, ABINIT computes the GW correction for bands 4 and 5
     (optdriver 4; npwsigx 27; npwwfn 27; nband 10)
     [rem: Convergence would be obtained for (npwsigx 169; npwwfn 169;
           npwesp 169; nband 80)]

 31. SiC in zinc-blende structure (nkpt 2; ecut 6)
     In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16), then
     perfoms a full diagonalisation of the Hamiltonian (nbandkss -1; npwkss 0),
     the eigenvectors necessary for the GW calculation being stored in _KSS.
     In dataset 2, ABINIT computes the eps^-1 matrix (optdriver 3; npweps 27;
     npwwfn 27; nband 10) for the GW calculation and stores it in _EM1.
     In dataset 3, ABINIT computes the GW correction for bands 4 and 5
     (optdriver 4; npwsigx 27; npwwfn 27; nband 10)

 32. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
     triclinic and monoclinic space groups

 33. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
     orthorhombic space groups (part I)

 34. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
     orthorhombic space groups (part II)

 35. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
    Iorthorhombic space groups (part III)

 36. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
     tetragonal space groups (part I)

 37. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
     tetragonal space groups (part II)

 38. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
     trigonal and hexagonal space groups

 39. H based fake crystals : magnetic groups, Shubnikov type IV
     Test the generation and recognition of the
     cubic space groups

 40. 8 atoms of Si in an elongated box.
     4 of them are fixed, while atoms 5 and 6
     and 7 and 8 are grouped by pair, such as
     the sum of their relative separations along y is
     constrained to 8.0 .
     This is a crazy constraint, just to show
     that it can be done !
     Test case provided by S. Erwin

 41. Si diamond. Usual geometry, k points, psps.
     Test the standard and blocked algorithms
     for the wavefunction optimisation.

 42. Magnesium HCP.
     Optimize the cell volume and shape
     using different constraints.
     Checks whether the stresses are symmetric,
     and whether the optimisation algorithm does
     not break the symmetry.

 45. 8 Silicon atoms + 1 interstitial Mg atom.
     Try to get the inner bands (close to the Fermi energy),
     not the lower ones, thanks to wfoptalg=2.
     It works, but it does not seem very efficient.
     Still subject of study.

 46. 2 Silicon atoms, in a diamond structure.
     Test the computation of the DOS, using the linear 
     tetrahedron method.

 47. Fe2 dimer in a big box, treated with non-collinear magnetism.
     First dataset is the metallic treatment, second dataset 
     is a fixed occupation number treatment. Dataset 3 to 5 start from 
     other initial magnetization direction 
     Only 5 or 2 steps. The run is not invariant
     against changing the initial magnetization direction.
     If the wavefunctions were completely optimized in the 
     first fixed potential, the run should be invariant ...
     Contributed by GZerah.

 48. H2 molecule, using a local pseudopotential, 
     and the HTCH GGA.
     Compute the total energy and force as a 
     displacement of the second atom along x.
     Direct calculation of the gradient with respect
     to reduced coordinates gives -2.927435141005 Ha
     while finite differences gives :
     with delta(xred)=0.0002, -2.9274480325 Ha
     with delta(xred)=0.0001, -2.9274332229 Ha .
     Combining the results gives -2.9274351408 Ha.
     Excellent.

 49. Si2 diatomic molecule. Spin-polarized (ferromagnetic).
     Test the HTCH GGA functional.
     Direct calculation of the gradient with respect
     to reduced coordinates gives  0.244706637148 Ha
     while finite differences gives :
     with delta(xred)=0.002, -0.2447071033 Ha     
     Better finite-difference estimation leads to better agreement.

 50. Mg atom, in a big box, displaced from the center,
     test different k points with time-reversal symmetry, and different
     fftalg values (4xx) corresponding to the 2002 FFT of SGoedecker.

 51. Fe BCC crystal.
     Constraint the magnetic moment, using the input
     variable fixmom.

 52. Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
     Same as test v1 #1, except use different energy and length units.     
     Test the use of dimensional input variables.

 53. O2 molecule, treated like a metal (there is a degeneracy at the
     Fermi level), occopt=4 and tsmear=0.04 , with nsppol=2 .
     Use spinat to polarize the molecule at start.
     Same as test v1 #8, except use different energy and length units.
     Test the use of dimensional and logical input
     variables.

 54. (HeH)+ in a big box. Computation of oscillator strengths,
     in the TDxOEP/xOEP approximation. Use a different geometry
     than in test 42 of test/v2.
     The Thomas-Reiche-Kuhn sum rule (sum of oscillator strengths
     should be the number of electrons, that is, two in this case)
     should be valid, since
     we are using local pseudopotentials. However, the number
     of bands needed to get it is huge :
     nbands     sum rule
     20         1.34   (present case)
     30         1.45
     40         1.61
     60         1.68
     80         1.74
     100        1.77
     120        1.82
     160        1.88
     200        1.90
     240        1.92

 55. N2 molecule non-spin-polarized, in a big box.
     Compute excitation energies, as well as Cauchy
     coefficients. The Cauchy (-2) coefficient
     is the low-frequency optical polarisability.
     The present test uses a small box (6x5x5 Angstrom),
     a small energy cut-off (25 Ha), and only
     12 states. Two different exchange-correlation
     functionals are treated : ixc=1 (Teter93),
     and ixc=7 (PW92).
     Experimental values are taken from Goerling at al,
     J. Chem. Phys. 110, 2785 (1999)).

     Experimental values for the singlet excitation
     energies are :
     1pi_g 9.31eV  1sig_u- 9.92eV  1del_u 10.27eV
     The present test gives
     1pi_g 9.47eV  1sig_u- 9.91eV  1del_u 10.45eV
     With a larger box (8x7x7) 
     1pi_g 9.33eV  1sig_u- 9.84eV  1del_u 10.38eV
     With a larger cutoff (60Ha)
     1pi_g 9.38eV  1sig_u- 9.77eV  1del_u 10.31eV
     With a larger number of states (30)
     1pi_g 9.44eV  1sig_u- 9.91eV  1del_u 10.45eV

     Experimental values for the Cauchy coefficients are:
     (These values should be updated, the real ones
      are smaller by a few percent, because a
      buffer has been introduced in tddft.f)
     (-2) 11.74au, (-4) 30.11au, (-6) 101.8au
     The present test gives
     (-2) 8.012au, (-4) 27.83au, (-6) 108.4au
     With a larger box (8x7x7)
     (-2) 7.112au, (-4) 25.51au, (-6) 102.2au
     With a larger cutoff (60Ha)
     (-2) 7.717au, (-4) 26.87au, (-6) 104.6au
     With a larger number of states (30)
     (-2) 11.70au, (-4) 34.56au, (-6) 123.3au
     (The larger number of states is important to give
      reasonable values ...)

     Experimental values for the triplet excitation
     energies are :
     3pi_g 7.75eV  3sig_u+ 8.04eV  3del_u 8.88eV 3sig_u- 9.67eV 3pi_u 11.19eV
     The present test gives
     3pi_g 7.83eV  3sig_u+ 8.11eV  3del_u 9.06eV 3sig_u- 9.91eV 3pi_u 10.91eV
     With a larger box (8x7x7)
     3pi_g 7.70eV  3sig_u+ 8.13eV  3del_u 9.04eV 3sig_u- 9.85eV 3pi_u 10.71eV
     With a larger cutoff (60Ha)
     3pi_g 7.73eV  3sig_u+ 7.88eV  3del_u 8.88eV 3sig_u- 9.77eV 3pi_u 10.44eV
     With a larger number of states (30)
     3pi_g 7.83eV  3sig_u+ 8.04eV  3del_u 9.04eV 3sig_u- 9.91eV 3pi_u 10.90eV

     Note that the use of the PW92 functional instead of the
     Teter93 functional does not affect the singlet values,
     but have some effects on the triplet values:
     they change from 
     3pi_g 7.83eV  3sig_u+ 8.11eV  3del_u 9.06eV 3sig_u- 9.91eV 3pi_u 10.91eV
     to    
     3pi_g 7.85eV  3sig_u+ 8.16eV  3del_u 9.08eV 3sig_u- 9.91eV 3pi_u 10.93eV
     In the Goerling paper, still another functional was used,
     the Vosko-Wilk-Nussair one,
     whose spin dependence is not very accurate, hence the large
     differences for the triplet states.
     When this functional will be coded in ABINIT, it will be 
     worth to complete the present test.

 56. MgO FCC crystal, with low cut-off, and 32 k points.
     Pseudopotentials WITHOUT a non-linear core correction.
     Prepare the Bader density analysis

 57. MgO FCC crystal, Bader analysis.
     Examine the Oxygen atom only. 
     Determine correctly 18 bonding critical points,
     24 ring critical points, and 8 cage critical points.
     (In agreement with Euler's relation : #BCP-#RCP+#CCP=2)
     The bonding critical points are quite accurate,
     while for the ring critical points, the criteria
     defined by the input variables lstep and lgrad are not fulfilled
     for all the CP. The coordinates are rather inaccurate.
     In particular, the symmetry between RCP is broken.
     This is seen the most clearly at the level of the
     laplacian eigenvalues. This breaking of symmetry
     naturally originates from the fact that the FFT grid
     is not symmetric (the lattice was chosen primitive FCC), 
     so that the finite elements used for the
     interpolation are also not symmetric.
     This cannot be improved by just tuning the numerical
     parameters. Instead, one should consider the Bader
     analysis in a FCC conventional cell, instead of the
     primitive one.
     
     Get 2 core electrons, 7.6796 valence electrons.
     The nucleus charge is +8. The Oxygen atom-in-molecule
     has a net charge of -1.6796. 

 58. Diamond Si in an orthorhombic cell, in preparation
     of cut3d analysis, see test 59.
     (Contributed by Jean-Francois Briere)

 59. Analysis of the output WF of the preceeding test
     by cut3d : output the wavefunction for
     second k point, third band.
     (Contributed by Jean-Francois Briere)

 60. NaCl FCC crystal, with low cut-off, and 32 k points.
     Prepare the Hirshfeld density analysis.

 61. NaCl FCC crystal. Perform Hirshfeld analysis
     of the density file generated by test 60.

 62. Si diamond. Usual geometry, psps. Low ecut (3 Ha)
     With a 4x4x4 k point grid (!only one shift, but OK
     because symmetry is imposed). Then, non-self-consistent
     calculation for k points that have special 
     istwfk values, for further analysis by cut3d in the
     next tests. 

 63. Analysis of the output WF of the preceeding test
     by cut3d : output the wavefunction for
     (0 0 0), 1st band

 64. Analysis of the output WF of the preceeding test
     by cut3d : output the wavefunction for
     (1/2 0 0), 2nd band

 65. One aluminum atom in a big box.
     For further analysis by cut3d in the
     next tests.

 66. Analysis of the output WFs of the preceeding test
     by cut3d : angular analysis. istwfk=1

 67. Analysis of the output WFs of the test#66
     by cut3d : angular analysis. istwfk/=1

 68. Slab of Mo (see test v1 #41) 
     Test the reading of a CML file 

 69. Dataset 1 : C supercell with a vacancy
     Dataset 2 : Si surface + water molecules (see test v1 #42)
     Test the reading of two CML files

 70. H2 molecule, using a local pseudopotential, and GGA.
     Similar to test 8 of v3
     but use the revPBE XC functional.
     Compute the interatomic force constant for the
     displacement of the second atom along x.
     RF calculation of the 2DTE gives 188.66748730880 Ha
     while finite differences gives :
     with delta(xred)=0.0002, 188.66799915 Ha
     with delta(xred)=0.0001, 188.66761529 Ha .
     Combining the results gives 188.66748734 Ha.
     Excellent.

 71. H2 molecule, using a local pseudopotential, and GGA.
     Similar to test 8 of v3
     but use the RPBE XC functional.
     Compute the interatomic force constant for the
     displacement of the second atom along x.
     RF calculation of the 2DTE gives 188.92567363225 Ha
     while finite differences gives :
     with delta(xred)=0.0002, 188.92618485 Ha
     with delta(xred)=0.0001, 188.92580145 Ha
     Combining the results gives 188.92567365 Ha
     Excellent

 72. H, compressed simple cubic, to test accurately RF in the GGA
     with non-zero q. Similar to Tv2#90, except for GGA.
     No linear XC core correction.
     The total energy of the 1-atom cell is -0.56144810109 Ha
     The 2DTE with respect to a q(0 0 0) phonon is 4.3E-6 .
     The 2DTE with respect to a transverse q(1/2 0 0) phonon
     is  2.076817E-02 . The 2DTE with respect to a transverse
     q(1/4 0 0) phonon is 1.105266E-02.

 73. H, compressed simple cubic, frozen-phonon calculations corresponding
     to test 72. No linear XC core correction.
     The total energy of the quadruple cell is -2.2457924013451 Ha,
     in excellent agreement with the result of test 72.
     The frozen-phonon (from forces) calculation of the 2DTE for the q(1/2 0 0)
     case gives 2.0769790d-2 . A better finite-difference scheme, using
     a doubled displacement to cancel the finite-difference error, gives
     2.076834d-2.
     The frozen-phonon (from forces) calculation of the 2DTE for the q(1/4 0 0)
     case gives 1.105321d-2 . A better finite-difference scheme, using
     a doubled displacement to cancel the finite-difference error, gives
     1.105275d-2 .

 74. O2 (nsppol=1, non-linear XC core correction, LDA)
     Fixed occupation numbers
     This is to demonstrate a subtlety of the analysis of
     finite differences : the effect of the symmetrization.
     In dataset 1-3, one computes the total energy and forces,
     with automatic computation of symmetries, including
     symmetrization of the forces (or reduced gradients).
     The reduced gradients with respect to displacements
     of the first atom along z in datasets 1 and 3 are
     -5.705435136802 Ha and -5.692472863816 Ha, giving
     the 2DTE of 129.62 Ha. 
     In dataset 4, the RF 2DTE is computed, and the agreement with
     finite-differences of datasets 1 and 3 is quite bad: 
     127.90998027 Ha, 1.5% error !
     However, the agreement with the finite differences
     of forces in datasets 5 and 6 (-5.705349696912 Ha
     and -5.692558689744 Ha), where the symmetrization
     of forces is not done, is excellent : the finite-difference
     gives 127.91007168 Ha, less than 0.0001 Ha error.
     Explanation : forces in the geometry of datasets 1,3,5 and 6
     are not really symmetric, because of the underlying FFT grid,
     used for the evaluation of the XC functional !
     This can be seen in the fulfillment of the acoustic sum rule.
     With the present low-cutoff, the frequency of the acoustic mode
     is 264i cm-1, a strong breaking of the sum rule. With 20Ha,
     the frequency is 43.18 cm-1, much better. 
     Other values : 25 Ha, 19.03i cm-1, 
                    30 Ha, 21.02i cm-1, 
                    35 Ha, 20.14i cm-1,
                    50 Ha,  3.57  cm-1
     Note the (misleading) plateau between 25 Ha and 35 Ha : 
     the convergence towards 0 cm-1 start again only beyond 35 Ha.
     The influence of the FFT grid depends strongly on the pseudopotential.

 75. O2 (nsppol=1, non-linear XC core correction, LDA)
     Metallic occupation numbers.
     For metallic occupation numbers,
     RF computation of 2DTE at Gamma, when taking
     Fermi energy changes (frzfermi=0), will give the same
     answer than finite-difference of GS computations.
     However, prior to v4.4, the change of Fermi energy
     due to the perturbation was not computed.
     This corresponds to calculations performed with frzfermi=1
     (should be used only for testing purposes).
     In dataset 1-3, one computes the total energy and forces,
     without symmetries, as it should be
     for accurate finite-difference tests.
     The reduced gradients with respect to displacements
     of the first atom along z in datasets 1 and 3 are
     -5.705344113253 Ha and -5.692553418498 Ha, giving
     the 2DTE of 127.90 Ha.
     In dataset 4, RF is computed with the Fermi energy correction, 
     and the agreement with finite-differences of datasets 1 and 3 
     is good : one gets 127.9068 Ha .
     In dataset 5, RF is computed with frozen Fermi energy
     and the disagreement with
     finite-differences of datasets 1 and 3 is large:
     one gets 100.9991668 Ha .

 76. Al2 molecule in a big box. Treat 8 bands, occupied using occopt=4.
     Similar to test 36 of v2, except use PBE GGA.
     For a metallic occopt, the frozen-phonon (finite-difference) approach
     is strictly equivalent to the RF approach only at q/=Gamma.
     Here, computes the result at q=(0 0 1/2).
     With delta(xred)=0.0001 (DATASET 5), one gets
     delta(etot)/delta(xred)=0.41050702 .
     The direct computation of 2DTE at the target geometry
     gives 0.410506 .

 77. BaO crystal.
     Computation of band-by-band decomposition of Born effective charges.
     Also, computation of the electronic localization tensor,
     and its band-by-band decomposition.
     (Test contributed by Marek Veithen)

 78. Aluminum FCC. Only one k point.
     Preparation of the conductivity test number 79.
     Of course, 1 k point is much to small to allow
     to get the correct conductivity, but it is for
     testing purposes only.
     (Test contributed by Vanina Recoules)

 79. Aluminum FCC : test the conductivity.
     (Test contributed by Vanina Recoules)
     Only for testing purposes : no physical meaning !!

 80. H2 molecule : examine the rotational freedom.
     The present test produces the following 
     vibrational frequencies (with degeneracies indicated):
     56.89 i cm-1 (2)
      0.41   cm-1 (2)
      1.05   cm-1
     3800    cm-1 
     The large frequency corresponds to the stretching
     mode, and has the right order of magnitude.
     The frequencies close to 1 cm-1 corresponds
     to translation modes, and are small enough
     for usual applications.
     The  56.89 i cm-1 mode corresponds to rotation of 
     the H2 molecule. The magnitude of this
     frequency might seem quite
     large. Here are the results of tests made to understand
     this phenomenon. First, note that  
     ecut 12  acell 3*14
     Increasing the value of ecut to 25 decreases
     the magnitude of the frequency to 36.8 cm-1 .
     However, in order to continue to make it smaller,
     the cell size must be increased , and an oscillatory
     behaviour is observed :
     3*16   45.6 i cm-1
     3*18   22.7   cm-1
     3*20   19.1 i cm-1
     3*22   15.7 i cm-1
     3*24   13.7   cm-1
     Many other tests have been set up. In particular,
     it was observed that the frequency of the oscillatory
     behaviour changes with the ecut, and also that 
     using the Gamma point, instead of the 1/4 1/4 1/4 k point
     (used in this test) degrades the convergence.
     The overall picture is as follows.
     There are different reasons for the translation
     and rotation modes to acquire a non-zero frequency
     when plane waves and supercells are used.
     Still, as concerns translations, only the
     existence of a discretization of the XC grid
     is important. For rotations, supercell effects
     are also present :
     - alignement of dipole or quadrupoles
     - interaction between tails of wavefunctions, accross cells
     Since the convergence in supercell size is oscillatory, we infer
     that the breaking of the rotational invariance is mostly 
     due to interaction between wavefunction tails.
     This will be checked by confining the system in a spherical
     well, in a forthcoming test.

 81. Ice VIII (H2O centered tetragonal), with only the Gamma point, and a
     low ecut, and small number of steps. Test GS and RF (only one perturbation).
     This is to check that local and non-local (so, varying number
     of projectors) psps can be merged (contributed by DKlug) LDA

 82. Ice VIII (H2O centered tetragonal), with only the Gamma point, and a
     low ecut, and small number of steps. Test GS and RF (only one perturbation).
     This is to check that local and non-local (so, varying number
     of projectors) psps can be merged (contributed by DKlug) 
     Same as test 81, except GGA.

 83. AlAs (zinc-blende structure).      
     Compute different response functions, then
     perform a computation of 3rd derivative of total energy.
     (to be described in more detail)

 84. Bi A7 structure (2 atoms per unit cell),
     using the HGH pseudopotential, within LDA.
     Fixed cell dimensions. Treated as a semi-conductor
     Test the response to atomic displacements,
     and electric field, without spin-orbit.
     Check the invariance with respect to 
     cartesian coordinates.

     Datasets 1-3 : GS, ddk, phonon+ elfd
     with the trigonal axis aligned with z
     Datasets 4-6 : GS, ddk, phonon+ elfd
     with the trigonal axis aligned with (111)

     In v3.3 and previous, there was an error of sign
     in cart29.f, for the off-diagonal elements of the dielectric
     tensor. The present dielectric tensor gives
     (z dir)    perp     5.998365  parallel  5.606745
     (111 dir)  diagonal 5.867825  off-diag -0.130540
     This is coherent : perp=diagonal-off-diag
                        para=diagonal+2*off-diag

 85. NiTi simple cubic (RockSalt), from MTijssens.
     Metallic. Different mems are zero.
     The second perturbation does not converge well !
     Should be improved.

 86. Si diamond
     Spin-polarized calculation (nspden=2)
     RF phonon with q=0.5 0 0
     Contributed by Hasegawa-san

 87. Test on splitting screening calculation using nqptdm and qptdm
     Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
     In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16), then
     perfoms a full diagonalisation of the Hamiltonian (nbandkss -1; npwkss 0),
     the eigenvectors necessary for the GW calculation being stored in _KSS.
     In datasets 2-4, ABINIT computes the eps^-1 matrix (optdriver 3; npweps 27;
     npwwfn 27; nband 10) for 1 qpt , 2 qpts, 3qpts respectively

 88. Test of mrgscr utility
     Merging the screening files already generated in the test 87 in a single file.
     Contributed by R. Shaltaf

 89. Test of mrgscr utility
     mrgscr is used here to check the status of screening file (from test 88), 
     what is there and what is needed. 
     Contributed by R. Shaltaf

 90. Linear chain of X2 molecules (2 atoms per unit cell),
     using alchemical atoms (well, with no mixing, just for a test)
     Computation of the second derivative of the total energy
     with respect to a atomic displacement perpendicular to
     the chain, with q(0 0 1/2) wavevector.
     The first psp is Si, the second one is Ge, but the
     mixing coefficients are 1.0 and 0.0 .
     See test 4 of v2, except with alchemy.

 91. Linear chain of X2 molecules (2 atoms per unit cell),
     using alchemical atoms, GS only.
     The first psp is Ge, the second one is Si, but the
     mixing coefficients are 0.0 and 1.0 .
     See previous test, except GS only, and the two atoms are switched.

 92. Linear chain of X2 molecules (2 atoms per unit cell),
     using alchemical atoms, GS only.
     The first psp is Si, the second one is Si, the
     mixing coefficients are 0.2 and 0.8 , then, in a second
     dataset, they are 0.5 and 0.5 .
     Should give same numerical results as the previous test.

 93. Linear chain of X2 molecules (2 atoms per unit cell),
     using alchemical atoms, GS only.
     The first psp is Si, the second one is Ge, the
     mixing coefficients are 0.2 and 0.8, then
     0.5 and 0.5 , then 0.001 and 0.999 .

 94. Linear chain of X2 molecules (2 atoms per unit cell),
     using alchemical atoms, GS only. 
     The first psp is Si, the second one is Ge, the
     mixing coefficients are 0.5 and 0.5 . The 
     pseudopotentials differ from the ones of test #93 .

 95. Fake MoSixO(1-x) molecule along the diagonal of a cube,
     using alchemical pseudopotentials.
     Si and O are not isovalent, so might not be 
     physically meaningful.
     4 pairs of mixing coefficients are studied, including
     one for which the occupation numbers becomes fractionary.

 96. Lattice Wannier Function test, to be described by Razvan Caracas

 97. Lattice Wannier Function test, to be described by Razvan Caracas
     
 98. Test the parareel algorithm (to be documented)

 99. Test the parareel algorithm (to be documented)

100. Test on splitting screening calculation using nqptdm and qptdm
     Si in 2-atom diamond unit cell (nkpt 2; ecut 6)
     In dataset 1, ABINIT finds the ground state (tolwfr 1.0d-16), then
     perfoms a full diagonalisation of the Hamiltonian (nbandkss -1; npwkss 0),
     the eigenvectors necessary for the GW calculation being stored in _KSS.
     In datasets 2-4, ABINIT computes the eps^-1 matrix (optdriver 3; npweps 27;
     npwwfn 27; nband 10) for 1 qpt , 2 qpts, 3qpts respectively 

101. Test on mrgscr utility
     merging the screening files already generated in the last test (t100.in) in 
     a single file 
     the report will be written in the log file
     
102. Test on mrgscr utility
     mrgscr is used here to check the status of screening file, what is there and what is needed..
     the report will be written in the log file.
						   
</pre>
