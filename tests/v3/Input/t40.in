# test of constrained (i.e. projected) forces - two molecules in a box, with the
# sum of their relative separations constrained to 8.0
# Test prepared by Steve Erwin

 prtvol 10 # tells 'constr.f' to write forces and projected forces 

# "molecule A" is atom5+atom6, with separation initially 4.0
# "molecule B" is atom7+atom8, with separation initially 4.0
 natom 8 natfix 4 iatfix 1 2 3 4
 xcart 
 0 10.0 0
 0 13.0 0
 0 16.0 0
 0 19.0 0
 0 -6.0 0
 0 -2.0 0
 0  6.5 0
 0  2.5 0

 nconeq  1                               # one constraint equation
 natcon  4                               # four atoms are constrained 
 iatcon  5 6  7 8                        # atom indices for constraints
 wtatcon 0 -1 0  0 +1 0   0 +1 0  0 -1 0 # constraint coefficients

# the following atomic motion algorithms work with the constraints 
 ionmov 1 tolmxf 1d-2 toldff 1d-4 dtion 350 vis 100 
#ionmov 2 tolmxf 1d-2 toldff 1d-3                   
#ionmov 3 tolmxf 1d-2 toldff 1d-3                   
#ionmov 6 tolmxf 1d-2 toldff 1d-3 dtion 350         

# the rest of the input file defines the box, etc.
 acell 5 30 5 
 rprim 1 0 0  0 1 0  0 0 1
 nkpt 1 
 kpt 3*0 wtk 1 
# diemac 10 diemix 0.5 
 nline 6
 ecut 3 
 ntypat 1 znucl 14 typat 8*1 
 nband 20
 occopt 3
 nstep 100 ntime 3

# This line added when defaults were changed (v5.3) to keep the previous, old behaviour
  iscf 5
