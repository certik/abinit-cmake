# CO molecule test the getwfk in ETSF
# Application to the hgrid convergence.

#Definition of the SCF procedure
nstep 2          # unrealistic value, only used for tests
tolwfr 1.0d-4    # Tolerence on gradient norm, physical value
nwfshist 8       # Wavefunction DIIS
iscf 2           # Mixing value for wavelets

# Force symetries
nsym 1
symrel   1  0  0   0  1  0   0  0  1

#Definition of the unit cell
acell 25 20 20
rprim
1. 0. 0.
0. 1. 0.
0. 0. 1.

natom 2

nband 5

# WVL
usewvl 1
wvl_hgrid1 0.6     # Very high value, unphysical.
wvl_hgrid2 0.55
wvl_hgrid3 0.5
wvl_hgrid4 0.45
wvl_crmult 4.5     # Quite nice physical value
wvl_frmult 8.
wvl_cpmult 8.
wvl_fpmult 8.
wvl_nprccg 15
icoulomb 1      # Use Poisson solver
optforces 0       # Don't compute the forces inside the SCF loop
optstress 0       # Don't compute stress (required for wavelets)
nscforder 14      # order of wavelet for Poisson solver


#Definition of the k-point grid 
kptopt 1          # Option for the automatic generation of k points, taking
                  # into account the symmetry
ngkpt  1  1  1
nshiftk 1
shiftk  0. 0. 0.

#Definition of the atom types
ntypat 2
znucl 6 8

#Definition of the atoms
typat 1 2

#Geometric positions
xcart
 4. 2.5 2.5
 6. 2.5 2.5

#Exchange-correlation functional
ixc 1             # LDA Teter Pade parametrization

#Definition of the planewave basis set
ecut  5

# Input/output
ndtset 4
getwfk -1    # Restr=art from previous wave-fuunctions.
istwfk 1     # Required value for ETSF file
prtden 0     # Don't print the density
prtwf 1      # Output the wave-functions
accesswff 3  # ETSF IO access

