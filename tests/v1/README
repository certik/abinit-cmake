<html>
<head>
<title>v1 : README</title>
</head>
<body>

<h5>Copyright (C) 1998-2008 ABINIT group (RC, XG)
<br> This file is distributed under the terms of the GNU General Public License, see
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br> For the initials of contributors, see ~abinit/doc/developers/contributors.txt .
</h5>

<pre>

This directory, v1, contains tests which exercise parts 
of the ABINIT package, especially those features acquired
during the development of the version 1.
This file gives first a very brief description
of the tests, then a much longer one.

These tests are designed primarily to exercise parts of the code
quickly, NOT necessarily to give physically sensible results.
For tests of correctness, see directory physics (under development).
For greater speed, some tests are not run to full convergence.
Also the quality parameters (especially ecut) are sometimes minimal, i.e.
the calculations are underconverged.

A classification of the tests is provided now. Later, each test is described
in more detail, with accompanying notes and references (some of the notes
might have to be updated, due to the small possible drift related to improvement
of the accuracy of the code).

Tests 1 to 9 are related with occupation numbers and treatment of metals
Tests 10 to 20 examine different exchange-correlation functionals, in the 
              spin-unpolarized case.
Tests 21 to 23 examine different exchange-correlation functionals, in the
              spin-polarized case.
Tests 24, 28 and 29 make additional tests related with GGA.
Test 30 examine Fermi-Amaldi functional
Tests 31 to 38 test different isolated atoms : test Troullier-Martins, 
              Hartwigsen-Goedecker-Hutter pseudopotentials,
              old Teter pseudopotentials (code ATOM), 
              FHI pseudopotentials (code FHI98PP) or
              pseudopotentials on Hamann's grid;
              also test non-sphericity and spin-polarization
Test  39   the use of the spinat variable
Test  40 to 42 are tests with a medium or large number of atoms
Tests 40, 42 and 43  test the geometry builder and the mix of type of atoms
Tests 44 and 45  test the option ionmov=4, with iscf=5 and 2,
              while test 45 also initialize test 46 and 47.
Tests 46 and 47  test the option iscf=1 (determination of the SCF eigenvalue).
Test 48 to 50 test option iprcch=2 or 3,  with ionmov=4, and iscf=2 or 5
Tests 51 to 58 test dielectric matrix
Tests 59 and many following ones (until 97) test or use multi-data set features
Test  67 and 68 determines an optimal densty parameter.
Test  69 and 70 computes excited states thanks to TDDFT
Test  71 to 73 test iprcel=55 and 65
Test  74 uses multidataset with geometric series
Test  75 uses the restartxf option
Test  76 to 82 relates to cell optimization : use of ecutsm, dilatmx, optcell .
Test  83 and 84 uses double-loop datasets.
Test  85 and 86 test iatfixx, iatfixy and iatfixz.
Test  87 to 89 uses different combinations of fftalg=1xx and istwfk 
Test  90 to 96 test the symmetriser
         (more tests of the symmetriser should be set up)
Tests 97 to 99 test the ability to exit a job (exit file or cpu limit). 
             98 and 99 are machine-dependent !

To run these tests, do the following:

0. Be sure that the perl script "run-standard-tests", in the main directory,
   has been generated from the primitive file "run-standard-tests.pl",
   thanks to the command "make perl"
   issued in ~abinit (see the installation notes on the Web).

1. Submit the "run-standard-tests" script, specifying a machine, and
   the keyword "v1" (for Tests_v1) and either
   the index of a test case, i.e.
   (run-standard-tests name_of_machine v1 22) >& log_file
   or a whole range of test cases (two indices), i.e.
   (run-standard-tests name_of_machine v1 02 08) >& log_file
   or, if you want to run all the test cases of this directory
   (run-standard-tests name_of_machine v1) >& log_file
   This will send stdout and stderr to log_file. 
   The script 'run-standard-tests', will create a subdirectory of ~abinit/tests/v1,
   with the name_of_machine and the
   date, where all the results will be placed.

2. In that directory, you will find for each test case that you have
   run, a log file (with the name of the test case), an output
   file, but also a 'diff.xxx' file, automatically created by making
   a 'diff' with respect to the "Refs" subdirectory output files.
   It contains output files from a recent version of the ABINIT code.
   There may be large differences in timing but there should only
   be minor differences in the output of physical quantities.

3. There is also a global report file, generated by the use of the
   fldiff script. Its name is fldiff.report . See the last
   version of the  ~abinit/doc/install_notes/install** file
   in the Infos directory for information about the use of this file.
   This file is the most convenient for a quick look at the correctness
   of results. When the results are not correct, one has often to
   rely on the 'diff.xxx' file to understand what was going wrong.

**********

Test cases:

 1. Bulk Aluminium, FCC, with 2 special points, occopt=4 and tsmear=0.05 .
    Designed to test the treatment of metals, using the "cold smearing"
    of N. Marzari , with a=-.5634 (minimization of the bump).   
 
 2. Bulk Aluminium, FCC, with 2 special points, occopt=5 and tsmear=0.05 .
    Designed to test the treatment of metals, using the "cold smearing"
    of N. Marzari , with a=-.8165 (monotonic function in the tail)
    Use mkmem=0.

 3. Bulk Aluminium, FCC, with 2 special points, occopt=6 and tsmear=0.05 .
    Designed to test the treatment of metals, 
    with the Gaussian-Hermite smearing of Methfessel and Paxton .
    Also test the use of fband instead of nband.

 4. Bulk Aluminium, FCC, with 2 special points, occopt=7 and tsmear=0.05 .
    Designed to test the treatment of metals, 
    with the Gaussian smearing
    Use mffmem=0

 5. Bulk Aluminium, FCC, with 2 special points, occopt=3 and tsmear=0.02 .
    Designed to test the treatment of metals, with a finite
    temperature corresponding to about 6300 Kelvin.
    Use fftalg=400
 
 6. Use of newsp to get starting wavefunctions for case 7 using wavefunctions
    from case 4.
    WARNING : the use of newsp starting from the wavefunctions of case 4
    can lead to slightly different results in test 7. Indeed, there is the
    the possibility of mixing degenerate wavefunctions in case 4, 
    while the interpolated wavefunctions in newsp are NOT invariant
    under such transformation. The energy in case 7 can vary
    by a microHa or so due to this effect.
    

 7. Bulk Aluminium, FCC, with 10 special points, occopt=7 and tsmear=0.05 .
    Start from the wavefunctions of case 4, reformatted by case 6.
    Ask to compute the DOS.
    See the WARNING described in case 6.

 8. O2 molecule, treated like a metal (there is a degeneracy at the 
    Fermi level), occopt=4 and tsmear=0.04 , with nsppol=2 .
    Use spinat to polarize the molecule at start.
    Gives total energy of -32.09317 Hartree
    This test can be used to check the accuracy of stresses in the 
    spin-polarized case. Setting acell(1:2) to 7.005 and 6.995
    gives ETOT -32.090846193972 and -32.095501753750,
          ucvol  441.63023 and 440.37023
    so that the estimation of stress by d(Etot)/d(Vol) gives 3.6948887E-03,
    to be compared with sigma(1)=3.6949713786E-03
                    and sigma(2)=3.6949681083E-03 from the present test
    (the degeneracy is slightly lifted because of incomplete convergence,
     using tolvrs 1.0d-12 instead of toldfe gives at least 8 identical digits for both
     sigma values).

 9. O2 molecule, treated as a spin-polarized molecule, with fixed occupation
    numbers (occopt=2), with nsppol=2 . Gives total energy of -32.09792 Hartree

10.-18. Isolated Helium atom tests.
    These tests exercise different xc functionals, in the spin-unpolarized case.
    The helium atom is isolated in a box of size 5x5x5, with one
    special point (1/4 1/4 1/4), 200 Ha cut-off, used with 
    a potential close to the bare He potential 
    (erfc with 0.001 bohr decay length). Errors due to the smallness
    of the supercell size are on the order of 1 mHa, as well as those
    due to the representation of the Coulomb potential by a erfc function.
    The remaining is due to finiteness of the basis set.
    The estimation of the latter errors is presented in the test_cases
    17 and 18. In all these tests, intxc=0.

10. Isolated Helium atom (see above)
    Treated without any XC energy (ixc=0). 
    The total energy is -1.9442 Ha.

11. Isolated Helium atom (see above)
    Treated with LDA, Teter rational polynomial parametrization (4/93) (ixc=1).
    The total energy is -2.8275 Ha.

12. Isolated Helium atom (see above)
    Treated with LDA, Perdew-Zunger-Ceperley-Alder (ixc=2).
    The total energy is -2.8278 Ha.
    For speed-up, it begins with the wavefunctions from test 11.

13. Isolated Helium atom (see above)
    Treated with LDA, old Teter rational polynomial 
    parametrization (4/91) (ixc=3).
    The total energy is -2.8279 Ha.
    For speed-up, it begins with the wavefunctions from test 11.

14. Isolated Helium atom (see above)
    Treated with LDA, Wigner functional (ixc=4).
    The total energy is -2.8126 Ha.
    For speed-up, it begins with the wavefunctions from test 11.
    Use mkmem=0 and mffmem=0

15. Isolated Helium atom (see above) 
    Treated with LDA, Hedin-Lundqvist functional (ixc=5).
    The total energy is -2.8335 Ha.
    For speed-up, it begins with the wavefunctions from test 11.

16. Isolated Helium atom (see above)
    Treated with LDA, "X-alpha" functional (ixc=6).
    The total energy is -2.7172 Ha.
    For speed-up, it begins with the wavefunctions from test 11.

17. Isolated Helium atom (see above)
    Treated with LDA, Perdew-Wang 92 (ixc=7).
    The one dimensional treatment
    of this He in the LDA gives the total energy of -2.834 Ha (atom0 code).
    Here, the answer is -2.8280 Ha. 
    Going to 250 Ha cut-off gives -2.8302 Ha.
    Going to 300 Ha cut-off gives -2.8316 Ha.
    Going to 350 Ha cut-off gives -2.8325 Ha.
    For speed-up, it begins with the wavefunctions from test 11.

18. Isolated Helium atom (see above)
    Treated with the exchange-only part of Perdew-Wang 92 (ixc=8).
    For speed-up, it begins with the wavefunctions from test 11.

19. Isolated Helium atom (see above)
    Treated with PBE GGA (ixc=11).
    The one dimensional treatment
    of this He in the PBE GGA gives the total energy of -2.893 Ha 
    see Y. Zhang, W. Yang, Phys. Rev. Lett. 80, 890 (1998).
    Here, the answer is -2.8853 Ha. 
    Going to 250 Ha cut-off gives -2.8877 Ha.
    Going to 300 Ha cut-off gives -2.8892 Ha.
    Going to 350 Ha cut-off gives -2.8901 Ha.
    For speed-up, it begins with the wavefunctions from test 11.
 
20. Isolated Helium atom (see above)
    Treated with the exchange-only part of PBE (ixc=12).
    For speed-up, it begins with the wavefunctions from test 11.

21.-24. Isolated Hydrogen atom tests.
    These tests exercise different xc functionals, in the spin-polarized case.
    The hydrogen atom is isolated in a box of size 7x7x7, with one
    special point (1/4 1/4 1/4), 70 Ha cut-off, used with
    a potential close to the bare H potential
    (erfc with 0.005 bohr decay length). Errors due to the smallness
    of the supercell size are on the order of 1 mHa, as well as those
    due to finiteness of the basis set.
    The estimation of the latter errors is presented in the test_cases 22 and 23.
    Those due to the representation of the Coulomb potential by a erfc function
    are much smaller. Except for test 24, intxc=0.

21. Isolated Hydrogen atom (see above) 
    Treated with LSD, Teter rational polynomial parametrization (4/93) (ixc=1).
    The total energy is -0.4792 Ha.

22. Isolated Hydrogen atom (see above)
    Treated with LSD, Perdew-Wang 92 (ixc=7).
    The one dimensional treatment
    of H in the LSD gives the total energy of -13.00 eV, that is -0.478 Ha
    see J.P. Perdew et al , Phys. Rev. B 46, 6671 (1992)  
    (maybe not very accurate!)
    Here, the answer is -0.4792 Ha.
    Going to 100 Ha cut-off gives -0.4795 Ha.
    Going to 150 Ha cut-off gives -0.4798 Ha.
    Keeping 70 Ha cut-off, but going to 0.002 bohr decay length gives 
    a lowering in energy on the order of 0.00003 Ha.
    Increasing the cell size to 8x8x8, while keeping ecut to 70 Ha cut-off
    and 0.005 bohr decay length gives -0.4783 Ha.
    For speed-up, it begins with the wavefunctions from test 21.

23. Isolated Hydrogen atom (see above)
    Treated with PBE GGA (ixc=11).
    The one dimensional treatment
    of H in the PW91 GGA-II gives the total energy of -13.63 eV, 
    that is -0.501 Ha see J.P. Perdew et al , Phys. Rev. B 46, 6671 (1992)  
    (maybe not very accurate!)
    Here, the answer is -0.499583 Ha.
    Going to 100 Ha cut-off gives -0.5001 Ha.
    Going to 150 Ha cut-off gives -0.5002 Ha.
    For speed-up, it begins with the wavefunctions from test 21.

24. Isolated Hydrogen atom (see above)
    Treated with PBE GGA (ixc=11), with intxc=1.
    The total energy is -0.499588 Ha
    For speed-up, it begins with the wavefunctions from test 23.

28. Helium FCC solid, using bare potential, but a relatively low cut-off.
    Cell parameter is 6.505 Bohr , 2 k points are used.  PBE GGA.
    Combined with test 29, it is used to test the accuracy of 
    the stress calculation. Output of the code are as follows :
    Energy=-2.835212586 Ha, volume=68.814809 Bohr^3, 
    stress=6.03381838E-04 Ha/Bohr^3

29. Helium FCC solid, treated like tests 28, but with slightly different acell.
    Cell parameter is 3* 6.495 Bohr. Output of the code are as follows :
    Energy=-2.835403622 Ha, volume=68.497934 Bohr^3, 
    stress=6.02356634E-04 Ha/Bohr^3
    Now, we combine test 28 and 29, to get estimation of the
    stress at cell parameter 6.500 Bohr.
    From the energy and volume, the stress is evaluated by a finite
    difference formula ( stress=d(Etot)/d(Vol) ), 
    giving 6.0287495E-04 Ha/Bohr^3 .
    From the stresses, the interpolation is 6.0286924E-04 Ha/Bohr^3 .

30. Helium atom in a box, with Fermi-Amaldi correction (ixc=20), that for
    Z=2, is equivalent to OEP or Hartree-Fock. Otherwise, similar
    to test 11.

31. Isolated tin atom, with 50sn.pspnc pseudopotential (Troullier-Martins),
    to be compared with the result of test 32.
    The size of the box is 12x12x12, One k-point (1/4 1/4 1/4) is used.
    8 elements of symmetry are present. The cut-off is 14 Hartree.
    The energy levels (eV) are found at -7.162, -0.273 and -0.228 (two-fold deg)
    The difference between these energy levels is 6.889 and 0.045.
    Going to larger unit cells decrease the latter difference 
    (14x14x14 makes it 0.010).

32. Isolated tin atom, with 50sn.psphgh pseudopotential 
    (Hartwigsen-Goedecker-Hutter), to be compared with the result of test 31.
    Same geometry, same cut-off.
    The energy levels (eV) are found at -7.019, -0.131, and -0.085 (two-fold deg)
    The difference between these energy levels is 6.888 and 0.046.
    For speed-up, it begins with the wavefunctions from test 31.

33. Isolated carbon atom, with 6c.pspnc pseudopotential
    Test a non-spherical, spin-polarized atom, with nsym=2.
    In order to have a fast computation, the cut-off, 19Ha, 
    is not large enough for good convergence, as well
    as the box size 9x9x9.
    With better convergence parameters, it can be used to find 
    the atomization energy of carbon-containing molecules.

34. Isolated lead atom, with pseudopotential generated in LLN, from 
    the code of Mike Teter. 6 6 6 box and 5 Ha , for speed. 
    Spherically symmetric, without spin-polarization. ixc=3.

35. Isolated silicon atom, with phoney pseudopotential (back in 1991 !).
    6 6 6 box and 5 Ha, for speed. 
    Spherically symmetric, without spin-polarization. ixc=3.

36. Isolated oxygen atom, with pspnc pseudopotential .
    6 6 6 box and 15 Ha, for speed.
    Spherically symmetric, without spin-polarization. ixc=1.
    It has non-linear core correction, but because of an insufficient cut-off,
    and the use of intxc=1, the density is slightly negative at few points. 
    The present test makes sure that this is properly handled.

37. Isolated aluminum atom, with fhi pseudopotential. kpt=1/4 1/4 1/4
    Spherically symmetric, without spin-polarisation. ixc=7 (CA Perdew Wang).
    Here, computed with a 12x12x12 box, and ecut=13.5, one gets a
    minimum sp separation of 4.959 eV, and a p-degeneracy lifting of 0.090 eV.
    The sp separation from an atomic code is 5.046 eV. 
    Computed in ABINIT with a 16x16x16 box, and ecut=20, one gets 
    a minimum sp separation of 5.039 eV, and a p-degeneracy lifting of 0.008 eV.

38. Ytterbium, fcc structure, one atom per primitive cell,
    similar to test #4 of built-in, except that nstep=1, and
    the pseudopotential differs :
    format 5, translated from 70yb.pspnc (format 1).
    The translation slightly changes the result, at the level of 2 microHa.
    (This test has been set up by G. Zerah).

39. H2 molecule with distant atoms : probe the use of the spinat variable
    Use spin-polarized mode, spinor mode, as well as antiferromagnetic mode.
    Even consider an initialization with reather crazy, nearly ferromagnetic spinat.
    Use 01h.pspgth, in a 8 8 16 box, with 15 Ha cut-off.
    Separation is 4 bohr.
    Consider anti-parallel spin configuration,  which is the favoured one
    for this distance. Get total energy of -0.981 839  Ha .
    Note that the spin-polarization is not complete.
    Non-spin -polarized configuration (nsppol=1) gives -0.976 126  Ha .
    
40. Diamond : vacancy.
    This test is for testing a large number of atoms (63 atoms), with a large
    number of plane waves (unlike test42).
    Small number of line minimisations, of course.

41. Mo surface, with 10 atom per cell. Not very large, but the
    number of bands make it a medium-size problem : 36 bands.

42. Test the geometry builder :
    - H2O molecule repeated four times, with rotations and translations
    - Si (100) unreconstructed surface : 2*2*2 objects of eight atoms
    - 16 H atoms at the bottom
    This test is not realistic (it would take too much time).

43. Test the geometry builder, and the non-ordering of atoms  :
    Same thing as test 42, but with an other order for the input of atoms.

44. Test the option ionmov=4. 8-atom Si cube, non spin-polarized.
    Same test as number 22a of fast, except for the change
    of ionmov, no reading of wavefunctions, iscf to 5, and different
    tolerance criteria.
    Use mkmem=0 and mffmem=0

45. Test the option ionmov=4. Si2 molecule, spin-polarized.
    Same test as number 16 of fast, except for the change 
    of ionmov, no reading of wavefunctions, iscf to 2, and different
    tolerance criteria.

46. Si2 molecule, spin-polarized. Take the wavefunctions from test 45,
    and converge them further for initialisation of test 47.

47. Si2 molecule, spin-polarized.
    Test the option iscf=1 (eigenvalues of the SCF cycle). 
    Start from the wavefunctions of test 46.

48. Si2 molecule, spin-polarized
    Same as test 45, but use iprcch=2 instead of iprcch=1.

49. Si2 molecule, spin-polarized
    Same as test 45, but use iprcch=3 instead of iprcch=1.

50. Si2 molecule, spin-polarized
    Same as test 45, but use iprcch=3 instead of iprcch=1, 
    and iscf=5 instead of iscf=2.

51. Al2 molecule, inversion point shifted from the origin, ixc=0,
    kpt=1/4 1/4 1/4, nsym=4.
    Large number of bands (20 instead of 3).
    8 first SCF steps with simple mixing algorithm, mixing factor 1/5.
    Slow convergence.
    Computation of the hermitian dielectric matrix at the 8th step.
    The inverse of the dielectric matrix is then used as preconditioning.
    A factor of 20 is gained on each step. Largest eigenvalue value of the
    dielectric matrix is 5.712 (a mixing factor of 1/3 would have
    been enough, but 1/5 is faster). A second eigenvalue is close : 5.531 .

52. Same system as for case 51. Determination of the largest SCF
    eigenvalue by brute force : iscf=1 . Get 5.647 . The
    symmetries make the largest eigenvalue of the Hermitian TC dielectric
    matrix not appear here, so that this value is to be compared with 5.531.

53. Si2 molecule, spin-polarized. ixc=0. 7 states for each spin.
    First, converge using mixing factor, then evaluate RPA dielectric
    matrix, and use it for convergence.     

54. Same as case 53, but exchange-correlation included. The convergence
    is not as good as in case 53, but still much better than simple mixing.

55. Molybdenum slab : 5 layers of Mo + 3 layers of vacuum, ixc=0 .
    Central layer is slightly displaced, to break the symmetry.
    Metallic occupation numbers.
    Only 20 bands, while at least 15 are needed.
    Use iscf=2, start with default metallic preconditioner, 
    damped (diemix=0.5d0). A factor of 2 is gained
    at each iteration. Then evaluate RPA matrix eigenvalues
    using the extrapolation, and including the metallic correction. 
    Largest are 3.2541E+01  1.2089E+01  6.1305E+00 .
    Then, uses the dielectric matrix preconditioning to converge.
    No damping is needed.
    A factor of about 10 is gained at each iteration on average.

56. Same system as for case 55. Evaluate eigenvalue of the standard
    SCF cycle. Find -2.68. This explains the damping needed in case 55.

57. Again Molybdenum slab, with ixc=1. 3 k-points, mkmem=3.
    20 bands. Use iprcel=45 for SCF cycle (iscf=3). 
    toldff=5.0d-5 is reached in only 8 cycles.
    With iscf=5, it is reached in 10 cycles.

58. Same as test 57, but with mkmem=0.

59. Test multi-dataset mode. Si diamond. 
    2 datasets, with index 2 and 57 (!). No advanced features like get variables.
    Rather fast.

60. Test multi-dataset mode. H2 molecule in a box (psp 1h.pspnc). 
    acell constant, small (7 5 5).
    10 different values of ecut (convergence study). Use getxred=-1.

61. Test multi-dataset mode. H2 molecule in a box of increasing size.
    Use ecut=12 (see previous test).
    5 different values of acell (convergence study). Use getxcart=-1.
    mkmem/=0.

62. Test multi-dataset mode. Al metal, 10 k points.
    Vary tsmear (0.08; 0.08; 0.04; 0.02). 
    Start from the output wfs of the previous dataset.

63. Test multi-dataset mode. Al metal, 10 k points.
    Start from the output wfs of the previous dataset. Compute tsmear=0.01.
    Test the idea of using one input file for different runs.
    The input file is the same as for test 63, except for the addition
    of one dataset.

64. Test multi-dataset mode. H2 molecule in a box of increasing size.
    Same as test 61, except that it reads previous wavefunctions
    (use getxcart=-1 and getwfk=-1).
    mkmem/=0 .

65. Test multi-dataset mode. H2 molecule with 1 and 4 k points.
    (use getxcart=-1 and getwfk=-1). Convergence study with k points.
    mkmem==0 .

66. Test multi-dataset mode. H2 molecule with 1 k points.
    Use getxcart=-1 and getwfk=-1 : first perform a geometry optimization,
    in two parts (thanks to the use of the restartxf option)
    with minimal number of bands, then compute more bands at fixed geometry,
    with an increased ecut.  mkmem==0 .

67. Compute an optimal densty parameter for N. Atomic computation,
    using multi-dataset mode.

68. Compute an optimal densty parameter for N2. Molecular computation,
    using multi-dataset mode.

69. Excited states of the Mg atom, with (ixc=1, spin-polarized Teter functional).
    Use the multi-dataset mode.
    Can be compared with the results in Vasiliev et al, PRL 82, 1919 (1999).
    With the values acell 18, ecut 3.5, nband2 10, the present
    test generates KS diff=3.46eV, TDLDA(1S1P)=4.48eV, TDLDA(1S3P)=2.81eV
    With the values acell 22, ecut 3.5, nband2 22, ABINIT 
    generates KS diff=3.40eV , TDLDA(1S1P)=4.35eV, TDLDA(1S3P)=2.77eV
    Vasiliev gets KS diff=3.39eV, TDLDA(1S1P)=4.34eV, TDLDA(1S3P)=2.79eV

70. Same as test 69, but with another xc functional (ixc=7, PW92 LSD)
    With the values acell 18, ecut 3.5, nband2 10, the present
    test generates KS diff=3.46eV, TDLDA(1S1P)=4.45eV, TDLDA(1S3P)=2.84eV

71. Same as test 57, but with iprcel=55 (RPA dielectric matrix)

72. Same as test 57, but with ixc=1, and iprcel=65 
                    (electronic dielectric matrix)

73. Same as test 57, but with ixc=7, and iprcel=65 
                    (electronic dielectric matrix)

74. Test multi-dataset mode. H2 molecule with 1 k points.
    Convergence study, using a geometric series for ecut.

75. Same as test 66, H2 molecule with 1 k points,
    but uses the restartxf option, so ndtset=3 instead of 2.
    There are small differences with respect to the test case 66, likely
    due to the fact that in one single run, the SCF convergence learns
    a bit about the right scale for the line minimisation, and that this
    knowledge is lost. However, the full history of atomic coordinates
    and forces is essentially the same in both cases.

76. 2 special k point Si in 2-atom diamond unit cell.
    Test ecutsm. Determine a smooth etot vs acel curve
    (one can try with ecutsm=0.0d0 to see the difference !)
    Stress is correct. For example, 
    at acell=10.10 (volume=2.5757525E+02), one obtains etotal=-8.7850566628
    at acell=10.12 (volume=2.5910843E+02), one obtains etotal=-8.7851433215,
    giving a finite-difference estimate of the stress ( d(etotal)/d(volume) )
    at 10.11 to be -5.6522d-5, while the code gives -5.6582015717E-05
    
77. 2 special k point Si in 2-atom diamond unit cell.
    Test dilatmx. Increase it, the number of planewaves increases, but
    the total energy stays practically the same. The small fluctuations
    (-8.7967199088907,
     -8.7967198524822,
     -8.7967198520954 ) come from varying the FFT grid size, with
    effect on the xc functional. It has been checked that using exactly the
    same FFT grid for the three cases gives the same energy.
    It has been checked also that larger fluctuations arise with intxc=0.

78. 2 special k point Si in 2-atom diamond unit cell.
    Optimization of unit cell volume (optcell=1).
    Use 2 datasets, and the variable getcell.

79. H2 molecule in a cell of variable size along the H2 chain => H polymer.
    Optimization of cell size and atomic distances (optcell=4).

80. Mg crystal, 1 atom per unit cell. Start with deformed FCC lattice,
    optimize the lattice towards FCC (optcell=2).
    Also test the restartxf option.

81. Mg crystal, 1 atom per unit cell. Start with deformed FCC lattice,
    optimize the lattice towards FCC, with conservation of volume (optcell=3).

82. Mg bi-dimensional layer, 1 atom per unit cell. 
    Start with deformed 2D hexagonal lattice,
    optimize the lattice towards hexagonal, 
    with conservation of inter-layer distance (optcell=7).

83. 2 special k point Si in 2-atom diamond unit cell.
    Double-loop over acell and ecut using series

84. 2 special k point Si in 2-atom diamond unit cell.
    Double-loop over acell and ecut using metacharacters only.

85. SiH4 : optimize the geometry with partially constrained
    atomic positions.
    1 special k-point, in a box 8x8x8 (too small), and 8Ha cut-off.

86. SiH4 : molecular dynamics with partially constrained atomic positions.
    1 special k-point, in a box 8x8x8 (too small), and 8Ha cut-off.

87. H atom (spin-unpolarized in a medium size cubic box, k=0 0 0
    similar to test 1 of fast)
    Using multi-dataset mode, examine the following combinations of
    fftalg and istwfk : (112,2),(112,1),(111,1),(111,2),(110,2),(110,1),
     (100,1), then compute the energy with nstep=0 for (112,2) and (112,1).
    Then again SCF test for (400,1), (401,1), (402,1).
    For the second dataset, reads the wavefunctions of the first dataset.

88. H atom, similar to test 87, except that the box is not cubic,
    but only parallelipipedic (not even a rectangle parallelipiped).
    However, the primitive vectors describe the same lattice as
    in case 87, so that the results must be identical
    to those of test 87, even if a different FFT grid is used.
    That is what is observed.

89. Mg atom, in a big box, displaced from the center,
    test different k points with time-reversal symmetry, and different 
    fftalg values.

90. Si 8-atom cube. Test the symmetrizer : generate
    the full set of atoms from the symmetry operations and 
    an irreducible set of atoms.

91. Crazy 4-atom Si cell. Test the symmetrizer.
    Dataset 1 : Full set of symmetries and full set of atoms, 
    Dataset 2 : Spatial group index is given, with an irreducible set of atoms
    Dataset 3 : Spatial group index is given, with a full set of atoms,
                  and checks are performed.

92. Crazy 8-atom Si cell. Test the symmetrizer:
    Fast test for the same orthorhombic group, uses different orientations.
    Note : since the sets of atoms generated for different orientations
    are not equivalent, the final energies also differ.

93. Crazy orthorhombic 16-atoms Si cell. Test the symmetrizer.
    Long test for all possible orientations and origin choices.
    Dataset 1-6 : space group origin choice 1
    Dataset 7-12 : space group origin choice 2
    Dataset 1,7; 2,8; 3,9; 4,10; 5,11; and 6,12 all the possible orientations.
    Note : since the sets of atoms generated for different orientations
    are not equivalent, the final energies also differ.

94. Crazy tetragonal Si cell with 8 atoms. Test the symmetrizer.
    Used to test the generation of symmetry matrices from input spatial group, P42/mnm
    Dataset 1 : Full set of atoms
    Dataset 2 : Irreducible unit cell.

95. Crazy cubic Si cell with 4 atoms. Test the symmetrizer.
    Test for cubic space group with two possible origin choices:
    Dataset 1 and 2 : first origin choice
    Dataset 1 : Irreducible unit cell and space group
    Dataset 2 : Full set of atoms and space group
    Dataset 3 and 4 : second origin choice
    Dataset 3 : Irreducible unit cell and space group
    Dataset 4 : Full set of atoms and full set of symmetry.

96. Al2O3 cell in rhombohedric cell with different axes.
    Dataset 1 : Rhombohedral axes; full set of symmetries and full set of atoms
    Dataset 2 : Rhombohedral axes; irreducible unit cell and space group
    Dataset 3 : Hexagonal axes; irreducible unit cell and space group
    Dataset 4 : Hexagonal axes; full unit cell and space group
    The results are equivalent for Dataset 1 and 2 and Dataset 3 and 4.

97. 8-atom Si cube, fixed geometry, with a large cut-off.
    The exit file is created. The job should stop after having initialized
    the wavefunctions.

98. 8-atom Si cube, fixed geometry, with a large cut-off.
    A CPU time limit of 20 sec is required. The whole job would
    be 200 sec on a PPro at 200 MHz. Afterwards, the job is restarted
    in run 99.

99. Same job as 98, starting from the wavefunctions that were generated
    then.
    
</pre>
